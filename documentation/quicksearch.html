<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"app.js.html":{"id":"app.js.html","title":"Source: app.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: app.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Main file to initialize and prepare Pwk.Editor * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app'); goog.require('app.Core'); goog.require('app.exports'); /** * Cross-browser wrapper for DOMContentLoaded. * @param {Window} win Window reference * @param {Function} fn Callback function reference * @private */ app.contentLoaded_ = function(win, fn) { let done = false; let top = true; let doc = win.document; let root = doc.documentElement; let modern = doc.addEventListener; let add = modern ? 'addEventListener' : 'attachEvent'; let rem = modern ? 'removeEventListener' : 'detachEvent'; let pre = modern ? '' : 'on'; function init(e) { if (e.type == 'readystatechange' &amp;&amp; doc.readyState != 'complete') { return; } // remove listener, no longer needed (e.type == 'load' ? win : doc)[rem](pre + e.type, init, false); if (!done &amp;&amp; (done = true)) { fn.call(win, e.type || e); } } function poll() { try { root.doScroll('left'); } catch (e) { setTimeout(poll, 50); return; } init('poll'); } if (doc.readyState == 'complete') { fn.call(win, 'lazy'); } else { if (!modern &amp;&amp; root.doScroll) { try { top = !win.frameElement; } catch (e) {} if (top) { poll(); } } doc[add](pre + 'DOMContentLoaded', init, false); doc[add](pre + 'readystatechange', init, false); win[add](pre + 'load', init, false); } }; // Run application app.contentLoaded_(window, function() { (new app.Core()).init(); }); × Search results Close "},"controllers_hellocontroller.js.html":{"id":"controllers_hellocontroller.js.html","title":"Source: controllers/hellocontroller.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: controllers/hellocontroller.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.controllers.HelloController'); goog.require('app.core.Controller'); goog.require('pwk.Editor'); goog.require('pwk.EditorContainer'); /** * @constructor * @extends {app.core.Controller} */ app.controllers.HelloController = function() { goog.base(this, 'HelloController'); }; goog.inherits(app.controllers.HelloController, app.core.Controller); /** * index action * @param {app.core.Request} request * @param {app.core.Response} response */ app.controllers.HelloController.prototype.index = function(request, response) { console.log('Hello'); }; × Search results Close "},"core_controller.js.html":{"id":"core_controller.js.html","title":"Source: core/controller.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/controller.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Base controller class. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.Controller'); /** * Defines an abstract controller for handling requests to certain fragments. * @param {string} controllerName Current * @constructor */ app.core.Controller = function(controllerName) { /** * @type {string} * @private */ this.controllerName_ = controllerName; }; /** * Get current controller name * @return {string} */ app.core.Controller.prototype.getControllerName = function() { return this.controllerName_; }; × Search results Close "},"controllers_homecontroller.js.html":{"id":"controllers_homecontroller.js.html","title":"Source: controllers/homecontroller.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: controllers/homecontroller.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.controllers.HomeController'); goog.require('app.core.Controller'); goog.require('pwk.Editor'); goog.require('pwk.EditorContainer'); /** * @constructor * @extends {app.core.Controller} */ app.controllers.HomeController = function() { goog.base(this, 'HomeController'); }; goog.inherits(app.controllers.HomeController, app.core.Controller); /** * index action * @param {app.core.Request} request * @param {app.core.Response} response */ app.controllers.HomeController.prototype.index = function(request, response) { let editor = new pwk.Editor(); let container = new pwk.EditorContainer(); container.addChild(editor, true); container.render(document.body); }; × Search results Close "},"core_core.js.html":{"id":"core_core.js.html","title":"Source: core/core.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/core.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview The core class of the application. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.Core'); goog.require('app.controllers.HelloController'); goog.require('app.controllers.HomeController'); goog.require('app.core.Application'); goog.require('goog.events.EventHandler'); goog.require('goog.events.EventTarget'); /** * The base class. * This class will be exported as the main entry point. * @constructor * @extends {app.core.Application} */ app.Core = function() { goog.base(this); }; goog.inherits(app.Core, app.core.Application); /** * Kicks off the library. */ app.Core.prototype.init = function() { // -- Application initialization -- // // -- Register routes -- // this.mapRoute('{!}{/}{/hello{/}}', app.controllers.HelloController); // Default route, specify other routes above this one this.mapRoute('*', app.controllers.HomeController); // -- Register application filters -- // //this.addApplicationFilter( // new hedgehog.filters.ComponentsInitializationApplicationFilter()); // -- Register action filters -- // //this.addActionFilter( // new hedgehog.filters.Componen tsInitializationActionFilter(), null, 0); // Execute application this.run(); }; × Search results Close "},"core_actionfilter.js.html":{"id":"core_actionfilter.js.html","title":"Source: core/actionfilter.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/actionfilter.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview The action filter is a class with specific events that you can * apply to a controller action or an entire controller that modifies the way * in which the action is executed. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.ActionFilter'); /** * Action filter. * @interface */ app.core.ActionFilter = function() {}; /** * Controller that will be processed by this filter. * @return {string|RegExp} */ app.core.ActionFilter.prototype.getController = goog.abstractMethod; /** * Action that will be processed by this filter. * @return {string|RegExp} */ app.core.ActionFilter.prototype.getAction = goog.abstractMethod; /** * Called when an unhandled exception occurs in the action. * @param {app.core.events.ActionExceptionEvent} e */ app.core.ActionFilter.prototype.onException = goog.nullFunction; /** * Called before the action method is invoked. * @param {app.core.events.ActionEvent} e */ app.core.ActionFilter.prototype.onActionExecuting = goog.nullFunction; /** * Called after the action method is invoked. * @param {app.core.events.ActionEvent} e */ app.core.ActionFilter.prototype.onActionExecuted = goog.nullFunction; × Search results Close "},"core_application.js.html":{"id":"core_application.js.html","title":"Source: core/application.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/application.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Main application class. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.Application'); goog.require('app.core.ApplicationFilter'); goog.require('app.core.Request'); goog.require('app.core.Response'); goog.require('app.core.Router'); goog.require('app.core.events.ActionEvent'); goog.require('app.core.events.ActionExceptionEvent'); goog.require('app.core.types.ActionFilterItem'); goog.require('goog.Promise'); goog.require('goog.events.EventTarget'); goog.require('goog.string'); /** * @constructor * @extends {goog.events.EventTarget} */ app.core.Application = function() { goog.events.EventTarget.call(this); var historyStateInput = (/** @type {HTMLInputElement} **/( goog.dom.createDom('input', { 'type': 'text', 'id': 'history_state', 'name': 'history_state', 'style': 'display:none' }))); document.body.appendChild(historyStateInput); /** * @type {app.core.Router} * @private */ this.router_ = new app.core.Router(false, undefined, historyStateInput); /** * @type {Array.&lt;app.core.types.ActionFilterItem&gt;} * @private */ this.actionFilters_ = []; /** * @type {Array.&lt;app.core.types.ApplicationFilterItem&gt;} * @private */ this.applicationFilters_ = []; /** * The fragment we are mapping the controller to. * @type {RegExp} * @private */ this.currentRoute_; /** * @type {boolean} * @private */ this.isFirstLoad_ = true; }; goog.inherits(app.core.Application, goog.events.EventTarget); /** * @param {string} route The path The fragment we are mapping the controller to. * @param {Function} controller The name or object that identifying the desired * controller. */ app.core.Application.prototype.mapRoute = function(route, controller) { this.router_.route( route, goog.bind( goog.partial(this.processRoute_, route, new controller()), this)); }; /** * @param {string} route The fragment we are mapping the controller to. * @param {app.core.Controller} controller Controller instance related to * current route. * @private */ app.core.Application.prototype.processRoute_ = function(route, controller) { this.setCurrentRoute_(route); let i = 2; let routeData = {'controller': controller.getControllerName()}; let pattern = /:[a-zA-Z0-9._-]*/g; let request; let response; let filterContext; let match; let queryVals = arguments[arguments.length - 1]; while ((match = pattern.exec(route)) != null) { i++; routeData[goog.string.removeAll(match[0], ':')] = arguments[i]; } if (!goog.isDefAndNotNull(routeData['action'])) { routeData['action'] = 'index'; } routeData['isFirstLoad'] = this.isFirstLoad_; request = new app.core.Request(routeData, window.location.href, queryVals); response = new app.core.Response(request, this.router_); filterContext = new app.core.types.ActionFilterContext(request, response); /** * @constructor */ var instance = Object.create(controller); if (goog.isFunction((instance[routeData['action']]))) { try { new goog.Promise(function(resolve, reject) { this.dispatchEvent(new app.core.events.ActionEvent(filterContext, app.core.Application.EventType.ACTIONEXECUTING, resolve, this)); }, this) .then(function() { return new goog.Promise(function(resolve, reject) { resolve(instance[routeData['action']](request, response)); }); }, undefined, this) .then(function() { return new goog.Promise(function(resolve, reject) { this.dispatchEvent(new app.core.events.ActionEvent(filterContext, app.core.Application.EventType.ACTIONEXECUTED, resolve, this)); }, this); }, undefined, this) .then(function() { return new goog.Promise(function(resolve, reject) { // Application loaded resolve(this.dispatchEvent( app.core.Application.EventType.APPLICATIONLOADED)); }, this); }, undefined, this); } catch (err) { this.dispatchEvent( new app.core.events.ActionExceptionEvent(filterContext, this, err)); } } else { throw new Error('Action &quot;' + routeData['action'] + '&quot; does not exist!'); } }; /** * Register application filter * @param {!app.core.ApplicationFilter} filter * @param {number=} opt_order */ app.core.Application.prototype.addApplicationFilter = function(filter, opt_order) { goog.array.insert(this.applicationFilters_, new app.core.types.ApplicationFilterItem(filter, opt_order)); }; /** * Register action filter * @param {!app.core.ActionFilter} filter * @param {string|RegExp=} opt_route Route to watch for. * @param {number=} opt_order */ app.core.Application.prototype.addActionFilter = function(filter, opt_route, opt_order) { goog.array.insert(this.actionFilters_, new app.core.types.ActionFilterItem(filter, opt_route, opt_order)); }; /** * Start application execution */ app.core.Application.prototype.run = function() { // Initialize events this.listenOnce(app.core.Application.EventType.APPLICATIONSTART, this.onApplicationStart_, false, this); this.listenOnce(app.core.Application.EventType.APPLICATIONRUN, this.onApplicationRun_, false, this); this.listenOnce(app.core.Application.EventType.APPLICATIONLOADED, this.onApplicationLoaded_, false, this); this.listen(app.core.Application.EventType.ACTIONEXCEPTION, this.onActionException_, false, this); this.listen(app.core.Application.EventType.ACTIONEXECUTING, this.onActionExecuting_, false, this); this.listen(app.core.Application.EventType.ACTIONEXECUTED, this.onActionExecuted_, false, this); // Sort application filters goog.array.sort(this.applicationFilters_, function(a, b) { return a.getOrder() - b.getOrder(); }); // Application start this.dispatchEvent(app.core.Application.EventType.APPLICATIONSTART); // Sort action filters goog.array.sort(this.actionFilters_, function(a, b) { return a.getOrder() - b.getOrder(); }); // Check current route this.router_.checkRoutes(); // Application run this.dispatchEvent(app.core.Application.EventType.APPLICATIONRUN); }; /** * Called before the action method is invoked. * @param {app.core.events.ActionEvent} e * @private */ app.core.Application.prototype.onActionExecuting_ = function(e) { this.forEachActionFilter_(function(filterItem) { filterItem.getFilter().onActionExecuting(e); }); e.resolvePromise(); }; /** * Called after the action method is invoked. * @param {app.core.events.ActionEvent} e * @private */ app.core.Application.prototype.onActionExecuted_ = function(e) { this.forEachActionFilter_(function(filterItem) { filterItem.getFilter().onActionExecuted(e); }); e.resolvePromise(); }; /** * Called when an unhandled exception occurs in the action. * @param {app.core.events.ActionExceptionEvent} e * @private */ app.core.Application.prototype.onActionException_ = function(e) { this.forEachActionFilter_(function(filterItem) { filterItem.getFilter().onException(e); }); e.resolvePromise(); }; /** * Called when an application start initialization. * @param {goog.events.Event} e * @private */ app.core.Application.prototype.onApplicationStart_ = function(e) { this.forEachApplicationFilter_(function(filterItem) { filterItem.getFilter().onApplicationStart(e); }); }; /** * Called when an application end initialization. * @param {goog.events.Event} e * @private */ app.core.Application.prototype.onApplicationRun_ = function(e) { this.forEachApplicationFilter_(function(filterItem) { filterItem.getFilter().onApplicationRun(e); }); }; /** * Called when an application launched. * @param {goog.events.Event} e * @private */ app.core.Application.prototype.onApplicationLoaded_ = function(e) { this.forEachApplicationFilter_(function(filterItem) { filterItem.getFilter().onApplicationLoaded(e); }); this.isFirstLoad_ = false; }; /** * Calls a function for each registered application filter. * @param {Function} callback * @private */ app.core.Application.prototype.forEachApplicationFilter_ = function(callback) { goog.array.forEach(this.applicationFilters_, function(filterItem) { callback.call(this, filterItem); }, this); }; /** * Calls a function for each registered action filter, but skip filters with * route that not match current route. * @param {Function} callback * @private */ app.core.Application.prototype.forEachActionFilter_ = function(callback) { var currentRoute = this.currentRoute_; goog.array.forEach(this.actionFilters_, function(filterItem) { // Check route and run var route = filterItem.getRoute(); if (goog.string.isEmptySafe(route) || currentRoute.exec(route)) { callback.call(this, filterItem); } }, this); }; /** * @param {string} route * @private */ app.core.Application.prototype.setCurrentRoute_ = function(route) { this.currentRoute_ = new RegExp('^' + goog.string.regExpEscape(route) .replace(/\\\\:\\w+/g, '([a-zA-Z0-9._-]+)') .replace(/\\\\\\*/g, '(.*)') .replace(/\\\\\\[/g, '(') .replace(/\\\\\\]/g, ')?') .replace(/\\\\\\{/g, '(?:') .replace(/\\\\\\}/g, ')?') + '$'); }; /** @enum {string} */ app.core.Application.EventType = { APPLICATIONSTART: goog.events.getUniqueId('application_start'), APPLICATIONRUN: goog.events.getUniqueId('application_start'), APPLICATIONLOADED: goog.events.getUniqueId('application_loaded'), ACTIONEXCEPTION: goog.events.getUniqueId('action_exception'), ACTIONEXECUTING: goog.events.getUniqueId('action_executing'), ACTIONEXECUTED: goog.events.getUniqueId('action_executed') }; × Search results Close "},"core_applicationfilter.js.html":{"id":"core_applicationfilter.js.html","title":"Source: core/applicationfilter.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/applicationfilter.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.ApplicationFilter'); /** * Application filter. * @interface */ app.core.ApplicationFilter = function() { }; /** * Called when an application start initialization. * @param {goog.events.Event} e */ app.core.ApplicationFilter.prototype.onApplicationStart = goog.nullFunction; /** * Called when an application end initialization. * @param {goog.events.Event} e */ app.core.ApplicationFilter.prototype.onApplicationRun = goog.nullFunction; /** * Called when an application launched. * @param {goog.events.Event} e */ app.core.ApplicationFilter.prototype.onApplicationLoaded = goog.nullFunction; × Search results Close "},"core_events_actionevent.js.html":{"id":"core_events_actionevent.js.html","title":"Source: core/events/actionevent.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/events/actionevent.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.events.ActionEvent'); goog.require('app.core.types.ActionFilterContext'); goog.require('goog.events.Event'); /** * A base class for controller actions events. * @param {app.core.types.ActionFilterContext} actionFilterContext Current * filter context. * @param {string|!goog.events.EventId} type Event Type. * @param {Function} resolve Promise resolver function. * @param {Object=} opt_target Reference to the object that is the target of * this event. It has to implement the {@code EventTarget} interface * declared at {@link http://developer.mozilla.org/en/DOM/EventTarget}. * @extends {goog.events.Event} * @constructor */ app.core.events.ActionEvent = function(actionFilterContext, type, resolve, opt_target) { goog.events.Event.call(this, type, opt_target); /** * @type {app.core.types.ActionFilterContext} * @private */ this.actionFilterContext_ = actionFilterContext; /** * @type {Function} * @private */ this.promiseResolve_ = resolve; }; goog.inherits(app.core.events.ActionEvent, goog.events.Event); /** * @return {app.core.types.ActionFilterContext} */ app.core.events.ActionEvent.prototype.getContext = function() { return this.actionFilterContext_; }; /** * Resolve promise */ app.core.events.ActionEvent.prototype.resolvePromise = function() { if (goog.isFunction(this.promiseResolve_)) { this.promiseResolve_(); } }; × Search results Close "},"core_events_actionexceptionevent.js.html":{"id":"core_events_actionexceptionevent.js.html","title":"Source: core/events/actionexceptionevent.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/events/actionexceptionevent.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.events.ActionExceptionEvent'); goog.require('app.core.events.ActionEvent'); /** * @param {app.core.types.ActionFilterContext} actionFilterContext Current * filter context * @param {app.core.Application} app * @param {Error} err * @extends {app.core.events.ActionEvent} * @constructor */ app.core.events.ActionExceptionEvent = function(actionFilterContext, app, err) { app.core.events.ActionEvent.call( this, actionFilterContext, app.core.Application.EventType.ACTIONEXCEPTION, goog.nullFunction, app); /** * @type {Error} * @private */ this.error_ = err; }; goog.inherits(app.core.events.ActionExceptionEvent, app.core.events.ActionEvent); /** * @return {Error} */ app.core.events.ActionExceptionEvent.prototype.getError = function() { return this.error_; }; × Search results Close "},"core_request.js.html":{"id":"core_request.js.html","title":"Source: core/request.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/request.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.Request'); goog.require('goog.Uri'); /** * Create a simple request object based on the provided URL. * @param {Object} routeData Object that contains information about current * route. * @param {string} uri The uri we are constructing this object from. * @param {string} queryVals The values for query path. * @param {boolean=} opt_ignoreCase Whether or not we are performing a case * sensitive parse. * @constructor * @extends {goog.Uri} */ app.core.Request = function(routeData, uri, queryVals, opt_ignoreCase) { goog.Uri.call(this, uri, opt_ignoreCase); /** * @type {Object} * @private */ this.routeData_ = routeData; this.setQueryData(queryVals, false); }; goog.inherits(app.core.Request, goog.Uri); /** * Return route data by key or all values as object * @param {string=} opt_key * @return {Object|string} */ app.core.Request.prototype.getRouteData = function(opt_key) { if (goog.isDefAndNotNull(opt_key)) { return this.routeData_[opt_key]; } return this.routeData_; }; /** * Convert this object to a simple JSON object. * @return {Object} */ app.core.Request.prototype.toJSON = function() { var obj = { domain: this.getDomain(), path: this.getPath(), port: this.getPort(), query: this.getQuery(), scheme: this.getScheme(), userInfo: this.getUserInfo(), routeData: this.routeData_, queryData: {} }; var queryData = this.getQueryData(), keys = queryData.getKeys(); for (var a = 0; a &lt; keys.length; a++) { var values = queryData.getValues(keys[a]); if (values.length &gt; 1) { obj.queryData[keys[a]] = values; } else { obj.queryData[keys[a]] = queryData.get(keys[a]); } } return obj; }; × Search results Close "},"core_response.js.html":{"id":"core_response.js.html","title":"Source: core/response.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/response.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.Response'); goog.require('app.core.Router'); goog.require('goog.soy'); /** * Create a response based on the provided request. * @param {app.core.Request} request * @param {app.core.Router} router * @constructor */ app.core.Response = function(request, router) { /** * @type {app.core.Request} * @private */ this.request_ = request; /** * @type {app.core.Router} * @private */ this.router_ = router; }; /** * @return {app.core.Router} */ app.core.Response.prototype.getRouter = function() { return this.router_; }; /** * Render the template with the provided data. * @param {Function} template The template being rendered. * @param {Object=} opt_data The data being passed to the template. Usually it's * {mvc.Model} object. * @param {Element=} opt_element The element having the template rendered in. * Defaults to document.body. */ app.core.Response.prototype.render = function(template, opt_data, opt_element) { let element = opt_element || document.body; let data = opt_data || {}; goog.soy.renderElement(element, template, data, this.request_.toJSON()); }; × Search results Close "},"core_router.js.html":{"id":"core_router.js.html","title":"Source: core/router.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/router.js /** * @fileoverview app.core.Router uses goog.History and hash tokens to hold and * manage the state of the application. * This class is modified mvc.Router class from PlastronJS library. * @see https://github.com/rhysbrettbowen/PlastronJS#mvcrouter * @author rhysbrettbowen@gmail.com (Rhys Brett-Bowen), * dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.core.Router'); goog.require('goog.History'); goog.require('goog.array'); goog.require('goog.events'); goog.require('goog.history.Html5History'); /** * @param {boolean=} opt_noFragment set to true to hide fragment when using * HTML5 history. * @param {!goog.html.TrustedResourceUrl=} opt_blankPage url to a blank page - * needed if HTML5 is not * available and you don't want to show the fragment. * @param {HTMLInputElement=} opt_input The hidden input element to be used to * store the history token. If not provided, a hidden input element will * be created using document.write. * @param {HTMLIFrameElement=} opt_iframe The hidden iframe that will be used by * IE for pushing history state changes, or by all browsers if opt_noFragment * is true. If not provided, a hidden iframe element will be created using * document.write. * @constructor * @extends {goog.events.EventTarget} */ app.core.Router = function(opt_noFragment, opt_blankPage, opt_input, opt_iframe) { goog.base(this); this.history_ = goog.history.Html5History.isSupported() ? new goog.history.Html5History() : new goog.History(!!(opt_blankPage &amp;&amp; opt_noFragment), opt_blankPage, opt_input, opt_iframe); if (this.history_.setUseFragment) this.history_.setUseFragment(!opt_noFragment); goog.events.listen(this.history_, goog.history.EventType.NAVIGATE, this.onChange_, false, this); this.routes_ = []; this.currentFragment_ = ''; this.history_.setEnabled(true); }; goog.inherits(app.core.Router, goog.events.EventTarget); /** * Router event types * @enum {string} */ app.core.Router.EventType = { /* * event to trigger when route is about to change. */ ROUTE_EXPIRED: 'routeExpired' }; /** * Pass through the fragment for the URL * @param {string} fragment to set for the history token. */ app.core.Router.prototype.navigate = function(fragment) { this.history_.setToken(fragment); }; /** * Returns current routed fragment * @return {string} routed fragment. */ app.core.Router.prototype.getFragment = function() { return this.currentFragment_; }; /** * Define route as string or regex. /:abc/ will pass &quot;abc&quot; through as an * argument. *abc/def will pass through all after the * as an argument * * @param {string|RegExp} route to watch for. * @param {function(string)} fn should take in the token and any captured * strings. * @param {Object=} opt_context Object in whose context the function is to be * called (the global scope if none). */ app.core.Router.prototype.route = function(route, fn, opt_context) { if (goog.isString(route)) route = new RegExp('^' + goog.string.regExpEscape(route) .replace(/\\\\:\\w+/g, '([a-zA-Z0-9._-]+)') .replace(/\\\\\\*/g, '(.*)') .replace(/\\\\\\[/g, '(') .replace(/\\\\\\]/g, ')?') .replace(/\\\\\\{/g, '(?:') .replace(/\\\\\\}/g, ')?') + '$'); var completeRoute = { route: route, callback: fn, context: opt_context }; this.routes_.push(completeRoute); }; /** * Run route callback if route regexp matches fragment. * @param {Object} route Route object with context and route regexp. * @param {string} fragment URI fragment to match with. * @return {boolean} * @private */ app.core.Router.prototype.runRouteIfMatches_ = function(route, fragment) { var args = route.route.exec(fragment); if (args) { route.callback.apply(route.context, args); return true; } return false; }; /** * Route change handler. * @private */ app.core.Router.prototype.onChange_ = function() { var fragment = this.history_.getToken(); var locationPathname = window.location.pathname; if (goog.string.isEmptyOrWhitespace(fragment) &amp;&amp; locationPathname.length &gt; 1) { fragment = locationPathname; } if (fragment != this.currentFragment_) { this.dispatchEvent({ type: app.core.Router.EventType.ROUTE_EXPIRED, previous: this.currentFragment_, current: fragment }); this.currentFragment_ = fragment; goog.array.find(this.routes_ || [], function(route) { return this.runRouteIfMatches_(route, fragment); }, this); } }; /** * Go through all defined routes and run first matched. */ app.core.Router.prototype.checkRoutes = function() { var fragment = this.history_.getToken(); var locationPathname = window.location.pathname; if (goog.string.isEmptyOrWhitespace(fragment) &amp;&amp; locationPathname.length &gt; 1) { fragment = locationPathname; } this.currentFragment_ = fragment; goog.array.find(this.routes_ || [], function(route) { return this.runRouteIfMatches_(route, fragment); }, this); }; × Search results Close "},"core_types_actionfiltercontext.js.html":{"id":"core_types_actionfiltercontext.js.html","title":"Source: core/types/actionfiltercontext.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/types/actionfiltercontext.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.types.ActionFilterContext'); /** * @param {app.core.Request} request * @param {app.core.Response} response * @constructor */ app.core.types.ActionFilterContext = function(request, response) { /** * @type {app.core.Request} * @private */ this.request_ = request; /** * @type {app.core.Response} * @private */ this.response_ = response; }; /** * @return {app.core.Request} */ app.core.types.ActionFilterContext.prototype.getRequest = function() { return this.request_; }; /** * @return {app.core.Response} */ app.core.types.ActionFilterContext.prototype.getResponse = function() { return this.response_; }; × Search results Close "},"core_types_actionfilteritem.js.html":{"id":"core_types_actionfilteritem.js.html","title":"Source: core/types/actionfilteritem.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/types/actionfilteritem.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.types.ActionFilterItem'); goog.require('app.core.ActionFilter'); goog.require('app.core.types.ApplicationFilterItem'); /** * @param {!app.core.ActionFilter} filter * @param {string|RegExp=} opt_route Route to watch for. * @param {number=} opt_order * @constructor * @extends {app.core.types.ApplicationFilterItem} */ app.core.types.ActionFilterItem = function(filter, opt_route, opt_order) { goog.base(this, filter, opt_order); /** * @type {string|RegExp} * @private */ this.route_ = goog.isDefAndNotNull(opt_route) ? opt_route : ''; }; goog.inherits(app.core.types.ActionFilterItem, app.core.types.ApplicationFilterItem); /** * @return {string|RegExp} */ app.core.types.ActionFilterItem.prototype.getRoute = function() { return this.route_; }; × Search results Close "},"core_types_applicationfilteritem.js.html":{"id":"core_types_applicationfilteritem.js.html","title":"Source: core/types/applicationfilteritem.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/types/applicationfilteritem.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // goog.provide('app.core.types.ApplicationFilterItem'); /** * @param {!app.core.ApplicationFilter|T} filter * @param {number=} opt_order * @constructor * @template T */ app.core.types.ApplicationFilterItem = function(filter, opt_order) { /** * @type {!app.core.ApplicationFilter|T} * @private */ this.filter_ = filter; /** * @type {number} * @private */ this.order_ = goog.isDefAndNotNull(opt_order) ? opt_order : 0; }; /** * @return {!app.core.ApplicationFilter|T} */ app.core.types.ApplicationFilterItem.prototype.getFilter = function() { return this.filter_; }; /** * @return {number} */ app.core.types.ApplicationFilterItem.prototype.getOrder = function() { return this.order_; }; × Search results Close "},"core_exports.js.html":{"id":"core_exports.js.html","title":"Source: core/exports.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: core/exports.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Declare the public API. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('app.exports'); // TODO: Declare the public API. × Search results Close "},"pwk_editor_nodes_branchnode.js.html":{"id":"pwk_editor_nodes_branchnode.js.html","title":"Source: pwk/editor/nodes/branchnode.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/branchnode.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview TODO: add description * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.BranchNode'); goog.require('pwk.Node'); /** * @param {pwk.NodeTypes} type Type of node * @param {pwk.Document} doc Parent document object. * @constructor * @extends {pwk.Node} */ pwk.BranchNode = function(type, doc) { goog.base(this, type, doc); }; goog.inherits(pwk.BranchNode, pwk.Node); /** * Component default css class * @type {string} */ pwk.BranchNode.prototype.CSS_CLASS = 'pwk-branchnode'; /** * @inheritDoc */ pwk.BranchNode.prototype.getSize = function() { return goog.style.getSize(this.getElement()); }; × Search results Close "},"pwk_editor_nodes_node.js.html":{"id":"pwk_editor_nodes_node.js.html","title":"Source: pwk/editor/nodes/node.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/node.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Node represent a content element on the document. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Node'); goog.require('goog.dom.classlist'); goog.require('goog.ui.Component'); goog.require('pwk.NodeFormatter'); /** * @param {pwk.NodeTypes} type Type of node * @param {pwk.Document} doc Parent document object. * * @constructor * @extends {goog.ui.Component} */ pwk.Node = function(type, doc) { goog.base(this); /** * @type {Array.&lt;pwk.NodeAttribute&gt;} * @private */ this.attributes_ = []; /** * @type {pwk.NodeTypes} * @private */ this.type_ = type; /** * @type {boolean} */ this.isChild_ = false; /** * @type {pwk.Document} * @protected */ this.document_ = doc; // Apply global attributes pwk.NodeFormatter.applyGlobalDocumentFormation(doc, this); }; goog.inherits(pwk.Node, goog.ui.Component); /** @inheritDoc */ pwk.Node.prototype.createDom = function() { // Create element and apply classes this.setElementInternal(this.dom_.createElement('div')); goog.dom.classlist.add(this.getElement(), this.CSS_CLASS); }; /** @inheritDoc */ pwk.Node.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove attributes for(var i = 0; i &lt; this.attributes_.length; i++) { goog.array.removeAt(this.attributes_, i); } this.unselect(); delete this.attributes_; }; /** @inheritDoc */ pwk.Node.prototype.addChild = function(child, opt_render) { goog.base(this, 'addChild', child, opt_render); }; /** @inheritDoc */ pwk.Node.prototype.addChildAt = function(child, index, opt_render) { if(child instanceof pwk.Node) { child.isChild(true); } goog.base(this, 'addChildAt', child, index, opt_render); }; /** * Determine or set that node is a child. * @param {boolean=} opt_child * @return {boolean} */ pwk.Node.prototype.isChild = function(opt_child) { if(goog.isDefAndNotNull(opt_child)) { this.isChild_ = opt_child; } return this.isChild_; }; /** * @return {pwk.NodeTypes} Type of the node */ pwk.Node.prototype.getType = function() { return this.type_; }; /** * @return {Array.&lt;pwk.NodeAttribute&gt;} */ pwk.Node.prototype.getAttributes = function() { return this.attributes_; }; /** * Get attribute for specified type. * @param {pwk.NodeAttributeTypes} type * @return {?pwk.NodeAttribute} */ pwk.Node.prototype.getAttribute = function(type) { return goog.array.find(this.attributes_, function(att) { return att.getType() == type; }); }; /** * Gets the height and width of an node element, even if its display is none. * @return {!goog.math.Size} Object with width/height properties. */ pwk.Node.prototype.getSize = function() { return goog.style.getSize(this.getElement()); }; /** * Set attribute. If attribute with specified type already exist, old data will * be rewritten or not, depended from opt_isMergeData argument. Data will be * rewritten by default. * @param {pwk.NodeAttributeTypes} type * @param {string} value * @param {boolean=} opt_isMergeData */ pwk.Node.prototype.setAttribute = function(type, value, opt_isMergeData) { var attribute = goog.array.find(this.attributes_, function(att) { return att.getType() == type; }); if(goog.isDefAndNotNull(attribute)) { attribute.setValue(value, opt_isMergeData); } else { goog.array.insert(this.attributes_, new pwk.NodeAttribute(type, value)); } this.dispatchEvent(pwk.Node.EventType.ATTRIBUTES_CHANGED); }; /** * Returns the 0-based index of the given node component, or -1 if no such * node is found. * @return {number} */ pwk.Node.prototype.getIndex = function() { return this.document_.indexOfNode(this); }; /** * Make selection for node content by range */ pwk.Node.prototype.select = goog.abstractMethod; /** * Remove selection from node */ pwk.Node.prototype.unselect = goog.abstractMethod; /** * Remove content range from node * @param {pwk.primitives.NodeSelectionRange} nodeSelectionRange * @param {boolean=} opt_isBack Direction, in case if range is collapsed * required to determine which key was pressed, Backspace or Delete. */ pwk.Node.prototype.removeRange = goog.abstractMethod; /** * Get first line of the current node. * @return {pwk.Line} */ pwk.Node.prototype.getFirstLine = goog.abstractMethod; /** * Get latest line of the node. * @return {pwk.Line} */ pwk.Node.prototype.getLastLine = goog.abstractMethod; /** * Get node offset regarding specified line offset. * @param {pwk.Line} line * @param {number} lineOffset * @return {number} */ pwk.Node.prototype.getOffsetByLineOffset = goog.abstractMethod; /** * Remove node content based on current selection * @param {boolean=} opt_isBack Direction, in case if range is collapsed * required to determine which key was pressed, Backspace or Delete. */ pwk.Node.prototype.removeSelection = goog.abstractMethod; // Actions: // - update selection range // - remove // - unselect // - dispose /** * Specifies whether there can be this node is split between pages. * @return {boolean} */ pwk.Node.prototype.isSplittable = goog.abstractMethod; /** * @param {number} offset 0-based index node offset. * @return {pwk.Node} Returns new node or next linked node, in case if offset * is end of the current node and next exist linked node. */ pwk.Node.prototype.split = goog.abstractMethod; /** * Set previous linked node. * @param {pwk.Node} node */ pwk.Node.prototype.setPreviousLinkedNode = goog.abstractMethod; /** * Set next linked node. * @param {pwk.Node} node */ pwk.Node.prototype.setNextLinkedNode = goog.abstractMethod; /** * Get previous linked node. If node does not linked returns null. * @return {?pwk.Node} */ pwk.Node.prototype.getPreviousLinkedNode = goog.abstractMethod; /** * Get next linked node. If node does not linked returns null. * @return {?pwk.Node} */ pwk.Node.prototype.getNextLinkedNode = goog.abstractMethod; /** * Get lines content length * 0 is means that no content inside the node * @return {number} */ pwk.Node.prototype.getLength = goog.abstractMethod; /** * Component default css class * @type {string} */ pwk.Node.prototype.CSS_CLASS = 'pwk-node'; /** * @enum {string} */ pwk.Node.EventType = { ATTRIBUTES_CHANGED: goog.events.getUniqueId('attributes_changed') }; × Search results Close "},"pwk_editor_document.js.html":{"id":"pwk_editor_document.js.html","title":"Source: pwk/editor/document.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/document.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Document contains all information about edited information and * information itself, as child components. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Document'); goog.provide('pwk.Document.EventType'); goog.provide('pwk.Document.NodeRemovedEvent'); goog.require('goog.dom.classlist'); goog.require('goog.events.Event'); goog.require('goog.ui.Component'); goog.require('pwk.BranchNode'); goog.require('pwk.DocumentSettings'); goog.require('pwk.LeafNode'); goog.require('pwk.NodeTypes'); goog.require('pwk.Page'); goog.require('pwk.PageSettings'); goog.require('pwk.Pagination'); goog.require('pwk.Range'); goog.require('pwk.Selection'); goog.require('pwk.utils.style'); /** * Represent document of editor. * @extends {goog.ui.Component} * @constructor */ pwk.Document = function() { goog.base(this); /** * @type {pwk.Selection} * @private */ this.selection_ = new pwk.Selection(this); /** * @type {pwk.Pagination} * @private */ this.pagination_ = new pwk.Pagination(this); /** * Array of ids of child @code{pwk.Node} components. Used to hold order of * nodes in document. * @type {Array.&lt;string&gt;} * @private */ this.nodeIndex_ = []; /** * Array of ids of child @code{pwk.Page} components. Used to hold order of * pages in document. * @type {Array.&lt;string&gt;} * @private */ this.pageIndex_ = []; // TODO: move it to the pwk.Pagination component? /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); /** * @type {pwk.DocumentSettings} * @private */ this.documentSettings_ = pwk.DocumentSettings.getInstance(); }; goog.inherits(pwk.Document, goog.ui.Component); /** @inheritDoc */ pwk.Document.prototype.createDom = function() { // Create element and apply classes this.setElementInternal(this.dom_.createElement('div')); var el = this.getElement(); goog.dom.classlist.add(el, pwk.Document.CSS_CLASS); // Set document size, should be equal of page width goog.style.setWidth(el, this.pageSettings_.getSize().width + 'px'); // Initialize document instance for global settings this.documentSettings_.initialize(this); this.pageSettings_.initialize(this); }; /** @inheritDoc */ pwk.Document.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); // Initialize events this.initializeEvents_(); // Initialize selection this.selection_.initialize(); // First document initialization this.initializeDocument_(); }; /** * @return {pwk.Selection} */ pwk.Document.prototype.getSelection = function() { return this.selection_; }; /** * Add text value to current caret position. * @param {string|Text} value */ pwk.Document.prototype.addValue = function(value) { // TODO: Refactoring required let selection = this.selection_; let range = selection.getRange(); // remove selection selection.removeSelection(); value = typeof value == 'object' ? value.nodeValue : value; if (range.isCollapsed()) { let googString = goog.string; let isSpace = googString.isSpace( googString.normalizeWhitespace(/** @type {string} */(value))); let startLine = range.getStartLine(); let startLineOffset = range.getStartLineOffset(); let isLastPositionBefore = !(startLine.getLength() - startLineOffset); let startLineLength = startLine.getLength(); let prevNodeValue = startLine.getTextNodeValueAtOffset(startLineLength - 1); let isPrevNodeValueSpace = prevNodeValue ? googString.isSpace(googString.normalizeWhitespace(prevNodeValue)) : false; let startNodeOffset = range.getStartNodeOffset(); let lineBelow = range.getStartNode() .getLineAt(range.getStartLineRangeInfo().getLineIndex() + 1); let linkedNodeRangeInfo = range.getStartNode() .getRangeInfoByLinkedNodesOffset( range.getStartLineRangeInfo().getLinkedNodeOffset()); let linkedLineBelow = range.getStartNode() .getLineAt(linkedNodeRangeInfo.getLineIndex() + 1, true); let offset = value.length; if (lineBelow != null &amp;&amp; !isSpace &amp;&amp; isLastPositionBefore &amp;&amp; isPrevNodeValueSpace) { range.setStartPosition(lineBelow, startNodeOffset + offset); range.setEndPosition(lineBelow, startNodeOffset + offset); lineBelow.insertValue(/** @type {string} */(value), 0); } else if (linkedLineBelow != null &amp;&amp; linkedLineBelow.getParentNode() !== range.getStartNode() &amp;&amp; !isSpace &amp;&amp; isLastPositionBefore &amp;&amp; isPrevNodeValueSpace) { range.setStartPosition(linkedLineBelow, offset); range.setEndPosition(linkedLineBelow, offset); linkedLineBelow.insertValue(/** @type {string} */(value), 0); } else if (startLineOffset == 0 &amp;&amp; startNodeOffset != 0 &amp;&amp; isSpace) { // If is start of line and value is space, add it to the end of line above // Logic to align text range.getStartNode() .insertValue(/** @type {string} */(value), startNodeOffset); range.setStartPosition(startLine, startNodeOffset + offset, true); range.setEndPosition(startLine, startNodeOffset + offset, true); } else if (startLineOffset == 0 &amp;&amp; linkedNodeRangeInfo.getLinkedNodeOffset() &gt; 0 &amp;&amp; isSpace) { // If is start of line and value is space and it is first line of linked // node, add it to the end of last linked line above linkedNodeRangeInfo.getLine().getParentNode() .insertValue(/** @type {string} */(value), linkedNodeRangeInfo.getNodeOffset()); range.setStartPosition(startLine, startNodeOffset, true); range.setEndPosition(startLine, startNodeOffset, true); } else { startLine.insertValue(/** @type {string} */(value), startLineOffset); selection.moveCaretRight(true); var isLastPositionAfter = !(range.getStartLine().getLength() - range.getStartLineOffset()); if (isSpace &amp;&amp; !isLastPositionBefore &amp;&amp; isLastPositionAfter) { var rangeStartNode = range.getStartNode(); lineBelow = rangeStartNode.getLineAt( range.getStartLineRangeInfo().getLineIndex() + 1); if (lineBelow != null) { startNodeOffset = range.getStartNodeOffset(); range.setStartPosition(lineBelow, startNodeOffset, true); range.setEndPosition(lineBelow, startNodeOffset, true); } else { linkedNodeRangeInfo = rangeStartNode.getRangeInfoByLinkedNodesOffset( range.getStartLineRangeInfo().getLinkedNodeOffset()); linkedLineBelow = rangeStartNode.getLineAt( linkedNodeRangeInfo.getLineIndex() + 1, true); range.setStartPosition(linkedLineBelow, 0, true); range.setEndPosition(linkedLineBelow, 0, true); } } } selection.updateCaretFromRange(); } }; /** * Create new line. */ pwk.Document.prototype.newLine = function() { let selection = this.selection_; let range = selection.getRange(); let startNode = range.getStartNode(); // TODO: Collapse/Selection detection // Create new line depend of current focused node. switch (startNode.getType()) { case pwk.NodeTypes.PARAGRAPH: let startNodeLength = startNode.getLength(); let paragraph; let paragraphIndex; // Checking, if line should be splitted if (range.getStartNodeOffset() == 0 &amp;&amp; !goog.isDefAndNotNull(startNode.getPreviousLinkedNode())) { // Just create empty node above paragraph = new pwk.LeafNode(pwk.NodeTypes.PARAGRAPH, this); // Create new paragraph above this.addNodeAt(paragraph, this.indexOfNode(startNode)); } else { if (startNodeLength &gt;= range.getStartNodeOffset()) { paragraph = startNode.split(range.getStartNodeOffset()); } else { paragraph = new pwk.LeafNode(pwk.NodeTypes.PARAGRAPH, this); } // Get current paragraph position paragraphIndex = this.indexOfNode(startNode) + 1; if (!paragraph.isInDocument()) { // Create new paragraph if it's not in the document this.addNodeAt(paragraph, paragraphIndex, true); } // Update range var line = paragraph.getFirstLine(); selection.setRange(pwk.Range.createFromNodes(line, 0, line, 0)); } selection.updateCaretFromRange(); paragraph.dispatchEvent( new pwk.LeafNode.NodeContentChangedEvent( paragraph.getLineAt(1, true))); break; } }; /** * Delete document content based on current selection range. * @param {boolean=} opt_isBack Direction */ pwk.Document.prototype.deleteSelection = function(opt_isBack) { let selection = this.selection_; let range = selection.getRange(); let isReversed = range.isReversed(); let topNodeIndex = isReversed ? this.indexOfNode(range.getEndNode()) : this.indexOfNode(range.getStartNode()); let bottomNodeIndex = isReversed ? this.indexOfNode(range.getStartNode()) : this.indexOfNode(range.getEndNode()); if (range.isCollapsed()) { // if (opt_isBack === true) { // Backspace console.log('Backspace'); } else { // Delete console.log('Delete'); } // Remove selection range } else { let startNode; let endNode; // Process content for (var i = topNodeIndex; i &lt;= bottomNodeIndex; i++) { var processedNode = /** @type {pwk.Node} */(this.getNodeAt(i)); switch (i) { case topNodeIndex: startNode = processedNode; break; case bottomNodeIndex: endNode = processedNode; break; } // - Remove selection // - Check if length equal 0,then remove node (start == start, end == end) // - Update range processedNode.removeSelection(); if (!processedNode.isInDocument() &amp;&amp; !range.isCollapsed()) { // Looks like this node is selected entirely and was removed from // document, so let's correct variables bottomNodeIndex = isReversed ? this.indexOfNode(range.getStartNode()) : this.indexOfNode(range.getEndNode()); i--; } } } selection.updateCaretFromRange(range); this.dispatchEvent(pwk.Document.EventType.FILLING_CHANGE); }; /** * Add page to the end of document. * @param {pwk.Page} page */ pwk.Document.prototype.addPage = function(page) { this.addChild(page, true); goog.array.insert(this.pageIndex_, page.getId()); }; /** * Add page to the document at the given 0-based index. * @param {pwk.Page} page * @param {number} index */ pwk.Document.prototype.addPageAt = function(page, index) { let prevPage; let prevPageIndex; let prevPageId = this.pageIndex_.length ? this.pageIndex_[index - 1] : null; if (goog.isDefAndNotNull(prevPageId)) { prevPage = this.getChild(prevPageId); prevPageIndex = this.indexOfChild(prevPage); this.addChildAt(page, prevPageIndex + 1, true); goog.array.insertAt(this.pageIndex_, page.getId(), index); } else { this.addChild(page, true); goog.array.insert(this.pageIndex_, page.getId()); } }; /** * Calls the given function on each of this document's page in order. If * {@code opt_obj} is provided, it will be used as the 'this' object in the * function when called. The function should take two arguments: the page * component and its 0-based index. The return value is ignored. * @param {Function} f The function to call for every page component; should * take 2 arguments (the page and its index). * @param {Object=} opt_obj Used as the 'this' object in f when called. */ pwk.Document.prototype.forEachPage = function(f, opt_obj) { if (this.pageIndex_) { goog.array.forEach(this.pageIndex_, function(padeId, index) { var page = this.getChild(padeId); f.call(opt_obj, page, index); }); } }; /** * Returns the page with the given ID, or null if no such page exists. * @param {string} id Page ID. * @return {pwk.Page?} The page with the given ID; null if none. */ pwk.Document.prototype.getPage = function(id) { return /** @type {pwk.Page?} */(this.getChild(id)); }; /** * Returns the page at the given index, or null if the index is out of bounds. * @param {number} index 0-based index. * @return {pwk.Page?} The page at the given index; null if none. */ pwk.Document.prototype.getPageAt = function(index) { var pageId = this.pageIndex_.length ? this.pageIndex_[index] || '' : ''; return this.getPage(pageId); }; /** * Returns the number of pages of this document. * @return {number} The number of pages. */ pwk.Document.prototype.getPageCount = function() { return this.pageIndex_.length; }; /** * Returns an array containing the IDs of the pages of this document, or an * empty array if the document has no pages. * @return {Array.&lt;string&gt;} Page component IDs. */ pwk.Document.prototype.getPageIds = function() { return this.pageIndex_; }; /** * Returns the 0-based index of the given page component, or -1 if no such * page is found. * @param {?pwk.Page|string} page The page component. * @return {number} 0-based index of the page component; -1 if not found. */ pwk.Document.prototype.indexOfPage = function(page) { var pageId = goog.isString(page) ? page : page.getId(); return (this.pageIndex_ &amp;&amp; pageId) ? goog.array.indexOf(this.pageIndex_, pageId) : -1; }; /** * Removes the given page from this document, and returns it. Throws an error * if the argument is invalid or if the specified page isn't found in the * document. The argument can either be a string (interpreted as the * ID of the page component to remove) or the page component itself. * @param {string|pwk.Page} page The ID of the page to remove, or the page * component itself. * @return {pwk.Page} The removed component, if any. */ pwk.Document.prototype.removePage = function(page) { goog.array.remove(this.pageIndex_, goog.isString(page) ? page : page.getId()); var removedPage = /** @type {pwk.Page} */(this.removeChild(page, true)); if (removedPage) { goog.dispose(removedPage); } return removedPage; }; /** * Removes the page at the given index from this document, and returns it. * Throws an error if the argument is out of bounds, or if the specified page * isn't found in the document. * * @param {number} index 0-based index of the page to remove. * @return {pwk.Page} The removed page, if any. */ pwk.Document.prototype.removePageAt = function(index) { return this.removePage(this.pageIndex_[index]); }; /** * Add node to the end of document. * @param {pwk.Node} node */ pwk.Document.prototype.addNode = function(node) { this.addChild(node); var nodeIndex = this.nodeIndex_.length; this.pagination_.addNode(node); // To prevent duplicates in case of creating new page var nodeId = node.getId(); if (goog.array.indexOf(this.nodeIndex_, nodeId) == -1) { goog.array.insertAt(this.nodeIndex_, nodeId, nodeIndex); } this.dispatchEvent(pwk.Document.EventType.FILLING_CHANGE); }; /** * Add node to the document at the given 0-based index. * @param {pwk.Node} node * @param {number} index * @param {boolean=} opt_renderAfter Is required to render the node after * previous node or before sibling? */ pwk.Document.prototype.addNodeAt = function(node, index, opt_renderAfter) { let prevNode; let prevNodeIndex; let prevNodeId = /** @type {string} */(this.nodeIndex_.length ? this.nodeIndex_[index - 1] : null); if (goog.isDefAndNotNull(prevNodeId) || index == 0) { if (index == 0) { this.addChildAt(node, 0); } else { prevNode = this.getNode(prevNodeId); prevNodeIndex = this.indexOfNode(prevNode); this.addChildAt(node, prevNodeIndex + 1); } this.pagination_.addNodeAt(node, index, opt_renderAfter); // To prevent duplicates in case of creating new page let nodeId = node.getId(); if (goog.array.indexOf(this.nodeIndex_, nodeId) == -1) { goog.array.insertAt(this.nodeIndex_, nodeId, index); } this.dispatchEvent(pwk.Document.EventType.FILLING_CHANGE); } else { this.addNode(node); } }; /** * Calls the given function on each of this document's node in order. If * {@code opt_obj} is provided, it will be used as the 'this' object in the * function when called. The function should take two arguments: the node * component and its 0-based index. The return value is ignored. * @param {Function} f The function to call for every node component; should * take 2 arguments (the node and its index). * @param {Object=} opt_obj Used as the 'this' object in f when called. */ pwk.Document.prototype.forEachNode = function(f, opt_obj) { if (this.nodeIndex_) { goog.array.forEach(this.nodeIndex_, function(nodeId, index) { var node = this.getChild(nodeId); f.call(opt_obj, node, index); }, this); } }; /** * Returns the node with the given ID, or null if no such node exists. * @param {string} id Node ID. * @return {pwk.Node?} The node with the given ID; null if none. */ pwk.Document.prototype.getNode = function(id) { return /** @type {pwk.Node?} */(this.getChild(id)); }; /** * Returns the node at the given index, or null if the index is out of bounds. * @param {number} index 0-based index. * @return {pwk.Node?} The node at the given index; null if none. */ pwk.Document.prototype.getNodeAt = function(index) { var nodeId = this.nodeIndex_.length ? this.nodeIndex_[index] || '' : ''; return this.getNode(nodeId); }; /** * Returns the number of nodes of this document. * @return {number} The number of nodes. */ pwk.Document.prototype.getNodeCount = function() { return this.nodeIndex_.length; }; /** * Returns an array containing the IDs of the nodes of this document, or an * empty array if the document has no nodes. * @return {Array.&lt;string&gt;} Node component IDs. */ pwk.Document.prototype.getNodeIds = function() { return this.nodeIndex_; }; /** * Returns the 0-based index of the given node component, or -1 if no such * node is found. * @param {?pwk.Node} node The node component. * @return {number} 0-based index of the node component; -1 if not found. */ pwk.Document.prototype.indexOfNode = function(node) { return (this.nodeIndex_ &amp;&amp; node) ? goog.array.indexOf(this.nodeIndex_, node.getId()) : -1; }; /** * Do the same as {@code pwk.Document.prototype.removeNode} but did not deleting * it from index. * @param {string|pwk.Node} node The ID of the node to remove, or the node * component itself. * @return {pwk.Node} The removed node, if any. */ pwk.Document.prototype.unlinkNode = function(node) { return /** @type {pwk.Node} */(this.removeChild(node, true)); }; /** * Removes the given node from this document, returns and disposes of it. * Throws an error if the argument is invalid or if the specified node isn't * found in the document. The argument can either be a string (interpreted as * the ID of the node component to remove) or the node component itself. * @param {string|pwk.Node} node The ID of the node to remove, or the node * component itself. * @return {pwk.Node} The removed node, if any. */ pwk.Document.prototype.removeNode = function(node) { goog.array.remove(this.nodeIndex_, goog.isString(node) ? node : node.getId()); var removedNode = this.unlinkNode(node); if (removedNode) { goog.dispose(removedNode); } // trigger events this.dispatchEvent(new pwk.Document.NodeRemovedEvent(removedNode)); // return removed node return removedNode; }; /** * Removes the node at the given index from this document, returns and disposes * of it. Throws an error if the argument is out of bounds, or if the specified * node isn't found in the document. * @param {number} index 0-based index of the node to remove. * @return {pwk.Node} The removed node, if any. */ pwk.Document.prototype.removeNodeAt = function(index) { return this.removeNode(this.nodeIndex_[index]); }; /** * Get {@code pwk.Pagination} document instance * @return {pwk.Pagination} */ pwk.Document.prototype.getPagination = function() { return this.pagination_; }; /** * Return index of page/nodes equivalent. * @return {Array.&lt;Array.&lt;string&gt;&gt;} */ pwk.Document.prototype.getPaginationIndex = function() { return this.pagination_.getPaginationIndex(); }; /** * Initialize document * @private */ pwk.Document.prototype.initializeDocument_ = function() { // If document empty, add empty paragraph if (!this.getNodeCount()) { var paragraph = new pwk.LeafNode(pwk.NodeTypes.PARAGRAPH, this); this.addNode(paragraph); this.dispatchEvent( new pwk.LeafNode.NodeContentChangedEvent(paragraph.getFirstLine())); // Initialize Range var range = pwk.Range.createFromNodes(paragraph.getFirstLine(), 0, paragraph.getFirstLine(), 0); this.selection_.setRange(range); this.selection_.updateCaretFromRange(); } }; /** * Initialize component and related components events * @private */ pwk.Document.prototype.initializeEvents_ = function() { this.listen(pwk.Document.EventType.FILLING_CHANGE, this.onDocumentFillingChangedEventHandler_); }; /** * Handler of filling document content. Called each time, when height of * document content was changed. * @param {goog.events.Event} e * @private */ pwk.Document.prototype.onDocumentFillingChangedEventHandler_ = function(e) { let pagination = this.pagination_; let selection = this.selection_; let range = selection.getRange(); if (range != null) { // If document become bigger then available on current pages, move nodes to // other pages or create more page and move them there pagination.checkOverflow(range.getStartNode().getId()); // Fill document pages if content height was changed pagination.checkFilling(); } }; /** * Component default css class * @type {string} */ pwk.Document.CSS_CLASS = 'pwk-document'; /** * Event types that can be stopped/started. * @enum {string} */ pwk.Document.EventType = { FILLING_CHANGE: goog.events.getUniqueId('filling_changed'), NODE_REMOVED: goog.events.getUniqueId('node_removed') }; /** * @param {pwk.Node} node * @extends {goog.events.Event} * @constructor */ pwk.Document.NodeRemovedEvent = function(node) { goog.events.Event.call(this, pwk.Document.EventType.NODE_REMOVED, node); /** * @type {pwk.Node} */ this.removedNode = node; }; goog.inherits(pwk.Document.NodeRemovedEvent, goog.events.Event); × Search results Close "},"pwk_editor_documentsettings.js.html":{"id":"pwk_editor_documentsettings.js.html","title":"Source: pwk/editor/documentsettings.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/documentsettings.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview This class contains shared settings of document. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.DocumentSettings'); goog.require('goog.style'); /** * Initialize {pwk.PageSettings} component. * @constructor */ pwk.DocumentSettings = function() { /** * Document line height. * @type {string} * @private */ this.lineHeight_ = '1.5'; /** * Document font size. * @type {string} * @private */ this.fontSize_ = '12pt'; /** * Document instance. * @type {pwk.Document} * @private */ this.document_; }; goog.addSingletonGetter(pwk.DocumentSettings); /** * Get default line-height for current document. * @return {string} */ pwk.DocumentSettings.prototype.getLineHeight = function() { return this.lineHeight_; }; /** * Set default line-height for current document. * @param {string} value */ pwk.DocumentSettings.prototype.setLineHeight = function(value) { this.lineHeight_ = value; this.applyLineHeight_(); }; /** * Get default font size of current document. * @return {string} */ pwk.DocumentSettings.prototype.getFontSize = function() { return this.fontSize_; }; /** * Set default font size of current document. * @param {string} value */ pwk.DocumentSettings.prototype.setFontSize = function(value) { this.fontSize_ = value; this.applyFontSize_(); }; /** * Initialize document property to manage global settings of document. * @param {pwk.Document} doc */ pwk.DocumentSettings.prototype.initialize = function(doc) { this.document_ = doc; this.applyLineHeight_(); this.applyFontSize_(); }; /** * Apply line height settings to document. * @private */ pwk.DocumentSettings.prototype.applyLineHeight_ = function() { goog.style.setStyle( this.getDocument_().getElement(), 'line-height', this.lineHeight_); }; /** * Apply font size settings to document. * @private */ pwk.DocumentSettings.prototype.applyFontSize_ = function() { this.getDocument_().getElement().style.fontSize = this.fontSize_; }; /** * @return {pwk.Document} * @private */ pwk.DocumentSettings.prototype.getDocument_ = function() { if (!goog.isDefAndNotNull(this.document_)) { throw new Error('Document should be initialized!'); } return this.document_; }; × Search results Close "},"pwk_editor_editor.js.html":{"id":"pwk_editor_editor.js.html","title":"Source: pwk/editor/editor.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/editor.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Rich Text Editor. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Editor'); goog.require('goog.dom.classlist'); goog.require('goog.dom.iframe'); goog.require('goog.editor.icontent'); goog.require('goog.events.EventType'); goog.require('goog.events.FocusHandler'); goog.require('goog.events.KeyCodes'); goog.require('goog.events.KeyHandler'); goog.require('goog.events.KeyHandler.EventType'); goog.require('goog.events.KeyNames'); goog.require('goog.json'); goog.require('goog.text.LoremIpsum'); goog.require('goog.ui.Component'); goog.require('goog.ui.KeyboardShortcutHandler'); goog.require('pwk.Document'); goog.require('pwk.Shortcuts.Default'); goog.require('pwk.Shortcuts.MacOS'); /** * Main class of PWK Editor. * @constructor * @extends {goog.ui.Component} */ pwk.Editor = function() { goog.base(this); /** * @type {goog.events.KeyHandler} * @private */ this.keyHandler_; /** * Event target that the event listener should be attached to. * @type {goog.events.EventTarget|EventTarget} * @private */ this.keyTarget_; /** * Keyboard shortcuts handler. * @type {goog.ui.KeyboardShortcutHandler} * @private */ this.keyboardShortcutHandler_; /** * @type {pwk.Document} * @private */ this.document_ = new pwk.Document(); /** * Focus handler. * @type {goog.events.FocusHandler} * @private */ this.focusHandler_ = null; /** * @type {pwk.Selection} * @private */ this.selection_ = this.document_.getSelection(); /** * @type {pwk.Range} * @private */ this.startSelectionRange_; /** * Indicated is selection of document started or not * @type {boolean} * @private */ this.isSelectionStarted_ = false; /** * @type {goog.events.BrowserEvent} * @private */ this.scrollLoopBrowserEvent_; /** * @type {boolean} * @private */ this.scrollLoopInProgress_ = false; }; goog.inherits(pwk.Editor, goog.ui.Component); /** @inheritDoc */ pwk.Editor.prototype.createDom = function() { // Create element and apply classes this.setElementInternal(this.dom_.createElement('div')); let el = this.getElement(); goog.dom.classlist.add(el, pwk.Editor.CSS_CLASS); // Set editor focusable goog.dom.setFocusableTabIndex(el, true); el.focus(); }; /** @inheritDoc */ pwk.Editor.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); var element = this.getElement(); // Initialize private members this.keyHandler_ = new goog.events.KeyHandler(element); this.keyTarget_ = element; this.keyboardShortcutHandler_ = new goog.ui.KeyboardShortcutHandler(this.keyTarget_); this.focusHandler_ = new goog.events.FocusHandler(element); // Add children component this.addChild(this.document_, true); // Editor is focused? if (document.activeElement != element) { element.focus(); } goog.style.setUnselectable(element, true); // Initialize events this.initializeEvents_(); // TODO: [Dmytro Antonenko] Just for current development stage!! this.addTestText(true); }; /** * Initialize key event handler. * @private */ pwk.Editor.prototype.initializeEvents_ = function() { this.getHandler() .listen(this.keyboardShortcutHandler_, goog.ui.KeyboardShortcutHandler.EventType.SHORTCUT_TRIGGERED, this.handleKeyboardShortcut_) .listen(this.focusHandler_, goog.events.FocusHandler.EventType.FOCUSIN, this.onFocusIn_) .listen(this.focusHandler_, goog.events.FocusHandler.EventType.FOCUSOUT, this.onFocusOut_) .listen(this.keyHandler_, goog.events.KeyHandler.EventType.KEY, this.handleKeyEvent_) .listen(this.keyTarget_, goog.events.EventType.MOUSEDOWN, this.onMouseDown_, true) .listen(document, goog.events.EventType.MOUSEMOVE, this.onMouseMove_, true) .listen(document, goog.events.EventType.MOUSEUP, this.onMouseUp_, true); // Register keyboard shortcuts this.registerKeyboardShortcut_(this.keyboardShortcutHandler_); }; /** * Handles mousedown event. * @param {goog.events.BrowserEvent} e Mouse event to handle. * @private */ pwk.Editor.prototype.onMouseDown_ = function(e) { if (e.isMouseActionButton()) { let editorEl = this.getElement(); let selection = this.selection_; // Editor is focused? if (document.activeElement != editorEl) { editorEl.focus(); } this.isSelectionStarted_ = true; selection.removeSelection(); let selectionRange = selection.getSelectionRangeFromPoint(e.clientX, e.clientY); if (goog.isDefAndNotNull(selectionRange)) { selection.setRange(selectionRange); selection.updateCaretFromRange(); this.startSelectionRange_ = selectionRange; } e.preventDefault(); } }; /** * Handles mousemove event. * @param {goog.events.BrowserEvent} e Mouse event to handle. * @private */ pwk.Editor.prototype.onMouseMove_ = function(e) { if (e.isMouseActionButton() &amp;&amp; this.isSelectionStarted_) { let viewPortSize = goog.dom.getViewportSize(); if (e.clientY &lt; viewPortSize.height - 10 &amp;&amp; e.clientY &gt; 0) { this.scrollLoopInProgress_ = false; this.selectFromRangeToPoint_(this.startSelectionRange_, e.clientX, e.clientY); } else { if (e.clientY == 0) { // In case if browser opened in full screen mode, we can't receive // negative clientY, so let's assign fake offset e.clientY = -15; } // Cursor is out of document, let's scroll it this.scrollDocumentForSelection_(e); } } e.preventDefault(); }; /** * @param {goog.events.BrowserEvent} e * @private */ pwk.Editor.prototype.scrollDocumentForSelection_ = function(e) { if (e) { this.scrollLoopBrowserEvent_ = e; } if (!this.scrollLoopInProgress_) { this.scrollLoopInProgress_ = true; this.scrollInLoop_(); } }; /** * @param {pwk.Range} startSelectionRange * @param {number} x * @param {number} y * @private */ pwk.Editor.prototype.selectFromRangeToPoint_ = function(startSelectionRange, x, y) { let selection = this.selection_; let endSelectionRange = selection.getSelectionRangeFromPoint(x, y); let selectionRange = pwk.Range.createFromNodes(startSelectionRange.getStartLine(), startSelectionRange.getStartNodeOffset(), endSelectionRange.getEndLine(), endSelectionRange.getEndNodeOffset(), startSelectionRange.isStartOfStartLine(), endSelectionRange.isStartOfEndLine()); selection.selectDocument(selectionRange); }; /** * @private */ pwk.Editor.prototype.scrollInLoop_ = function() { if (this.scrollLoopInProgress_) { // TODO: Make a smooth scrolling let googDom = goog.dom; let viewPortSize = googDom.getViewportSize(); let viewPortWidth = viewPortSize.width; let viewPortHeight = viewPortSize.height; let container = googDom.getElementByClass(pwk.EditorContainer.CSS_CLASS); let e = this.scrollLoopBrowserEvent_; let clientX = e.clientX; let clientY = e.clientY; let offsetY = 0; if (clientX &lt; 0 || clientX &gt;= viewPortWidth) { clientX = clientX &lt; 0 ? 1 : viewPortWidth; } if (clientY &lt; 50 || clientY &gt;= viewPortHeight) { offsetY = clientY &lt; 0 ? clientY : clientY - viewPortHeight; clientY = clientY &lt; 0 ? 50 : viewPortHeight - 50; } let y = goog.style.getContainerOffsetToScrollInto( this.selection_.getRange().getEndLine().getElement(), container).y; let scroll = new goog.fx.dom.Scroll(container, [0, container.scrollTop], [0, y + ((offsetY == 0 ? 15 : offsetY) * 5)], 50); scroll.listen(goog.fx.Transition.EventType.END, goog.bind(function() { if (this.scrollLoopInProgress_) { this.selectFromRangeToPoint_(this.startSelectionRange_, clientX, clientY); this.scrollInLoop_(); } }, this)); scroll.play(); } }; /** * Handles mouseup event. * @param {goog.events.BrowserEvent} e Mouse event to handle. * @private */ pwk.Editor.prototype.onMouseUp_ = function(e) { if (e.isMouseActionButton()) { this.isSelectionStarted_ = false; this.startSelectionRange_ = null; this.scrollLoopInProgress_ = false; this.scrollLoopBrowserEvent_ = null; } e.preventDefault(); }; /** * Handles focus event. * @param {goog.events.BrowserEvent} e Browser's event object. * @private */ pwk.Editor.prototype.onFocusIn_ = function(e) { let selection = this.selection_; if (selection.getRange().isCollapsed()) { this.selection_.getCaret().show(); } }; /** * Handles focus out event. * @param {goog.events.BrowserEvent} e Browser's event object. * @private */ pwk.Editor.prototype.onFocusOut_ = function(e) { let selection = this.selection_; if (selection.getRange().isCollapsed()) { this.selection_.getCaret().hide(); } }; /** * Attempts to handle a keyboard event. * @param {goog.events.KeyEvent} e The key event. * @return {boolean} * @private */ pwk.Editor.prototype.handleKeyEvent_ = function(e) { let isStopPropagation = false; // Fix charCode for Opera on Mac if (goog.userAgent.OPERA &amp;&amp; goog.userAgent.MAC) { e.charCode = e.getBrowserEvent().which; } switch (e.keyCode) { case goog.events.KeyCodes.ENTER: this.document_.newLine(); isStopPropagation = true; break; case goog.events.KeyCodes.BACKSPACE: isStopPropagation = true; this.document_.deleteSelection(true); break; case goog.events.KeyCodes.DELETE: isStopPropagation = true; this.document_.deleteSelection(); break; case goog.events.KeyCodes.LEFT: this.selection_.moveCaretLeft(); isStopPropagation = true; break; case goog.events.KeyCodes.RIGHT: this.selection_.moveCaretRight(); isStopPropagation = true; break; case goog.events.KeyCodes.HOME: this.selection_.moveCaretLineStart(); isStopPropagation = true; break; case goog.events.KeyCodes.END: this.selection_.moveCaretLineEnd(); isStopPropagation = true; break; case goog.events.KeyCodes.UP: this.selection_.moveCaretUp(); isStopPropagation = true; break; case goog.events.KeyCodes.DOWN: this.selection_.moveCaretDown(); isStopPropagation = true; break; case goog.events.KeyCodes.TAB: this.document_.addValue(document.createTextNode('\\u0009')); isStopPropagation = true; break; case goog.events.KeyCodes.F1: case goog.events.KeyCodes.F2: case goog.events.KeyCodes.F3: case goog.events.KeyCodes.F4: case goog.events.KeyCodes.F5: case goog.events.KeyCodes.F6: case goog.events.KeyCodes.F7: case goog.events.KeyCodes.F8: case goog.events.KeyCodes.F9: case goog.events.KeyCodes.F10: case goog.events.KeyCodes.F11: case goog.events.KeyCodes.F12: break; default: if (e.charCode &gt; 0 &amp;&amp; !e.ctrlKey &amp;&amp; !e.metaKey) { switch (e.charCode) { default: this.document_.addValue(String.fromCharCode(e.charCode)); isStopPropagation = true; } } } if (isStopPropagation) { e.stopPropagation(); e.preventDefault(); } // Editor is focused? let element = this.getElement(); if (document.activeElement != element) { element.focus(); } return isStopPropagation; }; /** * Handles keyboard shortcuts on the editor. * @param {goog.ui.KeyboardShortcutEvent} e * @private */ pwk.Editor.prototype.handleKeyboardShortcut_ = function(e) { // NOTE: Process shortcuts here. For details see // {goog.ui.KeyboardShortcutHandler} // NOTE: Keep in mind about Mac and Win keyboard switch (e.identifier) { case pwk.Shortcuts.Default.SAVE[0]: console.info('Save document...'); this.addTestText(); break; case pwk.Shortcuts.Default.SELECT_ALL[0]: this.document_.getSelection().selectDocument(); e.preventDefault(); e.stopPropagation(); break; } }; /** * Register handled shortcut. * * @param {goog.ui.KeyboardShortcutHandler} handler * @private */ pwk.Editor.prototype.registerKeyboardShortcut_ = function(handler) { for (let shortcut in pwk.Shortcuts.Default) { handler.registerShortcut(pwk.Shortcuts.Default[shortcut][0], goog.array.slice(pwk.Shortcuts.Default[shortcut], 1)); } }; /** * Keep in mind that this case is implemented for test purpose only and does not * work properly with Range / Selection. * @param {boolean=} opt_init */ pwk.Editor.prototype.addTestText = function(opt_init) { let generator = new goog.text.LoremIpsum(); let paragraph; let line; let node; //console.profile('Normalization performance'); for (let i = 0; i &lt; 10; i++) { paragraph = generator.generateParagraph(false); if (i == 0 &amp;&amp; opt_init) { line = (/** @type {pwk.LeafNode} */(this.document_.getNodeAt(0))) .getFirstLine(); line.insertText(paragraph); } else { line = new pwk.Line(paragraph); node = new pwk.LeafNode(pwk.NodeTypes.PARAGRAPH, this.document_, line); this.document_.addNode(node); } } //console.profileEnd(); }; /** * Component default css class. * @type {string} */ pwk.Editor.CSS_CLASS = 'pwk-editor'; /** * iFrame text event target CSS class. * @type {string} */ pwk.Editor.CSS_TEXT_EVENT_TARGET = 'pwk-editor-textevettarget-iframe'; × Search results Close "},"pwk_editor_layer_editorcontainer.js.html":{"id":"pwk_editor_layer_editorcontainer.js.html","title":"Source: pwk/editor/layer/editorcontainer.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/layer/editorcontainer.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Editor components container * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.EditorContainer'); goog.require('goog.dom'); goog.require('goog.dom.classlist'); goog.require('goog.ui.Component'); /** * @constructor * @extends {goog.ui.Component} */ pwk.EditorContainer = function() { goog.base(this); }; goog.inherits(pwk.EditorContainer, goog.ui.Component); /** @inheritDoc */ pwk.EditorContainer.prototype.createDom = function() { // Create element and apply classes this.setElementInternal(this.dom_.createElement('div')); goog.dom.classlist.add(this.getElement(), pwk.EditorContainer.CSS_CLASS); }; /** @inheritDoc */ pwk.EditorContainer.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); // Initialize events goog.events.listen(window, goog.events.EventType.RESIZE, this.onWindowResize_, false, this); this.onWindowResize_(); }; /** * On window resize event handler * @private */ pwk.EditorContainer.prototype.onWindowResize_ = function() { goog.style.setHeight(this.getElement(), goog.dom.getViewportSize().height); }; /** * Component default css class * @type {string} */ pwk.EditorContainer.CSS_CLASS = 'pwk-editor-container'; × Search results Close "},"pwk_editor_layer_caret.js.html":{"id":"pwk_editor_layer_caret.js.html","title":"Source: pwk/editor/layer/caret.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/layer/caret.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Component that represent caret in document * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.layer.Caret'); goog.provide('pwk.layer.Caret.AfterUpdateEvent'); goog.require('goog.dom.Range'); goog.require('goog.dom.classlist'); goog.require('goog.editor.range'); goog.require('goog.events.Event'); goog.require('goog.style'); goog.require('goog.ui.Component'); goog.require('pwk.utils.dom'); /** * Initialize {pwk.layer.Caret} component. * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for * document interaction. * @constructor * @extends {goog.ui.Component} */ pwk.layer.Caret = function(opt_domHelper) { goog.base(this, opt_domHelper); /** * Is cursor visible. * * @type {boolean} * @private */ this.isVisible_ = false; /** * Parent caret wrapper. * * @type {Node} * @private */ this.layer_; /** * @type {number} * @private */ this.blinkId_; /** * @type {Element} * @private */ this.documentElement_; /** * A zero width space character. * @type {string} * @private */ this.ZERO_WIDTH_SPACE_ = '\\ufeff'; this.count_ = 0; }; goog.inherits(pwk.layer.Caret, goog.ui.Component); /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.layer.Caret.CSS_CLASS = 'pwk-caret'; /** * CSS class of parent caret wrapper element. * * @type {string} */ pwk.layer.Caret.CSS_CLASS_LAYER = 'pwk-caret-layer'; /** @inheritDoc */ pwk.layer.Caret.prototype.createDom = function() { var element = goog.dom.createDom('div'); this.documentElement_ = goog.dom.getElementByClass(pwk.Document.CSS_CLASS); goog.style.setUnselectable(element, true); this.setElementInternal(element); this.decorateInternal(element); }; /** @inheritDoc */ pwk.layer.Caret.prototype.decorateInternal = function(element) { goog.base(this, 'decorateInternal', element); // Add css class goog.dom.classlist.add(element, pwk.layer.Caret.CSS_CLASS); // Initialize wrapper this.layer_ = goog.dom.createDom('div'); goog.dom.classlist.add(this.layer_, pwk.layer.Caret.CSS_CLASS_LAYER); }; /** @inheritDoc */ pwk.layer.Caret.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); // Wrap by layer var parent = /** @type {!Node} */(goog.dom.getParentElement(this.getElement())); goog.dom.append(parent, this.layer_); this.layer_.appendChild(this.getElement()); // Initialize events this.listen(pwk.layer.Caret.EventType.BEFORE_UPDATE, this.onCaretBeforeUpdate_, false, this); this.listen(pwk.layer.Caret.EventType.AFTER_UPDATE, this.onCaretAfterUpdate_, false, this); }; /** @inheritDoc */ pwk.layer.Caret.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Stop timer clearInterval(this.blinkId_); // Remove DOM nodes if (this.layer_) { goog.dom.removeNode(this.layer_); } delete this.layer_; // Remove references to DOM nodes, this.documentElement_ = null; //NOTE: Event listeners are cleaned in the method exitDocument of base class }; /** * Hide cursor. */ pwk.layer.Caret.prototype.hide = function() { var el = this.getElement(); clearInterval(this.blinkId_); this.isVisible_ = false; el.style.visibility = 'hidden'; }; /** * Show cursor. */ pwk.layer.Caret.prototype.show = function() { var el = this.getElement(); this.isVisible_ = true; el.style.visibility = 'visible'; this.restartTimer(); }; /** * Restart blink */ pwk.layer.Caret.prototype.restartTimer = function() { clearInterval(this.blinkId_); if (!this.isVisible_) { return; } var self = this.getElement(), obj = this; this.blinkId_ = setInterval(function() { self.style.visibility = 'hidden'; setTimeout(function() { if (obj.isVisible_) { self.style.visibility = 'visible'; } }, 400); }, 1000); }; /** * Update cursor position by range * * @param {pwk.Selection} selection * @return {goog.math.Rect} */ pwk.layer.Caret.prototype.update = function(selection) { this.dispatchEvent(pwk.layer.Caret.EventType.BEFORE_UPDATE); var el = this.getElement(), bounds = selection.getBoundsForRange(), elStyle = el.style; elStyle.left = bounds.left + 'px'; elStyle.top = bounds.top + 'px'; elStyle.height = bounds.height + 'px'; this.restartTimer(); this.dispatchEvent(new pwk.layer.Caret.AfterUpdateEvent(this, bounds)); return bounds; }; /** * @param {goog.events.Event} e * @private */ pwk.layer.Caret.prototype.onCaretBeforeUpdate_ = function(e) { }; /** * @param {pwk.layer.Caret.AfterUpdateEvent} e * @private */ pwk.layer.Caret.prototype.onCaretAfterUpdate_ = function(e) { }; /** * @enum {string} */ pwk.layer.Caret.EventType = { BEFORE_UPDATE: goog.events.getUniqueId('before_update'), AFTER_UPDATE: goog.events.getUniqueId('after_update') }; /** * @param {pwk.layer.Caret} caret * @param {goog.math.Rect} bounds * @constructor * @extends {goog.events.Event} */ pwk.layer.Caret.AfterUpdateEvent = function(caret, bounds) { goog.events.Event.call(this, pwk.layer.Caret.EventType.AFTER_UPDATE, caret); /** * @type {goog.math.Rect} * @private */ this.bounds_ = bounds; }; goog.inherits(pwk.layer.Caret.AfterUpdateEvent, goog.events.Event); /** * @return {goog.math.Rect} */ pwk.layer.Caret.AfterUpdateEvent.prototype.getBounds = function() { return this.bounds_; }; × Search results Close "},"pwk_editor_layer_selectionoverlay.js.html":{"id":"pwk_editor_layer_selectionoverlay.js.html","title":"Source: pwk/editor/layer/selectionoverlay.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/layer/selectionoverlay.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Selection overview UI component. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.layer.SelectionOverlay'); goog.require('goog.dom.classlist'); goog.require('goog.events.Event'); goog.require('goog.ui.Component'); goog.require('pwk.primitives.ClientRectRange'); /** * @param {pwk.primitives.ClientRectRange} clientRectRange * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for * document interaction. * @constructor * @extends {goog.ui.Component} */ pwk.layer.SelectionOverlay = function(clientRectRange, opt_domHelper) { goog.base(this, opt_domHelper); /** * @type {pwk.primitives.ClientRectRange} * @private */ this.clientRectRange_ = clientRectRange; }; goog.inherits(pwk.layer.SelectionOverlay, goog.ui.Component); /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.layer.SelectionOverlay.CSS_CLASS = 'pwk-selection-overlay'; /** @inheritDoc */ pwk.layer.SelectionOverlay.prototype.createDom = function() { let element = goog.dom.createDom('div'); let clientRect = this.clientRectRange_; let googStyle = goog.style; let googMath = goog.math; this.setElementInternal(element); goog.dom.classlist.add(this.getElement(), pwk.layer.SelectionOverlay.CSS_CLASS); googStyle.setPosition(element, new googMath.Coordinate(clientRect.left, clientRect.top)); googStyle.setSize(element, new googMath.Size(clientRect.width, clientRect.height)); }; × Search results Close "},"pwk_editor_nodes_leafnode.js.html":{"id":"pwk_editor_nodes_leafnode.js.html","title":"Source: pwk/editor/nodes/leafnode.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/leafnode.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview TODO: add description * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.LeafNode'); goog.provide('pwk.LeafNode.NodeContentChangedEvent'); goog.require('goog.dom.Range'); goog.require('goog.dom.classlist'); goog.require('pwk.Line'); goog.require('pwk.Node'); goog.require('pwk.NodeAttribute'); goog.require('pwk.NodeAttributeTypes'); goog.require('pwk.NodeFormatter'); goog.require('pwk.LineOffsetInfo'); goog.require('pwk.primitives.NodeSelectionRange'); /** * @param {pwk.NodeTypes} type Type of node. * @param {pwk.Document} doc Parent document object. * @param {string|pwk.Line=} opt_content Content text or line. * @constructor * @extends {pwk.Node} */ pwk.LeafNode = function(type, doc, opt_content) { goog.base(this, type, doc); /** * @type {Array.&lt;pwk.Line&gt;} * @private */ this.lines_ = goog.isString(opt_content) || !goog.isDefAndNotNull(opt_content) ? [new pwk.Line(opt_content || '')] : [opt_content]; /** * @type {Array} * @private */ this.rangeOffsetInfoCache_ = []; /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); /** * @type {pwk.LeafNode} * @private */ this.previousLinkedNode_; /** * @type {pwk.LeafNode} * @private */ this.nextLinkedNode_; /** * @type {?pwk.primitives.NodeSelectionRange} * @private */ this.nodeSelectionRange_; /** * @type {boolean} * @private */ this.isSelected_ = false; }; goog.inherits(pwk.LeafNode, pwk.Node); /** @inheritDoc */ pwk.LeafNode.prototype.createDom = function() { this.setElementInternal(this.dom_.createElement('div')); var element = this.getElement(); // adjust dom element element.setAttribute('id', this.getId()); goog.dom.classlist.add(element, this.CSS_CLASS); var lines = this.lines_, linesLength = lines.length, loopLine; while (linesLength--) { loopLine = lines[linesLength]; this.addChildAt(loopLine, 0, true); // apply node attributes pwk.NodeFormatter.applyNodeAttributes(this.getAttributes(), loopLine); } }; /** @inheritDoc */ pwk.LeafNode.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); // Initialize events this.listen(pwk.Node.EventType.ATTRIBUTES_CHANGED, this.renderNode_, false, this); this.listen(pwk.LeafNode.EventType.CONTENT_CHANGED, this.onLineContentChangedHandler_, false, this); if (this.getAttributes().length &gt; 0) { this.dispatchEvent(pwk.Node.EventType.ATTRIBUTES_CHANGED); } if (this.getLength() &gt; 0) { this.dispatchEvent(new pwk.LeafNode.NodeContentChangedEvent( this.getFirstLine())); } }; /** * @inheritDoc */ pwk.LeafNode.prototype.getPreviousLinkedNode = function() { return this.previousLinkedNode_; }; /** * @inheritDoc * @return {?pwk.LeafNode} */ pwk.LeafNode.prototype.getNextLinkedNode = function() { return this.nextLinkedNode_; }; /** * Is current node a topmost of all linked nodes? * @return {boolean} */ pwk.LeafNode.prototype.isRootLinkedNode = function() { return !goog.isDefAndNotNull(this.previousLinkedNode_); }; /** @inheritDoc */ pwk.LeafNode.prototype.setPreviousLinkedNode = function(node) { this.previousLinkedNode_ = /** @type {pwk.LeafNode} */(node); if (node.getNextLinkedNode() != this) { node.setNextLinkedNode(this); } }; /** @inheritDoc */ pwk.LeafNode.prototype.setNextLinkedNode = function(node) { this.nextLinkedNode_ = /** @type {pwk.LeafNode} */(node); if (node.getPreviousLinkedNode() != this) { node.setPreviousLinkedNode(this); } }; /** * Unlink topmost linked node */ pwk.LeafNode.prototype.unlinkPreviousLinkedNode = function() { var previousLinkedNode = this.previousLinkedNode_; this.previousLinkedNode_ = null; if (previousLinkedNode != null &amp;&amp; previousLinkedNode.getNextLinkedNode() != null) { previousLinkedNode.unlinkNextLinkedNode(); } this.clearRangeInfoForOffsetCache(); }; /** * Unlink linked node below */ pwk.LeafNode.prototype.unlinkNextLinkedNode = function() { var nextLinkedNode = this.nextLinkedNode_; this.nextLinkedNode_ = null; if (nextLinkedNode != null &amp;&amp; nextLinkedNode.getPreviousLinkedNode() != null) { nextLinkedNode.unlinkPreviousLinkedNode(); } this.clearRangeInfoForOffsetCache(); }; /** * @param {pwk.Line} line Line object to insert. * @param {boolean} render Is required render lines? * @param {number=} opt_i The index at which to insert the object. */ pwk.LeafNode.prototype.insertLine = function(line, render, opt_i) { var i = goog.isDefAndNotNull(opt_i) ? opt_i : this.lines_.length; goog.array.insertAt(this.lines_, line, i); if (render) { this.addChildAt(line, i, true); pwk.NodeFormatter.applyNodeAttributes(this.getAttributes(), line); } }; /** * * * @param {Array.&lt;pwk.Line&gt;} lines Lines to insert. * @param {boolean} render Is required render lines? * @param {number=} opt_i The index at which to insert the object. */ pwk.LeafNode.prototype.insertLines = function(lines, render, opt_i) { goog.array.forEach(lines, function(line, index) { this.insertLine(line, render, goog.isDefAndNotNull(opt_i) ? opt_i + index : undefined); }, this); }; /** @inheritDoc */ pwk.LeafNode.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); var lines = this.lines_, linesLen = lines.length; // Dispose of all Disposable objects owned by this class. while (linesLen--) { goog.dispose(lines[linesLen]); } this.clearRangeInfoForOffsetCache(); // Unlink previous and next linked nodes this.unlinkPreviousLinkedNode(); this.unlinkNextLinkedNode(); // Remove references delete this.lines_; this.document_ = null; }; /** * Get concatenated lines of all linked nodes * @return {Array.&lt;pwk.Line&gt;} * @private */ pwk.LeafNode.prototype.getLinesOfAllLinkedNodes_ = function() { var lines = [], previousLinkedNode = this.previousLinkedNode_, nextLinkedNode = this.nextLinkedNode_; while (goog.isDefAndNotNull(previousLinkedNode)) { lines = goog.array.concat(previousLinkedNode.getLines(), lines); previousLinkedNode = previousLinkedNode.getPreviousLinkedNode(); } lines = goog.array.concat(lines, this.getLines()); while (goog.isDefAndNotNull(nextLinkedNode)) { lines = goog.array.concat(lines, nextLinkedNode.getLines()); nextLinkedNode = nextLinkedNode.getNextLinkedNode(); } return lines; }; /** * Get line range information for specific offset at the node. * @param {number} nodeOffset Text range offset (summary for all lines) * @return {?pwk.LineOffsetInfo} */ pwk.LeafNode.prototype.getRangeInfoForOffset = function(nodeOffset) { // Looking into cache let cacheData = this.rangeOffsetInfoCache_[nodeOffset]; if (goog.isDefAndNotNull(cacheData)) { return cacheData; } let lines = this.lines_; let lineLength; let line; let rangeInfo = new pwk.LineOffsetInfo(); if (nodeOffset == 0) { line = lines[0]; rangeInfo.setLine(line); rangeInfo.setLineIndex(0); rangeInfo.setLineOffset(0); rangeInfo.setNodeOffset(0); rangeInfo.setLineLength(line.getLength()); rangeInfo.setLinkedNodeOffset(this.getOffsetForLinkedNodes_(line, 0)); this.rangeOffsetInfoCache_[0] = rangeInfo; return rangeInfo; } let lengthSummary = 0; let linesCount = lines.length; for (var i = 0; i &lt; linesCount; i++) { line = lines[i]; lineLength = line.getLength(); lengthSummary += lineLength; if (lengthSummary &gt;= nodeOffset) { let lineOffset = lineLength - (lengthSummary - nodeOffset); rangeInfo.setLine(line); rangeInfo.setLineIndex(i); rangeInfo.setLineOffset(lineOffset); rangeInfo.setNodeOffset(nodeOffset); rangeInfo.setLineLength(lineLength); rangeInfo.setLinkedNodeOffset( this.getOffsetForLinkedNodes_(line, lineOffset)); this.rangeOffsetInfoCache_[nodeOffset] = rangeInfo; return rangeInfo; } } return null; }; /** * Get line range information for specific offset based on all linked nodes. * @param {number} nodeOffset Text range offset (summary for all lines) * @return {?pwk.LineOffsetInfo} */ pwk.LeafNode.prototype.getRangeInfoByLinkedNodesOffset = function(nodeOffset) { let lines = this.getLinesOfAllLinkedNodes_(); let lineLength; let line; let rangeInfo = new pwk.LineOffsetInfo(); if (nodeOffset == 0) { line = lines[0]; rangeInfo.setLine(line); rangeInfo.setLineIndex(0); rangeInfo.setLineOffset(0); rangeInfo.setNodeOffset(0); rangeInfo.setLineLength(line.getLength()); rangeInfo.setLinkedNodeOffset(nodeOffset); return rangeInfo; } let lengthSummary = 0; let linesCount = lines.length; for (var i = 0; i &lt; linesCount; i++) { line = lines[i]; lineLength = line.getLength(); lengthSummary += lineLength; if (lengthSummary &gt;= nodeOffset) { let lineOffset = lineLength - (lengthSummary - nodeOffset); rangeInfo.setLine(line); rangeInfo.setLineIndex(i); rangeInfo.setLineOffset(lineOffset); rangeInfo.setNodeOffset( line.getParentNode().getOffsetByLineOffset(line, lineOffset)); rangeInfo.setLineLength(lineLength); rangeInfo.setLinkedNodeOffset(nodeOffset); return rangeInfo; } } return null; }; /** * Get node offset regarding specified line offset. * @param {pwk.Line} line * @param {number} lineOffset * @return {number} */ pwk.LeafNode.prototype.getOffsetByLineOffset = function(line, lineOffset) { var lines = this.lines_, index = this.indexOfLine(line), linesCount = lines.length, lengthSummary = 0, i = 0, loopLine; while (i &lt; linesCount) { loopLine = lines[i]; if (i == index) { lengthSummary += lineOffset; break; } else { lengthSummary += loopLine.getLength(); } i++; } return lengthSummary; }; /** * Get offset of linked nodes for line offset. * @param line * @param lineOffset * @return {number} * @private */ pwk.LeafNode.prototype.getOffsetForLinkedNodes_ = function(line, lineOffset) { var lines = this.getLinesOfAllLinkedNodes_(), index = goog.array.indexOf(lines, line), linesCount = lines.length, lengthSummary = 0, i = 0, loopLine; while (i &lt; linesCount) { loopLine = lines[i]; if (i == index) { lengthSummary += lineOffset; break; } else { lengthSummary += loopLine.getLength(); } i++; } return lengthSummary; }; /** * @inheritDoc */ pwk.LeafNode.prototype.getLength = function() { var length = 0, lines = this.lines_, lineLength = lines.length; while (lineLength--) { length += lines[lineLength].getLength(); } return length; }; /** * Get concatenated lines text * @return {string} */ pwk.LeafNode.prototype.getText = function() { var text = '', lines = this.lines_, lineLength = lines.length; while (lineLength--) { text = lines[lineLength].getText() + text; } return text; }; /** * @inheritDoc */ pwk.LeafNode.prototype.getFirstLine = function() { // TODO: Move to the pwk.Node as abstract return this.lines_[0]; }; /** * @inheritDoc */ pwk.LeafNode.prototype.getLastLine = function() { return this.lines_[this.lines_.length - 1]; }; /** * Returns the line at the given index, or null if the index is out of bounds. * @param {number} index 0-based index. * @param {boolean=} opt_isIncludeLinesFromLinkedNodes * @return {?pwk.Line} */ pwk.LeafNode.prototype.getLineAt = function(index, opt_isIncludeLinesFromLinkedNodes) { if (opt_isIncludeLinesFromLinkedNodes) { return this.getLinesOfAllLinkedNodes_()[index] || null; } else { return this.lines_[index] || null; } }; /** * Returns array of lines of current node. * @return {Array.&lt;pwk.Line&gt;} */ pwk.LeafNode.prototype.getLines = function() { return this.lines_; }; /** * Get lines count. * @return {number} */ pwk.LeafNode.prototype.getLinesCount = function() { return this.lines_.length; }; /** * Removes the given line from this node, returns and disposes of it. Throws an * error if the argument is invalid or if the specified line isn't found in the * node. * @param {pwk.Line} line * @return {pwk.Line} */ pwk.LeafNode.prototype.removeLine = function(line) { goog.array.remove(this.lines_, line); var removedLine = /** @type {pwk.Line} */(this.removeChild(line, true)); if (removedLine) { goog.dispose(removedLine); // Clear cache for offsets range information this.clearRangeInfoForOffsetCache(); } return removedLine; }; /** * Do the same as {@code pwk.LeafNode.prototype.removeLine}, but without object * disposing. * @param {pwk.Line} line * @return {pwk.Line} */ pwk.LeafNode.prototype.unlinkLine = function(line) { goog.array.remove(this.lines_, line); return /** @type {pwk.Line} */(this.removeChild(line, true)); }; /** * Returns the 0-based index of the given line component, or -1 if no such * node is found. * @param {pwk.Line?} line The line component. * @return {number} 0-based index of the line component; -1 if not found. */ pwk.LeafNode.prototype.indexOfLine = function(line) { return (this.lines_ &amp;&amp; line) ? goog.array.indexOf(this.lines_, line) : -1; }; /** * Insert value to the end of node or to the specific position, based on * provided offset. * @param {string} value * @param {number=} opt_offset Offset inside node, whole all lines */ pwk.LeafNode.prototype.insertValue = function(value, opt_offset) { var rangeInfo = this.getRangeInfoForOffset(opt_offset || 0); rangeInfo.getLine().insertValue(value, opt_offset); }; /** * Insert text to the end of node or to the specific position, based on provided * offset. * @param {string} text * @param {number=} opt_offset Offset inside node, whole all lines */ pwk.LeafNode.prototype.insertText = function(text, opt_offset) { var rangeInfo = this.getRangeInfoForOffset(opt_offset || 0); rangeInfo.getLine().insertText(text, opt_offset); }; /** * @private */ pwk.LeafNode.prototype.renderNode_ = function() { goog.array.forEach(this.lines_, function(line) { pwk.NodeFormatter.applyNodeAttributes(this.getAttributes(), line); }, this); }; /** * @inheritDoc */ pwk.LeafNode.prototype.isSplittable = function() { return true; }; /** * @param {number} offset Node offset, 0-based index. * @return {pwk.LeafNode} Returns new node or next linked node, in case if * offset is end of the current node and next exist linked node. */ pwk.LeafNode.prototype.split = function(offset) { var rangeInfo = this.getRangeInfoForOffset(offset), parentNodeLength = rangeInfo.getLine().getParentNode().getLength(); // If this is end of the node and exist linked node, // then just unlink next linked node and return it if (offset == parentNodeLength &amp;&amp; goog.isDefAndNotNull(this.nextLinkedNode_)) { var linkedNode = this.nextLinkedNode_; this.nextLinkedNode_ = null; return linkedNode; } else { var lines = this.lines_, linesLen = lines.length, content = rangeInfo.getLine().cut(rangeInfo.getLineOffset()), startLineIndexToMove = rangeInfo.getLineIndex() + 1, linesCountToMove = linesLen - startLineIndexToMove, newNode; if (content.length &gt; 0 || linesCountToMove == 0) { newNode = new pwk.LeafNode(this.getType(), this.document_, content); } else { newNode = new pwk.LeafNode(this.getType(), this.document_, this.unlinkLine(lines[startLineIndexToMove])); linesCountToMove--; } // If node have the next linked node, assign it to the new node. if (offset &gt; 0 &amp;&amp; goog.isDefAndNotNull(this.nextLinkedNode_)) { newNode.setNextLinkedNode(this.nextLinkedNode_); this.nextLinkedNode_ = null; } while (linesCountToMove--) { newNode.insertLine(this.unlinkLine(lines[startLineIndexToMove]), false); } return newNode; } }; /** * Clear cache for offsets range information. * @param {pwk.LeafNode=} opt_callerNode * @public */ pwk.LeafNode.prototype.clearRangeInfoForOffsetCache = function(opt_callerNode) { goog.array.clear(this.rangeOffsetInfoCache_); var prevLinkedNode = this.previousLinkedNode_, nextLinkedNode = this.nextLinkedNode_; // Clearing for linked nodes if (prevLinkedNode != null) { if (opt_callerNode == null || opt_callerNode.getId() != prevLinkedNode.getId()) { prevLinkedNode.clearRangeInfoForOffsetCache(this); } } if (nextLinkedNode != null) { if (opt_callerNode == null || opt_callerNode.getId() != nextLinkedNode.getId()) { nextLinkedNode.clearRangeInfoForOffsetCache(this); } } }; /** * @param {pwk.LeafNode.NodeContentChangedEvent} e * @private */ pwk.LeafNode.prototype.onLineContentChangedHandler_ = function(e) { // Clear cache for offsets range information this.clearRangeInfoForOffsetCache(); // Normalize node contents in lines this.normalizeLines(e.lastUpdatedLine); }; /** * Normalization of the contents on the lines. * @param {pwk.Line} lastUpdatedLine */ pwk.LeafNode.prototype.normalizeLines = function(lastUpdatedLine) { // TODO: Try to improve performance in this place if it's possible. var pagination = this.document_.getPagination(), prevLinkedNode = this.previousLinkedNode_, nextLinkedNode = this.nextLinkedNode_, doc = this.document_, currentNodePageId = pagination.getPageIndexByNodeId(this.getId()), length; // Check if some of linked node situated on the same page and merge it. if (prevLinkedNode != null &amp;&amp; currentNodePageId == pagination.getPageIndexByNodeId(prevLinkedNode.getId())) { length = prevLinkedNode.getLinesCount(); while (length--) { this.insertLine(prevLinkedNode.unlinkLine(prevLinkedNode.getLineAt(length)), true, 0); } doc.removeNode(prevLinkedNode); this.previousLinkedNode_ = null; } if (nextLinkedNode != null &amp;&amp; currentNodePageId == pagination.getPageIndexByNodeId(nextLinkedNode.getId())) { length = nextLinkedNode.getLinesCount(); while (length--) { this.insertLine(nextLinkedNode.unlinkLine(nextLinkedNode.getLineAt(0)), true); } doc.removeNode(nextLinkedNode); this.nextLinkedNode_ = null; } // Checking the width of node content and splitting it if it wider than page content or parent node if it's child node. var parentContentWidth = this.isChild() ? this.getParent().getSize().width : this.pageSettings_.getInnerWidth(); // Move text from the line below, if it's possible lastUpdatedLine = this.normalizeBackward_(lastUpdatedLine, parentContentWidth); if (lastUpdatedLine != null) { // Move text to the line below, if it's required this.normalizeForward_(lastUpdatedLine, parentContentWidth); } }; /** * @param {pwk.Line} lastUpdatedLine * @param {number} parentContentWidth * @return {pwk.Line} * @private */ pwk.LeafNode.prototype.normalizeBackward_ = function(lastUpdatedLine, parentContentWidth) { var googArray = goog.array, lines = this.getLinesOfAllLinkedNodes_(), lastUpdateLineIndex = googArray.indexOf(lines, lastUpdatedLine), lineAbove = lines[lastUpdateLineIndex - 1]; if (goog.isDefAndNotNull(lineAbove)) { // Is first line? var googString = goog.string, lineAboveContent = lineAbove.getContent(), lastUpdatedLineContent = lastUpdatedLine.getContent(), loopsCount = 0, isSpace = false, lineBelowLength, contentToMoveInfo, calculatedAboveWidth, lastWord; do { if (contentToMoveInfo != null) { // Skip this case for first time lineAboveContent.insertText(contentToMoveInfo.text, lineAboveContent.getLength()); if (!isSpace) { lastUpdatedLineContent.removeAt(0, 1); } else { lastUpdatedLineContent.removeFirstWord(); } lineBelowLength = lastUpdatedLineContent.getLength(); if (lineBelowLength == 0) { lastUpdatedLine.getParentNode().removeLine(lastUpdatedLine); lastUpdatedLine = lines[lastUpdateLineIndex + 1]; if (goog.isDefAndNotNull(lastUpdatedLine)) { lastUpdatedLineContent = lastUpdatedLine.getContent(); } else { // No line below? Exit... return null; } } } lastWord = lineAboveContent.getTextNodeValueAtOffset(lineAboveContent.getLength() - 1); isSpace = googString.isSpace(googString.normalizeWhitespace(lastWord)); // Check, if line above did not contains spaces contentToMoveInfo = !isSpace ? lastUpdatedLineContent.getContentInfoForOffset(0, 1) : lastUpdatedLineContent.getFirstWordInfo(); calculatedAboveWidth = lineAbove.getWidth(false) + contentToMoveInfo.width; loopsCount++; } while (calculatedAboveWidth &lt; parentContentWidth); if (loopsCount &gt; 1) { lastUpdateLineIndex = googArray.indexOf(lines, lastUpdatedLine); var lineBelow = lines[lastUpdateLineIndex + 1]; if (lineBelow != null) { return this.normalizeBackward_(lineBelow, parentContentWidth); } } } return lastUpdatedLine; }; /** * @param {pwk.Line} lastUpdatedLine * @param {number} parentContentWidth * @private */ pwk.LeafNode.prototype.normalizeForward_ = function(lastUpdatedLine, parentContentWidth) { var lineContentWidth = lastUpdatedLine.getWidth(true), lastUpdatedLineBelow; if (lineContentWidth &gt; parentContentWidth) { var googString = goog.string, googArray = goog.array, lines = this.getLinesOfAllLinkedNodes_(), lastUpdateLineIndex = googArray.indexOf(lines, lastUpdatedLine), lastUpdatedLineContent = lastUpdatedLine.getContent(), isLastLine = !goog.isDefAndNotNull(lines[lastUpdateLineIndex + 1]), lastUpdatedLineContentLength = lastUpdatedLineContent.getLength(), firstSpaceIndex = googString.trimRight(googString.normalizeWhitespace(lastUpdatedLineContent.getText())).indexOf(' '), lastUpdatedContentText = '', contentToMove = '', lastUpdatedModifiedLineContentLength = 0, lastSpaceIndex, lineParentNode; if (firstSpaceIndex != -1 &amp;&amp; (lineContentWidth &gt;= parentContentWidth * 2)) { var prevContentToMove, prevLastUpdatedModifiedLineContentLength; do { prevContentToMove = contentToMove; prevLastUpdatedModifiedLineContentLength = lastUpdatedModifiedLineContentLength; contentToMove = lastUpdatedLineContent.copy(lastUpdatedContentText.length + firstSpaceIndex + 1); lastUpdatedContentText = lastUpdatedLineContent.copy(0, lastUpdatedLineContentLength - contentToMove.length); lastUpdatedModifiedLineContentLength = lastUpdatedContentText.length; lineContentWidth = lastUpdatedLineContent.getContentInfoForOffset(0, lastUpdatedModifiedLineContentLength).width; firstSpaceIndex = googString.trimRight(googString.normalizeWhitespace(contentToMove)).indexOf(' '); } while (lineContentWidth &lt; parentContentWidth &amp;&amp; firstSpaceIndex != -1); contentToMove = prevContentToMove; lastUpdatedModifiedLineContentLength = prevLastUpdatedModifiedLineContentLength; } else { var tempWord; lastUpdatedContentText = lastUpdatedLineContent.getText(); lastUpdatedModifiedLineContentLength = lastUpdatedContentText.length; do { lastSpaceIndex = googString.trimRight(googString.normalizeWhitespace(lastUpdatedContentText)).lastIndexOf(' '); // If remains big text only, then move last character only if (lastSpaceIndex != -1) { contentToMove = lastUpdatedLineContent.copy(lastSpaceIndex + 1, lastUpdatedModifiedLineContentLength) + contentToMove; lastUpdatedContentText = lastUpdatedLineContent.copy(0, lastUpdatedLineContentLength - contentToMove.length); lastUpdatedModifiedLineContentLength = lastUpdatedContentText.length; } else { do { tempWord = googString.normalizeWhitespace(lastUpdatedLineContent.getTextNodeAtOffset(lastUpdatedModifiedLineContentLength - 1).data); contentToMove = tempWord + contentToMove; lastUpdatedContentText = lastUpdatedLineContent.copy(0, lastUpdatedLineContentLength - contentToMove.length); lastUpdatedModifiedLineContentLength--; } while (googString.isSpace(tempWord)); } lineContentWidth = lastUpdatedLineContent.getContentInfoForOffset(0, lastUpdatedModifiedLineContentLength).width; } while (lineContentWidth &gt; parentContentWidth); } lastUpdatedLineContent.removeAt(lastUpdatedModifiedLineContentLength); if (isLastLine) { lastUpdatedLineBelow = new pwk.Line(contentToMove); lineParentNode = lastUpdatedLine.getParentNode(); googArray.insert(lineParentNode.getLines(), lastUpdatedLineBelow); lineParentNode.addChild(lastUpdatedLineBelow, true); pwk.NodeFormatter.applyNodeAttributes(this.getAttributes(), lastUpdatedLineBelow); // apply node attributes } else { lastUpdatedLineBelow = lines[lastUpdateLineIndex + 1]; lastUpdatedLineBelow.getContent().insertText(contentToMove, 0); } } if (lastUpdatedLineBelow != null) { this.normalizeForward_(lastUpdatedLineBelow, parentContentWidth); } }; /** * Make selection for node content by range * @param {pwk.primitives.NodeSelectionRange=} opt_nodeSelectionRange * @override */ pwk.LeafNode.prototype.select = function(opt_nodeSelectionRange) { // NOTE: Call select method for each line (exclude lines from linked node, add this functionality in future if required) if (this.isSelected_) { if (!goog.isDefAndNotNull(opt_nodeSelectionRange) &amp;&amp; !goog.isDefAndNotNull(this.nodeSelectionRange_)) { // Whole node already selected, exit. return; } if (goog.isDefAndNotNull(opt_nodeSelectionRange) &amp;&amp; goog.isDefAndNotNull(this.nodeSelectionRange_) &amp;&amp; opt_nodeSelectionRange.equals(this.nodeSelectionRange_)) { // The same range already selected, exit. return; } } // Select all node content or only provided range? if (goog.isDefAndNotNull(opt_nodeSelectionRange)) { var lines = this.lines_, linesLength = lines.length, startlineIndex = goog.array.indexOf(lines, opt_nodeSelectionRange.startLine), endLineIndex = goog.array.indexOf(lines, opt_nodeSelectionRange.endLine), isSelectionInsideSingleLine = opt_nodeSelectionRange.startLine == opt_nodeSelectionRange.endLine; for (var i = 0; i &lt; linesLength; i++) { if (i == startlineIndex) { if (isSelectionInsideSingleLine) { lines[i].select(opt_nodeSelectionRange.startLineOffset, opt_nodeSelectionRange.endLineOffset); break; } else { lines[i].select(opt_nodeSelectionRange.startLineOffset); } } else if (i == endLineIndex) { if (!isSelectionInsideSingleLine) { lines[i].select(0, opt_nodeSelectionRange.endLineOffset); } break; } else if (i &gt; startlineIndex) { lines[i].select(); } } } else { // Select all goog.array.forEach(this.lines_, function(line) { line.select(); }); } this.isSelected_ = true; this.nodeSelectionRange_ = opt_nodeSelectionRange || null; }; /** * Remove selection from node */ pwk.LeafNode.prototype.unselect = function() { var lines = this.lines_; goog.array.forEach(lines, function(line) { line.unselect(); }); // Cleanup variables this.isSelected_ = false; this.nodeSelectionRange_ = null; }; /** * @inheritDoc * @param {boolean=} opt_isBack */ pwk.LeafNode.prototype.removeSelection = function(opt_isBack) { // Actions: // - update selection range // - remove // - unselect var nodeSelectionRange = this.nodeSelectionRange_, pwkDocument = /** @type {pwk.Document} */(this.document_), pwkSelection = pwkDocument.getSelection(), selectionRange = pwkSelection.getRange(), isReversed = selectionRange.isReversed(), topSelectionRangeNode = isReversed ? selectionRange.getEndNode() : selectionRange.getStartNode(), bottomSelectionRangeNode = isReversed ? selectionRange.getStartNode() : selectionRange.getEndNode(), isNodeSelectedEntirely = this.isSelectedEntirely_(); if (nodeSelectionRange.isCollapsed() &amp;&amp; goog.isDefAndNotNull(opt_isBack)) { //TODO: Process &quot;Delete&quot; / &quot;Backspace&quot; buttons } else { var isRangeUpdateRequired = true; // Required to mark if range has been updated and no more update required // Update selection range // Move start/end position to the next/previous node // NOTE: Check if it's could be moved to base pwk.Node class // TODO: Refactoring required! if (topSelectionRangeNode === this &amp;&amp; bottomSelectionRangeNode !== this || // Case 1: it's topmost selected node topSelectionRangeNode === this &amp;&amp; bottomSelectionRangeNode === this &amp;&amp; // Case 2: it's single selected node and below exist other node that could be selected isNodeSelectedEntirely &amp;&amp; pwkDocument.indexOfNode(topSelectionRangeNode) &lt; pwkDocument.getNodeCount() - 1) { var bottommostNode = /** @type {pwk.Node} */(pwkDocument.getNodeAt(pwkDocument.indexOfNode(topSelectionRangeNode) + 1)); if (isReversed) { selectionRange.setEndPosition(bottommostNode.getFirstLine(), 0, true); } else { selectionRange.setStartPosition(bottommostNode.getFirstLine(), 0, true); } isRangeUpdateRequired = false; } else if (topSelectionRangeNode !== this &amp;&amp; bottomSelectionRangeNode === this || // Case 1: it's bottommost selected node topSelectionRangeNode === this &amp;&amp; bottomSelectionRangeNode === this &amp;&amp; // Case 2: it's single selected node and above exist other node that could be selected isNodeSelectedEntirely &amp;&amp; pwkDocument.indexOfNode(bottomSelectionRangeNode) &gt; 0) { var topmostNode = /** @type {pwk.Node} */(pwkDocument.getNodeAt(pwkDocument.indexOfNode(bottomSelectionRangeNode) - 1)), lastLine = /** @type {pwk.Line} */(topmostNode.getLastLine()), lastLineOffset = topmostNode.getOffsetByLineOffset(lastLine, lastLine.getLength()); if (isReversed) { selectionRange.setStartPosition(lastLine, lastLineOffset, false); } else { selectionRange.setEndPosition(lastLine, lastLineOffset, false); } isRangeUpdateRequired = false; } // Remove node from document entirely if (isNodeSelectedEntirely) { pwkDocument.removeNode(this); if (topSelectionRangeNode === this &amp;&amp; bottomSelectionRangeNode === this) { isRangeUpdateRequired = true; } else { return; } } else { var startLineIndex = this.indexOfLine(nodeSelectionRange.startLine), endLineIndex = this.indexOfLine(nodeSelectionRange.endLine), loopLine; // Remove selected node content // Cases: // 1. Selection could be on single line only // 2. Selected could be entire line // 3. Cursor could be located on the latest position without selection any word for (var i = startLineIndex; i &lt;= endLineIndex; i++) { loopLine = this.lines_[i]; if (loopLine.isSelectedEntirely()) { // Remove line from node. this.removeLine(loopLine); endLineIndex--; i--; } else { var selectionOffsets = this.lines_[i].removeSelection(); // TODO: Update selection range. Move start/end position to the end position of the selection range of current line if (isRangeUpdateRequired &amp;&amp; selectionOffsets) { var nodeOffset = this.getOffsetByLineOffset(loopLine, selectionOffsets.start); if (isReversed) { selectionRange.setEndPosition(loopLine, nodeOffset, false); } else { selectionRange.setStartPosition(loopLine, nodeOffset, false); } } } } if (startLineIndex + 1 in this.lines_) { this.dispatchEvent(new pwk.LeafNode.NodeContentChangedEvent(this.lines_[startLineIndex + 1])); } } if (isRangeUpdateRequired) { // Update selection by updated range var updateRangeInfo; if (isReversed) { updateRangeInfo = selectionRange.getEndNode().getRangeInfoForOffset(selectionRange.getEndNodeOffset()); selectionRange.setStartPosition(updateRangeInfo.getLine(), selectionRange.getEndNodeOffset()); if (selectionRange.getStartNode() == selectionRange.getEndNode() &amp;&amp; !isNodeSelectedEntirely) { updateRangeInfo = selectionRange.getStartNode().getRangeInfoForOffset(selectionRange.getStartNodeOffset()); selectionRange.setEndPosition(updateRangeInfo.getLine(), selectionRange.getStartNodeOffset()); } } else { updateRangeInfo = selectionRange.getStartNode().getRangeInfoForOffset(selectionRange.getStartNodeOffset()); selectionRange.setEndPosition(updateRangeInfo.getLine(), selectionRange.getStartNodeOffset()); if (selectionRange.getStartNode() == selectionRange.getEndNode() &amp;&amp; !isNodeSelectedEntirely) { updateRangeInfo = selectionRange.getEndNode().getRangeInfoForOffset(selectionRange.getEndNodeOffset()); selectionRange.setStartPosition(updateRangeInfo.getLine(), selectionRange.getEndNodeOffset()); } } } } // Cleanup variables this.isSelected_ = false; this.nodeSelectionRange_ = null; }; /** * Is node selected entirely? * @return {boolean} * @private */ pwk.LeafNode.prototype.isSelectedEntirely_ = function() { if (goog.isDefAndNotNull(this.nodeSelectionRange_)) { return this.indexOfLine(this.nodeSelectionRange_.startLine) === 0 &amp;&amp; this.nodeSelectionRange_.startLineOffset === 0 &amp;&amp; this.indexOfLine(this.nodeSelectionRange_.endLine) == this.lines_.length - 1 &amp;&amp; this.nodeSelectionRange_.endLineOffset === this.nodeSelectionRange_.endLine.getLength(); } return false; }; /** @inheritDoc */ pwk.LeafNode.prototype.addChildAt = function(child, index, opt_render) { goog.base(this, 'addChildAt', child, index, opt_render); this.dispatchEvent(pwk.Document.EventType.FILLING_CHANGE); }; /** * Component default css class. * @type {string} */ pwk.LeafNode.prototype.CSS_CLASS = 'pwk-leafnode'; /** * @enum {string} */ pwk.LeafNode.EventType = { CONTENT_CHANGED: goog.events.getUniqueId('node_content_changed') }; /** * @param {pwk.Line} line * @extends {goog.events.Event} * @constructor */ pwk.LeafNode.NodeContentChangedEvent = function(line) { goog.events.Event.call(this, pwk.LeafNode.EventType.CONTENT_CHANGED, line); /** * @type {pwk.Line} */ this.lastUpdatedLine = line; }; goog.inherits(pwk.LeafNode.NodeContentChangedEvent, goog.events.Event); × Search results Close "},"pwk_editor_nodes_line.js.html":{"id":"pwk_editor_nodes_line.js.html","title":"Source: pwk/editor/nodes/line.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/line.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Represents the line of node content. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Line'); goog.require('goog.dom.classlist'); goog.require('goog.style'); goog.require('goog.ui.Component'); goog.require('pwk.LineContent'); goog.require('pwk.layer.SelectionOverlay'); /** * * @param {string=} opt_text Text content * @extends {goog.ui.Component} * @constructor */ pwk.Line = function(opt_text) { goog.base(this); /** * @type {pwk.LineContent} * @private */ this.content_ = new pwk.LineContent(opt_text); /** * @type {pwk.layer.SelectionOverlay} * @private */ this.selectionOverlay_; /** * @type {?{start:number, end:number}} */ this.selectionOffsets_; }; goog.inherits(pwk.Line, goog.ui.Component); /** @inheritDoc */ pwk.Line.prototype.createDom = function() { var element = goog.dom.createElement('div'); // Create element and apply classes this.setElementInternal(element); element.setAttribute('id', this.getId()); goog.dom.classlist.add(element, pwk.Line.CSS_CLASS); // Add content as child this.addChild(this.content_, true); }; /** @inheritDoc */ pwk.Line.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); goog.dispose(this.content_); goog.dispose(this.selectionOverlay_); delete this.content_; delete this.selectionOverlay_; delete this.selectionOffsets_; }; /** * Get line content * @return {string} */ pwk.Line.prototype.getText = function() { return this.content_.getText(); }; /** * Get line content with normalized whitespaces * @return {string} */ pwk.Line.prototype.getNormalizedText = function() { return this.content_.getNormalizedText(); }; /** * Get content length * @return {number} */ pwk.Line.prototype.getLength = function() { return this.content_.getLength(); }; /** * Get content width * @param {boolean} isOnlyPrintableContent * @return {number} */ pwk.Line.prototype.getWidth = function(isOnlyPrintableContent) { return this.content_.getWidth(isOnlyPrintableContent); }; /** * Get line height * @return {number} */ pwk.Line.prototype.getHeight = function() { return goog.style.getSize(this.getContentElement()).height; }; /** * Get index inside node. * @return {number} */ pwk.Line.prototype.getIndex = function() { return this.getParentNode().indexOfLine(this); }; /** * Removes the last text node from the content and returns its value. * @return {string} The value of the popped text node. */ pwk.Line.prototype.pop = function() { return this.content_.pop(); }; /** * Removes latest text nodes, separated by space/tab, from the content and returns their values. * @return {string} The values of the popped text nodes. */ pwk.Line.prototype.popLastWord = function() { return this.content_.popLastWord(); }; /** * Insert a single value. * @param {string} value Content value, used as single value of TextNode * @param {number=} opt_offset */ pwk.Line.prototype.insertValue = function(value, opt_offset) { this.content_.insertValue(value, opt_offset); this.dispatchEvent(new pwk.LeafNode.NodeContentChangedEvent(this)); }; /** * Set the text * @param {string} text * @param {number=} opt_offset */ pwk.Line.prototype.insertText = function(text, opt_offset) { this.content_.insertText(text, opt_offset); this.dispatchEvent(new pwk.LeafNode.NodeContentChangedEvent(this)); }; /** * @param offset * @return {Node?} */ pwk.Line.prototype.getTextNodeAtOffset = function(offset) { return this.content_.getTextNodeAtOffset(offset); }; /** * @param offset * @return {string} */ pwk.Line.prototype.getTextNodeValueAtOffset = function(offset) { return this.content_.getTextNodeValueAtOffset(offset); }; /** * @return {pwk.LineContent} */ pwk.Line.prototype.getContent = function() { return this.content_; }; /** * @param {number} startOffset * @param {number=} opt_endOffset * @return {string} Сutted text */ pwk.Line.prototype.cut = function(startOffset, opt_endOffset) { return this.content_.cut(startOffset, opt_endOffset); }; /** * Get parent leaf node * @return {pwk.LeafNode} */ pwk.Line.prototype.getParentNode = function() { return /** @type {pwk.LeafNode} */(this.getParent()); }; /** * Make selection for line content by provided offsets. * @param {number=} opt_startOffset * @param {number=} opt_endOffset */ pwk.Line.prototype.select = function(opt_startOffset, opt_endOffset) { // Remove previous selection, if exist if(goog.isDefAndNotNull(this.selectionOverlay_)) { this.removeChild(this.selectionOverlay_, true); goog.dispose(this.selectionOverlay_); } var googStyle = goog.style, el = this.getElement(), elSize = googStyle.getSize(el), elPageOffset = googStyle.getPageOffset(el), clientRectRange; if(this.getLength() == 0) { clientRectRange = new pwk.primitives.ClientRectRange(10, elSize.height, 0, 0); } else { var lineContentClientRect = this.content_.getBoundingClientRectForOffset(opt_startOffset, opt_endOffset); clientRectRange = new pwk.primitives.ClientRectRange(lineContentClientRect.width, elSize.height, 0, lineContentClientRect.left - elPageOffset.x); } this.selectionOffsets_ = { start: goog.isDefAndNotNull(opt_startOffset) ? opt_startOffset : 0, end: goog.isDefAndNotNull(opt_endOffset) ? opt_endOffset : this.getLength() }; this.selectionOverlay_ = new pwk.layer.SelectionOverlay(clientRectRange); this.addChildAt(this.selectionOverlay_, 0, true); }; /** * Remove selection overlay from the line */ pwk.Line.prototype.unselect = function() { if(this.selectionOverlay_) { this.removeChild(this.selectionOverlay_); goog.dispose(this.selectionOverlay_); delete this.selectionOverlay_; this.selectionOffsets_ = null; } }; /** * Is line selected entirely? * @return {boolean} */ pwk.Line.prototype.isSelectedEntirely = function() { if(goog.isDefAndNotNull(this.selectionOffsets_)) { return this.selectionOffsets_.start == 0 &amp;&amp; this.selectionOffsets_.end == this.getLength(); } return false; }; /** * Remove selected content * @return {{start:number, end:number}|Object&lt;string,string&gt;|null} */ pwk.Line.prototype.removeSelection = function() { var result = this.selectionOffsets_ != null ? goog.object.clone(this.selectionOffsets_) : null; if(goog.isDefAndNotNull(this.selectionOffsets_)) { this.content_.removeAt(this.selectionOffsets_.start, this.selectionOffsets_.end); this.unselect(); } return result; }; /** * Component default css class. * @type {string} */ pwk.Line.CSS_CLASS = 'pwk-line'; × Search results Close "},"pwk_editor_nodes_linecontent.js.html":{"id":"pwk_editor_nodes_linecontent.js.html","title":"Source: pwk/editor/nodes/linecontent.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/linecontent.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Represents the content of line component. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.LineContent'); goog.require('goog.dom.classlist'); goog.require('goog.ui.Component'); goog.require('pwk.NodeAnnotation'); goog.require('pwk.primitives.ClientRectRange'); /** * @param {string=} opt_text * @extends {goog.ui.Component} * @constructor */ pwk.LineContent = function(opt_text) { goog.base(this); /** * @type {string} * @private */ this.text_ = opt_text || ''; /** * @type {Array.&lt;pwk.NodeAnnotation&gt;} * @private */ this.annotations_ = []; }; goog.inherits(pwk.LineContent, goog.ui.Component); /** @inheritDoc */ pwk.LineContent.prototype.createDom = function() { // Create element and apply classes this.setElementInternal(goog.dom.createElement('span')); goog.dom.classlist.add(this.getElement(), pwk.LineContent.CSS_CLASS); if(this.text_.length) { var textValue = this.text_; this.text_ = ''; this.insertText(textValue); } }; /** @inheritDoc */ pwk.LineContent.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); }; /** @inheritDoc */ pwk.LineContent.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove annotations for(var i = 0; i &lt; this.annotations_.length; i++) { goog.array.removeAt(this.annotations_, i); } delete this.annotations_; delete this.text_; }; /** * Insert or set text for current line content. * @param {string} text * @param {number=} opt_offset */ pwk.LineContent.prototype.insertText = function(text, opt_offset) { if(text &amp;&amp; text.length &gt; 0) { var el = this.getElement(), fragment = document.createDocumentFragment(), fragmentFirstChild, textLength; fragment.appendChild(el.cloneNode(true)); fragmentFirstChild = /** @type {Element} */(fragment.firstChild); textLength = goog.string.normalizeWhitespace(text).length; if(goog.isDefAndNotNull(opt_offset)) { while(textLength--) { this.insertValue(text[textLength], opt_offset, fragmentFirstChild); } } else { while(textLength--) { this.insertValue(text[textLength], 0, fragmentFirstChild); } } goog.dom.replaceNode(fragmentFirstChild, el); this.setElementInternal(fragmentFirstChild); } }; /** * Insert a single value. * @param {string} value Content value, used as single value of TextNode * @param {number=} opt_offset * @param {Node|Element=} opt_parent */ pwk.LineContent.prototype.insertValue = function(value, opt_offset, opt_parent) { var text = this.text_, parent = opt_parent || this.getElement(), offset = opt_offset || 0, textNode; textNode = document.createTextNode(value); parent.insertBefore(textNode, parent.childNodes[offset] || null); // Update indexes this.text_ = text.substr(0, offset) + textNode.nodeValue + text.substr(offset); }; /** * @return {string} */ pwk.LineContent.prototype.getText = function() { return this.text_; }; /** * @return {string} */ pwk.LineContent.prototype.getNormalizedText = function() { return goog.string.normalizeWhitespace(this.text_); }; /** * Removes the last text node from the content and returns its value. * @return {string} The value of the popped text node. */ pwk.LineContent.prototype.pop = function() { var el = this.getElement(), lastChild = el.lastChild, nodeValue = lastChild.nodeValue, text = this.text_; lastChild.parentNode.removeChild(lastChild); this.text_ = text.slice(0, this.getNormalizedText().length - 1); // TODO: Update annotations required return nodeValue; }; /** * Removes latest text nodes, separated by space/tab, from the content and returns their values. * @return {string} Merged values of the popped text nodes. */ pwk.LineContent.prototype.popLastWord = function() { var googString = goog.string, el = this.getElement(), text = this.text_, normalizedText = this.getNormalizedText(), spaceIndex = googString.trimRight(normalizedText).lastIndexOf(' '), offset = spaceIndex != -1 ? spaceIndex + 1 : 0, gRange = goog.dom.Range.createFromNodes(el, offset, el, normalizedText.length), value = text.slice(offset); gRange.removeContents(); // TODO: Update annotations required this.text_ = text.slice(0, offset); return value; }; pwk.LineContent.prototype.popFirstWord = function() { var googString = goog.string, el = this.getElement(), text = this.text_, normalizedText = this.getNormalizedText(), spaceIndex = normalizedText.indexOf(' '), offset = spaceIndex != -1 ? spaceIndex + 1 : text.length; if(spaceIndex == 0) { var trimedText = googString.trimLeft(normalizedText); var firstCharIndex = text.indexOf(trimedText[0]); offset = normalizedText.indexOf(' ', firstCharIndex); } while(googString.isSpace(normalizedText[offset])) { offset++; } var gRange = goog.dom.Range.createFromNodes(el, 0, el, offset), value = text.slice(0, offset); gRange.removeContents(); // TODO: Update annotations required this.text_ = text.slice(offset); return value; }; pwk.LineContent.prototype.removeFirstWord = function() { var googString = goog.string, el = this.getElement(), text = this.text_, normalizedText = this.getNormalizedText(), spaceIndex = normalizedText.indexOf(' '), offset = spaceIndex != -1 ? spaceIndex + 1 : text.length; if(spaceIndex == 0) { var trimedText = googString.trimLeft(normalizedText); var firstCharIndex = text.indexOf(trimedText[0]); offset = normalizedText.indexOf(' ', firstCharIndex); } while(googString.isSpace(normalizedText[offset])) { offset++; } var gRange = goog.dom.Range.createFromNodes(el, 0, el, offset); gRange.removeContents(); // TODO: Update annotations required this.text_ = text.slice(offset); }; /** * Returns first word * @return {string} */ pwk.LineContent.prototype.copyFirstWord = function() { var googString = goog.string, text = this.text_, normalizedText = this.getNormalizedText(), spaceIndex = normalizedText.indexOf(' '), offset = spaceIndex != -1 ? spaceIndex + 1 : normalizedText.length; if(spaceIndex == 0) { var trimedText = googString.trimLeft(normalizedText); var firstCharIndex = text.indexOf(trimedText[0]); offset = normalizedText.indexOf(' ', firstCharIndex); } while(googString.isSpace(normalizedText[offset])) { offset++; } return text.slice(0, offset); }; /** * Returns the last text node value. * @return {string} The value of the popped text node. */ pwk.LineContent.prototype.getLastTextNodeValue = function() { return this.getElement().lastChild.nodeValue; }; /** * Returns first character, without deleting it * @return {string} */ pwk.LineContent.prototype.copyFirstChar = function() { return this.text_.slice(0, 1); }; /** * @param {number} startOffset * @param {number=} opt_endOffset * @return {string} */ pwk.LineContent.prototype.cut = function(startOffset, opt_endOffset) { var el = this.getElement(), text = this.text_, normalizedText = this.getNormalizedText(), endOffset = opt_endOffset || normalizedText.length, gRange = goog.dom.Range.createFromNodes(el, startOffset, el, endOffset), value = text.slice(startOffset, endOffset); gRange.removeContents(); this.text_ = text.slice(0, startOffset) + text.slice(endOffset); return value; }; /** * @param {number} startOffset * @param {number=} opt_endOffset * @return {string} */ pwk.LineContent.prototype.copy = function(startOffset, opt_endOffset) { var text = this.text_, normalizedText = this.getNormalizedText(), endOffset = opt_endOffset || normalizedText.length; return text.slice(startOffset, endOffset); }; /** * @param {number} startOffset * @param {number=} opt_endOffset */ pwk.LineContent.prototype.removeAt = function(startOffset, opt_endOffset) { var el = this.getElement(), text = this.text_, normalizedText = this.getNormalizedText(), endOffset = opt_endOffset || normalizedText.length, gRange = goog.dom.Range.createFromNodes(el, startOffset, el, endOffset); gRange.removeContents(); this.text_ = text.slice(0, startOffset) + text.slice(endOffset); }; /** * @return {number} */ pwk.LineContent.prototype.getLength = function() { return this.getNormalizedText().length; }; /** * @param offset * @return {Node?} */ pwk.LineContent.prototype.getTextNodeAtOffset = function(offset) { return this.getElement().childNodes[offset] || null; }; /** * @param {number} offset * @return {string} */ pwk.LineContent.prototype.getTextNodeValueAtOffset = function(offset) { var textNode = this.getElement().childNodes[offset]; return textNode != null ? textNode.nodeValue : ''; }; /** * Get width of printable content * @param {boolean} isOnlyPrintableContent * @return {number} */ pwk.LineContent.prototype.getWidth = function(isOnlyPrintableContent) { var el = this.getElement(), width; if(isOnlyPrintableContent) { var lastCharIndex = goog.string.trimRight(this.getNormalizedText()).length; if(goog.userAgent.IE) { var textRange = document.body.createTextRange(), browserZoomLevel = (!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./)) ? 1 : screen.deviceXDPI / screen.logicalXDPI; textRange.moveToElementText(el); textRange.moveStart('character', 0); textRange.collapse(); textRange.moveEnd('character', lastCharIndex); width = textRange.boundingWidth / browserZoomLevel; } else { var range = document.createRange(); range.selectNodeContents(el); range.setStart(el, 0); range.setEnd(el, lastCharIndex); width = range.getBoundingClientRect().width; } } else { width = goog.style.getSize(el).width; } return width; }; /** * Returns a text rectangle object that encloses a group of text rectangles at specific offset. * @return {pwk.primitives.ClientRectRange} */ pwk.LineContent.prototype.getBoundingClientRectForOffset = function(opt_startOffset, opt_endOffset) { var el = this.getElement(), clientRectResult; opt_startOffset = goog.isDefAndNotNull(opt_startOffset) ? opt_startOffset : 0; opt_endOffset = goog.isDefAndNotNull(opt_endOffset) ? opt_endOffset : this.getLength(); if(goog.userAgent.IE) { var textRange = document.body.createTextRange(), browserZoomLevel = (!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./)) ? 1 : screen.deviceXDPI / screen.logicalXDPI; textRange.moveToElementText(el); textRange.moveStart('character', opt_startOffset); textRange.collapse(); textRange.moveEnd('character', opt_endOffset - opt_startOffset); clientRectResult = new pwk.primitives.ClientRectRange(); clientRectResult.width = textRange.boundingWidth / browserZoomLevel; clientRectResult.height = textRange.boundingHeight / browserZoomLevel; clientRectResult.left = textRange.boundingLeft / browserZoomLevel; clientRectResult.top = textRange.boundingTop / browserZoomLevel; } else { var range = document.createRange(), boundingClientRect; range.selectNodeContents(el); range.setStart(el, opt_startOffset); range.setEnd(el, opt_endOffset); boundingClientRect = range.getBoundingClientRect(); clientRectResult = new pwk.primitives.ClientRectRange(); clientRectResult.width = boundingClientRect.width; clientRectResult.height = boundingClientRect.height; clientRectResult.top = boundingClientRect.top; clientRectResult.left = boundingClientRect.left; } return clientRectResult; }; /** * Get text and width for content range * @param {number} startOffset * @param {number=} opt_endOffset * @return {{width: number, text: string}} */ pwk.LineContent.prototype.getContentInfoForOffset = function(startOffset, opt_endOffset) { var text = this.text_, normalizedText = this.getNormalizedText(), endOffset = opt_endOffset || normalizedText.length, el = this.getElement(), width; if(goog.userAgent.IE) { var textRange = document.body.createTextRange(), browserZoomLevel = (!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./)) ? 1 : screen.deviceXDPI / screen.logicalXDPI; textRange.moveToElementText(el); textRange.moveStart('character', startOffset); textRange.collapse(); textRange.moveEnd('character', endOffset); width = textRange.boundingWidth / browserZoomLevel; } else { var range = document.createRange(); range.selectNodeContents(el); range.setStart(el, startOffset); range.setEnd(el, endOffset); width = range.getBoundingClientRect().width; } return {width: width, text: text.slice(startOffset, endOffset)}; }; /** * Get first word and width * @return {{width: number, text: string}} */ pwk.LineContent.prototype.getFirstWordInfo = function() { var googString = goog.string, text = this.text_, normalizedText = this.getNormalizedText(), spaceIndex = normalizedText.indexOf(' '), offset = spaceIndex != -1 ? spaceIndex + 1 : normalizedText.length; if(spaceIndex == 0) { var trimedText = googString.trimLeft(normalizedText); var firstCharIndex = text.indexOf(trimedText[0]); offset = normalizedText.indexOf(' ', firstCharIndex); } while(googString.isSpace(normalizedText[offset])) { offset++; } return this.getContentInfoForOffset(0, offset); }; /** * @return {Array.&lt;pwk.NodeAnnotation&gt;} */ pwk.LineContent.prototype.getAnnotations = function() { return this.annotations_; }; /** * @param {pwk.NodeAnnotation} annotation */ pwk.LineContent.prototype.addAnnotation = function(annotation) { this.annotations_.push(annotation); }; pwk.LineContent.CSS_CLASS = 'pwk-line-content'; × Search results Close "},"pwk_editor_linerangeinfo.js.html":{"id":"pwk_editor_linerangeinfo.js.html","title":"Source: pwk/editor/linerangeinfo.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/linerangeinfo.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Represent class to store line offset information. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.LineOffsetInfo'); /** * Store line offset information. * @constructor */ pwk.LineOffsetInfo = function() { /** * @type {number} * @private */ this.lineIndex; /** * @type {pwk.Line} * @private */ this.line; /** * @type {number} * @private */ this.lineOffset; /** * @type {number} * @private */ this.nodeOffset; /** * @type {number} * @private */ this.lineLength; /** * @type {number} * @private */ this.linkedNodeOffset; }; /** * Get line index. * @return {number} */ pwk.LineOffsetInfo.prototype.getLineIndex = function() { return this.lineIndex; }; /** * Set line index. * @param value Line index value. */ pwk.LineOffsetInfo.prototype.setLineIndex = function(value) { this.lineIndex = value; }; /** * Get line instance {@code pwk.Line}. * @return {pwk.Line} */ pwk.LineOffsetInfo.prototype.getLine = function() { return this.line; }; /** * Set line. * @param {pwk.Line} line Line instance. */ pwk.LineOffsetInfo.prototype.setLine = function(line) { return this.line = line; }; /** * Get line offset. * @return {number} */ pwk.LineOffsetInfo.prototype.getLineOffset = function() { return this.lineOffset; }; /** * Set line offset. * @param {number} value Line offset value. */ pwk.LineOffsetInfo.prototype.setLineOffset = function(value) { this.lineOffset = value; }; /** * Get node offset. * @return {number} */ pwk.LineOffsetInfo.prototype.getNodeOffset = function() { return this.nodeOffset; }; /** * Set node offset. * @param {number} value Node offset value. */ pwk.LineOffsetInfo.prototype.setNodeOffset = function(value) { this.nodeOffset = value; }; /** * Get line length. * @return {number} */ pwk.LineOffsetInfo.prototype.getLineLength = function() { return this.lineLength; }; /** * Set line length. * @param {number} value Line length value. */ pwk.LineOffsetInfo.prototype.setLineLength = function(value) { this.lineLength = value; }; /** * Current offset pointing to the end of line? * @return {boolean} */ pwk.LineOffsetInfo.prototype.isEndOfLine = function() { return this.lineOffset &gt; 0 ? this.lineLength == this.lineOffset : ((this.lineLength - 1) == 0) }; /** * Get linked node offset. * @return {number} */ pwk.LineOffsetInfo.prototype.getLinkedNodeOffset = function() { return this.linkedNodeOffset; }; /** * Set node offset. * @param {number} value Linked node offset value. */ pwk.LineOffsetInfo.prototype.setLinkedNodeOffset = function(value) { this.linkedNodeOffset = value; }; × Search results Close "},"pwk_editor_nodes_nodeannotation.js.html":{"id":"pwk_editor_nodes_nodeannotation.js.html","title":"Source: pwk/editor/nodes/nodeannotation.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/nodeannotation.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.NodeAnnotation'); /** * @param {string} type * @param {{start: number, end: number}} range * @constructor */ pwk.NodeAnnotation = function(type, range) { /** * Type of current annotation. * * @type {string} * @private */ this.type_ = type; /** * Range offset. * @type {{start: number, end: number}} * @private */ this.range_ = range; /** * @type {string} * @private */ this.data_; }; /** * Get current annotation type. * @return {string} */ pwk.NodeAnnotation.prototype.getType = function() { return this.type_; }; /** * @return {{start: number, end: number}} */ pwk.NodeAnnotation.prototype.getRangeOffset = function() { return this.range_; }; /** * @return {string} */ pwk.NodeAnnotation.prototype.getData = function() { return this.data_; }; × Search results Close "},"pwk_editor_nodes_nodeattribute.js.html":{"id":"pwk_editor_nodes_nodeattribute.js.html","title":"Source: pwk/editor/nodes/nodeattribute.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/nodeattribute.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Class represent node attribute. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.NodeAttribute'); goog.provide('pwk.NodeAttributeTypes'); /** * @param {pwk.NodeAttributeTypes} type * @param {string} value * @constructor */ pwk.NodeAttribute = function(type, value) { /** * @type {pwk.NodeAttributeTypes} * @private */ this.type_ = type; /** * @type {string} * @private */ this.value_ = ''; this.setValue(value); }; /** * Get attribute type. * @return {pwk.NodeAttributeTypes} */ pwk.NodeAttribute.prototype.getType = function() { return this.type_; }; /** * Get attribute value. * @return {string} */ pwk.NodeAttribute.prototype.getValue = function() { return this.value_; }; /** * Set attribute value. * @param {string} value * @param {boolean=} opt_isAppendValue Add value to the exist value. Adding depend from attribute type */ pwk.NodeAttribute.prototype.setValue = function(value, opt_isAppendValue) { if(goog.isDefAndNotNull(this.value_)) { switch(this.type_) { case pwk.NodeAttributeTypes.HTML_CLASS: var classes = this.value_.split(' '); // Is class already assigned? if(!goog.array.contains(classes, value)) { // Is required to append value of just define it? if(opt_isAppendValue) { this.value_ = this.value_ + ' ' + value; } else { this.value_ = value; } } break; default: this.value_ = value; } } }; /** * Node attribute types. * * @enum {string} */ pwk.NodeAttributeTypes = { HTML_CLASS: 'html/class', STYLE_HEIGHT: 'style/height', STYLE_LINE_HEIGHT: 'style/lineHeight', STYLE_FONT_SIZE: 'style/fontSize' }; × Search results Close "},"pwk_editor_nodeformatter.js.html":{"id":"pwk_editor_nodeformatter.js.html","title":"Source: pwk/editor/nodeformatter.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodeformatter.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview This class uses for formatting nodes of various types. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.NodeFormatter'); goog.require('goog.dom.classlist'); goog.require('pwk.DocumentSettings'); goog.require('pwk.NodeAttributeTypes'); /** * @param {pwk.Document} doc * @param {pwk.Node|pwk.LeafNode} node */ pwk.NodeFormatter.applyGlobalDocumentFormation = function(doc, node) { var nodeIndex = doc.indexOfNode(node) , documentSettings = (/**@type {pwk.DocumentSettings}*/(pwk.DocumentSettings.getInstance())); switch (node.getType()) { case pwk.NodeTypes.PARAGRAPH: var prevNode = doc.getNodeAt(nodeIndex - 1) , types = pwk.NodeAttributeTypes; if (goog.isDefAndNotNull(prevNode)) { node.setAttribute(types.STYLE_LINE_HEIGHT, prevNode.getAttribute(types.STYLE_LINE_HEIGHT).getValue()); node.setAttribute(types.STYLE_HEIGHT, prevNode.getAttribute(types.STYLE_HEIGHT).getValue()); node.setAttribute(types.STYLE_FONT_SIZE, prevNode.getAttribute(types.STYLE_FONT_SIZE).getValue()); } else { var height = (parseFloat(pwk.utils.style.PointsToPixels(documentSettings.getFontSize())) * parseFloat(documentSettings.getLineHeight())) + 'px'; node.setAttribute(types.STYLE_LINE_HEIGHT, documentSettings.getLineHeight()); node.setAttribute(types.STYLE_HEIGHT, height); node.setAttribute(types.STYLE_FONT_SIZE, documentSettings.getFontSize()); } break; } }; /** * Apply attributes for the specified node. * * @param {Array.&lt;pwk.NodeAttribute&gt;} attributes * @param {goog.ui.Component} node Node or any child component */ pwk.NodeFormatter.applyNodeAttributes = function(attributes, node) { var el = node.getElement(); goog.array.forEach(attributes, function(attr) { var value = attr.getValue(); switch (attr.getType()) { case pwk.NodeAttributeTypes.HTML_CLASS: goog.dom.classlist.set(el, value); break; case pwk.NodeAttributeTypes.STYLE_FONT_SIZE: el.style.fontSize = value; break; case pwk.NodeAttributeTypes.STYLE_HEIGHT: goog.style.setHeight(el, value); break; case pwk.NodeAttributeTypes.STYLE_LINE_HEIGHT: el.style.lineHeight = value; break; default: throw new Error('Unknown node attribute type'); } }); }; × Search results Close "},"pwk_editor_nodes_nodetypes.js.html":{"id":"pwk_editor_nodes_nodetypes.js.html","title":"Source: pwk/editor/nodes/nodetypes.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/nodes/nodetypes.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.NodeTypes'); /** * Node types * @enum {string} */ pwk.NodeTypes = { PARAGRAPH: 'pwk-paragraph' }; × Search results Close "},"pwk_editor_page.js.html":{"id":"pwk_editor_page.js.html","title":"Source: pwk/editor/page.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/page.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Document page * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Page'); goog.provide('pwk.Page.EventType'); goog.provide('pwk.Page.PageOverflowEvent'); goog.require('goog.dom.classlist'); goog.require('goog.events.Event'); goog.require('goog.ui.Component'); goog.require('pwk.Node'); goog.require('pwk.NodeFormatter'); goog.require('pwk.PageContent'); goog.require('pwk.PageFooter'); goog.require('pwk.PageHeader'); goog.require('pwk.PageSettings'); /** * Initialize {pwk.Page} component. * * @param {pwk.Document} doc * @constructor * @extends {goog.ui.Component} */ pwk.Page = function(doc) { goog.base(this); /** * @type {pwk.Document} * @private */ this.document_ = doc; /** * @type {pwk.PageHeader} * @private */ this.header_ = new pwk.PageHeader(); /** * @type {pwk.PageFooter} * @private */ this.footer_ = new pwk.PageFooter(); /** * @type {pwk.PageContent} * @private */ this.content_ = new pwk.PageContent(doc); /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); }; goog.inherits(pwk.Page, goog.ui.Component); /** @inheritDoc */ pwk.Page.prototype.createDom = function() { // Create element var el = this.dom_.createElement('div') , pageSettings = this.pageSettings_ , pageSize = pageSettings.getSize(); this.setElementInternal(el); this.decorateInternal(el); // add child this.addChild(this.header_, true); this.addChild(this.content_, true); this.addChild(this.footer_, true); // apply settings goog.style.setWidth(el, pageSize.width + 'px'); goog.style.setHeight(el, pageSize.height + 'px'); }; /** @inheritDoc */ pwk.Page.prototype.decorateInternal = function(element) { goog.base(this, 'decorateInternal', element); goog.dom.classlist.add(element, pwk.Page.CSS_CLASS); }; /** @inheritDoc */ pwk.Page.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove references delete this.header_; delete this.footer_; delete this.content_; this.pageSettings_ = null; this.document_ = null; }; /** * Link the node with current page and place on the end of page * @param {pwk.Node} node */ pwk.Page.prototype.linkNode = function(node) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } this.content_.linkNode(node); this.checkPageOverflow(); }; /** * Link the node with current page and place it before specific node * @param {pwk.Node} node * @param {pwk.Node} sibling */ pwk.Page.prototype.linkNodeBefore = function(node, sibling) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } this.content_.linkNodeBefore(node, sibling); this.checkPageOverflow(); }; /** * Link the node with current page and place it after specific node * @param {pwk.Node} node * @param {pwk.Node} previous */ pwk.Page.prototype.linkNodeAfter = function(node, previous) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } this.content_.linkNodeAfter(node, previous); this.checkPageOverflow(); }; /** * Get maximum content height. * @return {number} */ pwk.Page.prototype.getMaxContentSize = function() { var googStyle = goog.style , headerSize = googStyle.getSize(this.header_.getElement()) , // TODO: move to constant footerSize = googStyle.getSize(this.footer_.getElement()) , // TODO: move to constant pageSize = this.pageSettings_.getSize(); return pageSize.height - footerSize.height - headerSize.height; }; /** * Get available content height. * @return {number} */ pwk.Page.prototype.getAvailableContentSize = function() { return this.getMaxContentSize() - goog.style.getSize(this.content_.getElement()).height; }; /** * Checking size of page content on overflows and dispatching OVERFLOW event in case page is overflowed. */ pwk.Page.prototype.checkPageOverflow = function() { var googStyle = goog.style , doc = this.document_ , contentEl = this.content_.getElement() , contentSize = googStyle.getSize(contentEl) , maxContentHeight = this.getMaxContentSize(); // If page content higher than allowed value if (contentSize.height &gt; maxContentHeight) { var nodes = [] , // Nodes which will be moved to the next page pageIndex = doc.indexOfPage(this) , pageNodes = doc.getPaginationIndex()[pageIndex] , pageNodesLength = pageNodes.length , loopNode , newLinkedNode; while (pageNodesLength--) { loopNode = doc.getNode(pageNodes[pageNodesLength]); switch (loopNode.getType()) { case pwk.NodeTypes.PARAGRAPH: var leafNode = /** @type {pwk.LeafNode} */(loopNode) , nodeHeight = googStyle.getSize(leafNode.getElement()).height , linkedNode = leafNode.getNextLinkedNode(); // Is required to move the whole node? if ((contentEl.offsetHeight - nodeHeight) &lt; maxContentHeight) { var lineLength = leafNode.getLinesCount() , loopLine , heightToCut = 0; while (lineLength--) { loopLine = leafNode.getLineAt(lineLength); heightToCut += loopLine.getHeight(); if ((contentEl.offsetHeight - heightToCut) &lt; maxContentHeight) { break; } } if (lineLength == 0) { // Move all node to the next page goog.array.insert(nodes, this.content_.unlinkNode(leafNode)); } else { var lastLine; if (!goog.isDefAndNotNull(linkedNode)) { // Move lines to the new linked node for (var i = leafNode.getLinesCount() - 1; i &gt;= lineLength; i--) { lastLine = loopNode.unlinkLine(loopNode.getLineAt(i)); if (!goog.isDefAndNotNull(newLinkedNode)) { newLinkedNode = new pwk.LeafNode(loopNode.getType(), doc, lastLine); loopNode.setNextLinkedNode(newLinkedNode); } else { newLinkedNode.insertLine(lastLine, false, 0); } } goog.array.insert(nodes, newLinkedNode); } else { // Move lines to the exist next linked node for (var i = leafNode.getLinesCount() - 1; i &gt;= lineLength; i--) { lastLine = loopNode.unlinkLine(loopNode.getLineAt(i)); linkedNode.insertLine(lastLine, true, 0); } doc.getPageAt(doc.getPagination().getPageIndexByNodeId(linkedNode.getId())).checkPageOverflow(); } } } else { // Move all node to the next page goog.array.insert(nodes, this.content_.unlinkNode(leafNode)); } break; default: // Remove node from page to move it to the next page goog.array.insert(nodes, this.content_.unlinkNode(loopNode)); } // Recalculate content if (contentEl.offsetHeight &lt; maxContentHeight) { break; } } // Page overflowed! this.dispatchEvent(new pwk.Page.PageOverflowEvent(this, nodes, pageIndex)); } }; /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.Page.CSS_CLASS = 'pwk-page'; /** * Event types that can be stopped/started. * @enum {string} */ pwk.Page.EventType = { OVERFLOW: goog.events.getUniqueId('page_overflow') }; /** * @param {pwk.Page} page * @param {Array.&lt;pwk.Node&gt;} nodes * @param {number} pageIndex * @extends {goog.events.Event} * @constructor */ pwk.Page.PageOverflowEvent = function(page, nodes, pageIndex) { goog.events.Event.call(this, pwk.Page.EventType.OVERFLOW, page); /** * @type {Array.&lt;pwk.Node&gt;} * @private */ this.nodes_ = nodes; /** * @type {number} * @private */ this.pageIndex_ = pageIndex; }; goog.inherits(pwk.Page.PageOverflowEvent, goog.events.Event); /** * @return {Array.&lt;pwk.Node&gt;} */ pwk.Page.PageOverflowEvent.prototype.getNodesForMoving = function() { return this.nodes_; }; /** * @return {number} */ pwk.Page.PageOverflowEvent.prototype.getPageIndex = function() { return this.pageIndex_; }; × Search results Close "},"pwk_editor_pagecontent.js.html":{"id":"pwk_editor_pagecontent.js.html","title":"Source: pwk/editor/pagecontent.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/pagecontent.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Page content component. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.PageContent'); goog.require('goog.dom.classlist'); goog.require('goog.style'); goog.require('goog.ui.Component'); goog.require('pwk.Node'); /** * Initialize {pwk.PageContent} component. * * @param {pwk.Document} doc * @constructor * @extends {goog.ui.Component} */ pwk.PageContent = function(doc) { goog.base(this); /** * @type {pwk.Document} * @private */ this.document_ = doc; /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); }; goog.inherits(pwk.PageContent, goog.ui.Component); /** @inheritDoc */ pwk.PageContent.prototype.createDom = function() { var element = this.dom_.createElement('div'); this.setElementInternal(element); this.decorateInternal(element); }; /** @inheritDoc */ pwk.PageContent.prototype.decorateInternal = function(element) { goog.base(this, 'decorateInternal', element); goog.dom.classlist.add(element, pwk.PageContent.CSS_CLASS); // apply settings var pageSettings = this.pageSettings_; element.style.paddingRight = pageSettings.getRightMargin() + 'px'; element.style.paddingLeft = pageSettings.getLeftMargin() + 'px'; }; /** @inheritDoc */ pwk.PageContent.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); }; /** @inheritDoc */ pwk.PageContent.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove references this.document_ = null; }; /** * Render node inside this page content and insert at the end of page. * @param {pwk.Node} node */ pwk.PageContent.prototype.linkNode = function(node) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } var el = this.getElement(); node.render(el); }; /** * Render node inside this page content and insert before specific node. * @param {pwk.Node} node * @param {pwk.Node} sibling */ pwk.PageContent.prototype.linkNodeBefore = function(node, sibling) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } var siblingEl = sibling.getElement(); node.renderBefore(siblingEl); }; /** * Render node inside this page content and insert before specific node. * @param {pwk.Node} node * @param {pwk.Node} previous */ pwk.PageContent.prototype.linkNodeAfter = function(node, previous) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node shouldn\\'t be already in the document.'); } node.render(previous.getParent().getElement()); var nodeEl = node.getElement() , previousNodeEl = previous.getElement(); if (nodeEl.previousElementSibling != previousNodeEl) { goog.dom.insertSiblingAfter(node.getElement(), previous.getElement()); } }; /** * Remove node from document and return if any. * @param {string|pwk.Node} node */ pwk.PageContent.prototype.unlinkNode = function(node) { return this.document_.unlinkNode(node); }; /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.PageContent.CSS_CLASS = 'pwk-page-content'; × Search results Close "},"pwk_editor_pagefooter.js.html":{"id":"pwk_editor_pagefooter.js.html","title":"Source: pwk/editor/pagefooter.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/pagefooter.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Represent footer of the page. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.PageFooter'); goog.require('goog.dom.classlist'); goog.require('goog.ui.Component'); goog.require('pwk.PageSettings'); /** * Initialize {pwk.PageFooter} component. * * @constructor * @extends {goog.ui.Component} */ pwk.PageFooter = function() { goog.base(this); /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); }; goog.inherits(pwk.PageFooter, goog.ui.Component); /** @inheritDoc */ pwk.PageFooter.prototype.createDom = function() { var el = this.dom_.createElement('div'); this.setElementInternal(el); this.decorateInternal(el); // Width should be equal page width goog.style.setWidth(el, this.pageSettings_.getSize().width + 'px'); goog.style.setUnselectable(el, true); }; /** @inheritDoc */ pwk.PageFooter.prototype.decorateInternal = function(element) { goog.base(this, 'decorateInternal', element); goog.dom.classlist.add(element, pwk.PageFooter.CSS_CLASS); }; /** @inheritDoc */ pwk.PageFooter.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); }; /** @inheritDoc */ pwk.PageFooter.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove references this.pageSettings_ = null; }; /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.PageFooter.CSS_CLASS = 'pwk-page-footer'; × Search results Close "},"pwk_editor_pageheader.js.html":{"id":"pwk_editor_pageheader.js.html","title":"Source: pwk/editor/pageheader.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/pageheader.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Page header component. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.PageHeader'); goog.require('goog.dom.classlist'); goog.require('goog.ui.Component'); goog.require('pwk.PageSettings'); /** * Initialize {pwk.PageHeader} component. * * @constructor * @extends {goog.ui.Component} */ pwk.PageHeader = function() { goog.base(this); /** * @type {pwk.PageSettings} * @private */ this.pageSettings_ = pwk.PageSettings.getInstance(); }; goog.inherits(pwk.PageHeader, goog.ui.Component); /** @inheritDoc */ pwk.PageHeader.prototype.createDom = function() { var el = this.dom_.createElement('div'); this.setElementInternal(el); this.decorateInternal(el); // Width should be equal page width goog.style.setWidth(el, this.pageSettings_.getSize().width + 'px'); goog.style.setUnselectable(el, true); }; /** @inheritDoc */ pwk.PageHeader.prototype.decorateInternal = function(element) { goog.base(this, 'decorateInternal', element); goog.dom.classlist.add(element, pwk.PageHeader.CSS_CLASS); }; /** @inheritDoc */ pwk.PageHeader.prototype.enterDocument = function() { goog.base(this, 'enterDocument'); }; /** @inheritDoc */ pwk.PageHeader.prototype.disposeInternal = function() { goog.base(this, 'disposeInternal'); // Remove references this.pageSettings_ = null; }; /** * Default CSS class to be applied to the root element of components rendered * by this renderer. * * @type {string} */ pwk.PageHeader.CSS_CLASS = 'pwk-page-header'; × Search results Close "},"pwk_editor_pagesettings.js.html":{"id":"pwk_editor_pagesettings.js.html","title":"Source: pwk/editor/pagesettings.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/pagesettings.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview This class contains shared settings for document pages. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.PageSettings'); goog.provide('pwk.PageSettings.Paper'); goog.require('goog.math.Size'); /** * Initialize {pwk.PageSettings} component. * @constructor */ pwk.PageSettings = function() { /** * @type {pwk.PageSettings.Paper} * @private */ this.pagePaper_ = pwk.PageSettings.Paper.Executive; /** * Page width. (in pixels) * @type {number} * @private */ this.width_ = this.pagePaper_.width.pixel; /** * Page height. (in pixels) * @type {number} * @private */ this.heigth_ = this.pagePaper_.height.pixel; /** * Left margin in pixels * @type {number} * @private */ this.leftMargin_ = 90; /** * Right margin in pixels * @type {number} * @private */ this.rightMargin_ = 90; /** * Document instance. * @type {pwk.Document} * @private */ this.document_; }; goog.addSingletonGetter(pwk.PageSettings); /** * @param {pwk.Document} doc Document required to manage global settings of pages of document. */ pwk.PageSettings.prototype.initialize = function(doc) { this.document_ = doc; }; // TODO: To implement the functionality to set left/right margin and apply this settings on UI side /** * Get left page margin. * @return {number} */ pwk.PageSettings.prototype.getLeftMargin = function() { return this.leftMargin_; }; /** * Get right page margin. * @return {number} */ pwk.PageSettings.prototype.getRightMargin = function() { return this.rightMargin_; }; /** * Get page size settings. * @return {goog.math.Size} */ pwk.PageSettings.prototype.getSize = function() { return new goog.math.Size(this.width_, this.heigth_); }; /** * Get page content width * @return {number} */ pwk.PageSettings.prototype.getContentWidth = function() { return this.width_ - this.leftMargin_ - this.rightMargin_; }; /** * Get inner width of page * @return {number} */ pwk.PageSettings.prototype.getInnerWidth = function() { return this.width_ - this.leftMargin_ - this.rightMargin_; }; /** * @return {pwk.Document} * @private */ pwk.PageSettings.prototype.getDocument_ = function() { if (!goog.isDefAndNotNull(this.document_)) { throw new Error('Document should be initialized!'); } return this.document_; }; /** * Sizes of common paper sizes. * @enum {Object} */ pwk.PageSettings.Paper = { Test: { height: { pixel: 6 * 96 }, width: { pixel: 5 * 96 } }, A4: { height: { pixel: 11.69 * 96, inch: 11.69, mm: 11.69 * 25.4 }, width: { pixel: 8.27 * 96, inch: 8.27, mm: 8.27 * 25.4 } }, Letter: { height: { pixel: 11.0 * 96, inch: 11.0, mm: 11.0 * 25.4 }, width: { pixel: 8.5 * 96, inch: 8.5, mm: 8.5 * 25.4 } }, Legal: { height: { pixel: 14.0 * 96, inch: 14.0, mm: 14.0 * 25.4 }, width: { pixel: 8.5 * 96, inch: 8.5, mm: 8.5 * 25.4 } }, Executive: { height: { pixel: 10.5 * 96, inch: 10.5, mm: 10.5 * 25.4 }, width: { pixel: 7.25 * 96, inch: 7.25, mm: 7.25 * 25.4 } } }; × Search results Close "},"pwk_editor_pagination.js.html":{"id":"pwk_editor_pagination.js.html","title":"Source: pwk/editor/pagination.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/pagination.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Class with functionality of manipulation by pages of document. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Pagination'); goog.require('goog.events.EventTarget'); /** * @param {pwk.Document} document * @constructor */ pwk.Pagination = function(document) { /** * @type {pwk.Document} * @private */ this.document_ = document; /** * Each array represent page and index equals the index of page in document. * Each child array represent nodes ids. * @type {Array.&lt;Array.&lt;string&gt;&gt;} * @private */ this.pageNodeIndex_ = []; // Initialize event handlers this.initEvents_(); }; /** * Initialize event handlers * @private */ pwk.Pagination.prototype.initEvents_ = function() { goog.events.listen(this.document_, pwk.Document.EventType.NODE_REMOVED, this.onDocumentNodeRemovedEventHandler_, false, this); }; /** * Add node to the document and link with the latest page. * @param {pwk.Node} node */ pwk.Pagination.prototype.addNode = function(node) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node should not be already in the document.'); } var page , pageIndex , editorDocument = this.document_ , pageNodeIndex = this.pageNodeIndex_ , pageNodeIndexLen = this.pageNodeIndex_.length; // Get node index for latest page if (!goog.isArray(pageNodeIndex[pageNodeIndexLen - 1])) { page = new pwk.Page(editorDocument); editorDocument.addPage(page); // Important to add handlers after page initialization. page.listen(pwk.Page.EventType.OVERFLOW, this.onPageOverflowsHandler_, false, this); pageNodeIndex[pageNodeIndexLen] = []; } else { page = editorDocument.getPageAt(pageNodeIndexLen - 1); } // Update index pageIndex = editorDocument.indexOfPage(page); goog.array.insert(pageNodeIndex[pageIndex], node.getId()); // Render node on the page page.linkNode(node); }; /** * Add node to the document at the given 0-based index and link with the page in this position. * @param {pwk.Node} node * @param {number} index * @param {boolean=} opt_after */ pwk.Pagination.prototype.addNodeAt = function(node, index, opt_after) { // Check if node already rendered if (node.isInDocument()) { throw new Error('Node should not be already in the document.'); } var doc = this.document_ , pageNodeIndex = this.pageNodeIndex_ , pageIndex , page; if (opt_after) { var prevNode = doc.getNodeAt(index - 1); if (goog.isDefAndNotNull(prevNode)) { pageIndex = this.getPageIndexByNodeId(prevNode.getId()); var prevNodeIndex = goog.array.indexOf(pageNodeIndex[pageIndex], prevNode.getId()); goog.array.insertAt(pageNodeIndex[pageIndex], node.getId(), prevNodeIndex + 1); page = this.document_.getPageAt(pageIndex); page.linkNodeAfter(node, prevNode); } else { // If previous node does not exist, add node to the end this.addNode(node); } } else { var nextNode = this.document_.getNodeAt(index); if (goog.isDefAndNotNull(nextNode)) { // Get page index pageIndex = this.getPageIndexByNodeId(nextNode.getId()); // Add node index to index var nextNodeIndex = goog.array.indexOf(pageNodeIndex[pageIndex], nextNode.getId()); goog.array.insertAt(pageNodeIndex[pageIndex], node.getId(), nextNodeIndex); page = this.document_.getPageAt(pageIndex); page.linkNodeBefore(node, nextNode); } else { // If sibling node does not exist, add node to the end this.addNode(node); } } }; /** * Checking size of page content on overflows and dispatching OVERFLOW event in case page is overflowed. * @param {string} nodeId Id of changed node. The page of this node will be used as start point for overflow check. */ pwk.Pagination.prototype.checkOverflow = function(nodeId) { var pageIndex = this.getPageIndexByNodeId(nodeId) , activePage = this.document_.getPageAt(pageIndex); activePage.checkPageOverflow(); }; /** * Checking pages filling. Checking started from topless range node. */ pwk.Pagination.prototype.checkFilling = function() { var doc = this.document_ , range = doc.getSelection().getRange(); if (range != null) { //console.log('pwk.Pagination.prototype.checkFilling at ' + Date.now()); var abovePageIndex = this.getPageIndexByNodeId(range.isReversed() ? range.getEndNode().getId() : range.getStartNode().getId()) , // This is topmost edited page index _getBelowPageIndex = goog.bind(function() { return this.pageNodeIndex_.length &gt; abovePageIndex + 1 ? abovePageIndex + 1 : -1; }, this) , belowPageIndex = _getBelowPageIndex() , abovePage; while (belowPageIndex &gt; 0) { // We have page below modified page? abovePage = /** @type {pwk.Page}*/(doc.getPageAt(abovePageIndex)); var availableHeightAbove = abovePage.getAvailableContentSize() , nodeToMove = /** @type {pwk.Node}*/(this.pageNodeIndex_[belowPageIndex].length &gt; 0 ? doc.getNode(this.pageNodeIndex_[belowPageIndex][0]) : null) , // TODO: Should fixed in future, then will be implemented proper range deleting nodeToMoveSize; if (goog.isDefAndNotNull(nodeToMove) &amp;&amp; nodeToMove.isInDocument()) { nodeToMoveSize = nodeToMove.getSize(); // - - - - if(nodeToMoveSize.height &lt;= availableHeightAbove) { // Node above could be moved to the page above completely // // // Check if it's linked node // var previousLinkedNode = nodeToMove.getPreviousLinkedNode(); // if(previousLinkedNode != null) { // switch (previousLinkedNode.getType()) { // case pwk.NodeTypes.PARAGRAPH: // var poppedLines = []; // // // Move lines to the previous linked node // while(nodeToMove.getLinesCount() != 0) { // poppedLines.push(nodeToMove.unlinkLine(nodeToMove.getLineAt(0))); // } // // previousLinkedNode.insertLines(poppedLines, true); // // doc.removeNode(nodeToMove); // break; // // default: // throw new Error('Node type &quot;' + previousLinkedNode.getType() + '&quot; does not handled.'); // // } // } else { // It's not linked node, so just move it to the above page // nodeToMove = doc.unlinkNode(nodeToMove); // doc.addNodeAt(nodeToMove, doc.indexOfNode(previousLinkedNode), true); // } // // } else if(nodeToMove.isSplittable()) { //// // TODO: Split node //// // } else { // //// break; // } } // else { // break; // - - - - } // - check if current page is could be filled by content below {√} // - get available height // - get minimal available splittable part on the page below // - get minimal splittable part height of the node below and node height itself // - if height acceptable, move it to the above page // - remove empty page LAST page // - if not, exit ... // - set page below to belowPageIndex variable //console.log('- = - = - = - = - = -'); return; } } // Steps to fill pages top: // - Checking start from topmost range node // - Get height of remains space of the top page and get height of node below, if it's could be moved to the page // above, move it. Merge with node above if they are linked. // - If the space still remains on the page, check if current node could be split (Create abstract method isSplittable to pwk.Node class), // then try to split it and move part of them. // - Stop checking if content position were not changed }; /** * Get page index where are situated node with specified id. * @param id * @return {number} */ pwk.Pagination.prototype.getPageIndexByNodeId = function(id) { var result , pageNodeIndex = this.pageNodeIndex_ , indexLen = pageNodeIndex.length , googArray = goog.array; for (var i = 0; i &lt; indexLen; i++) { result = googArray.indexOf(pageNodeIndex[i], id); if (result != -1) { return i; } } return -1; }; /** * Handler to process the page overflow event. * @param {pwk.Page.PageOverflowEvent} e */ pwk.Pagination.prototype.onPageOverflowsHandler_ = function(e) { var nodes = e.getNodesForMoving() , page = e.target , pageIndex = e.getPageIndex() , doc = this.document_ , siblingPage = doc.getPageAt(pageIndex + 1); // Update index goog.array.forEach(nodes, function(node) { goog.array.remove(this.pageNodeIndex_[pageIndex], node.getId()); }, this); // Is required to create a new page? if (goog.isDefAndNotNull(siblingPage)) { // - No var siblingPageNodes = this.pageNodeIndex_[pageIndex + 1] , siblingNode = doc.getNode(siblingPageNodes[0]) , siblingNodeIndex = doc.indexOfNode(siblingNode); goog.array.forEach(nodes, function(node) { doc.addNodeAt(node, siblingNodeIndex); }, this); } else { // Yes page = new pwk.Page(doc); doc.addPage(page); // NOTE: Important to add handlers after page initialization. page.listen(pwk.Page.EventType.OVERFLOW, this.onPageOverflowsHandler_, false, this); // Update index this.pageNodeIndex_[this.pageNodeIndex_.length] = []; goog.array.forEachRight(nodes, function(node) { doc.addNode(node); }, this); } }; /** * @return {Array.&lt;Array.&lt;string&gt;&gt;} */ pwk.Pagination.prototype.getPaginationIndex = function() { return this.pageNodeIndex_; }; /** * Event handler for pwk.Document.EventType.NODE_REMOVED event type. * * @param {pwk.Document.NodeRemovedEvent} e * @private */ pwk.Pagination.prototype.onDocumentNodeRemovedEventHandler_ = function(e) { var removedNodeId = e.removedNode.getId(); goog.array.forEach(this.pageNodeIndex_, function(arr) { if (goog.array.remove(arr, removedNodeId)) { } }, this); }; × Search results Close "},"pwk_editor_primitives_clientrectrange.js.html":{"id":"pwk_editor_primitives_clientrectrange.js.html","title":"Source: pwk/editor/primitives/clientrectrange.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/primitives/clientrectrange.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview TODO: add description * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.primitives.ClientRectRange'); /** * @param {number=} opt_width * @param {number=} opt_height * @param {number=} opt_top * @param {number=} opt_left * @constructor */ pwk.primitives.ClientRectRange = function(opt_width, opt_height, opt_top, opt_left) { /** * @type {number} * @public */ this.width = opt_width ? opt_width : 0; /** * @type {number} * @public */ this.height = opt_height ? opt_height : 0; /** * @type {number} * @public */ this.left = opt_left ? opt_left : 0; /** * @type {number} * @public */ this.top = opt_top ? opt_top : 0; }; × Search results Close "},"pwk_editor_primitives_nodeselectionrange.js.html":{"id":"pwk_editor_primitives_nodeselectionrange.js.html","title":"Source: pwk/editor/primitives/nodeselectionrange.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/primitives/nodeselectionrange.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.primitives.NodeSelectionRange'); /** * @param {pwk.Line} startLine * @param {number} startLineOffset * @param {pwk.Line} endLine * @param {number} endLineOffset * @constructor */ pwk.primitives.NodeSelectionRange = function(startLine, startLineOffset, endLine, endLineOffset) { /** * @type {pwk.Line} * @public */ this.startLine = startLine; /** * @type {number} * @public */ this.startLineOffset = startLineOffset; /** * @type {pwk.Line} * @public */ this.endLine = endLine; /** * @type {number} * @public */ this.endLineOffset = endLineOffset; }; /** * @return {boolean} */ pwk.primitives.NodeSelectionRange.prototype.isCollapsed = function() { return this.startLine === this.endLine &amp;&amp; this.startLineOffset === this.endLineOffset; }; /** * @param {pwk.primitives.NodeSelectionRange} otherNodeSelectionRange * @return {boolean} */ pwk.primitives.NodeSelectionRange.prototype.equals = function(otherNodeSelectionRange) { return (otherNodeSelectionRange.startLine == this.startLine &amp;&amp; otherNodeSelectionRange.endLine == this.endLine &amp;&amp; otherNodeSelectionRange.startLineOffset == this.startLineOffset &amp;&amp; otherNodeSelectionRange.endLineOffset == this.endLineOffset); }; × Search results Close "},"pwk_editor_range.js.html":{"id":"pwk_editor_range.js.html","title":"Source: pwk/editor/range.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/range.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview This object is used in various places to indicate a region within the editor. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Range'); goog.require('goog.events.EventTarget'); /** * @param {pwk.Line} startLine * @param {number} startNodeOffset * @param {pwk.Line} endLine * @param {number} endNodeOffset * @param {boolean=} opt_isStartOfStartLine * @param {boolean=} opt_isStartOfEndLine * @constructor * @extends {goog.events.EventTarget} */ pwk.Range = function(startLine, startNodeOffset, endLine, endNodeOffset, opt_isStartOfStartLine, opt_isStartOfEndLine) { goog.events.EventTarget.call(this); /** * @type {pwk.Line} * @private */ this.startLine_ = startLine; /** * @type {pwk.Line} * @private */ this.endLine_ = endLine; /** * @type {pwk.LeafNode} * @private */ this.startNode_ = startLine.getParentNode(); /** * @type {pwk.LeafNode} * @private */ this.endNode_ = endLine.getParentNode(); /** * @type {number} * @private */ this.startNodeOffset_ = startNodeOffset; /** * @type {number} * @private */ this.endNodeOffset_ = endNodeOffset; /** * @type {?pwk.LineOffsetInfo} * @private */ this.startLineRangeInfo_ = this.startNode_.getRangeInfoForOffset(startNodeOffset); /** * @type {?pwk.LineOffsetInfo} * @private */ this.endLineRangeInfo_ = this.endNode_.getRangeInfoForOffset(endNodeOffset); /** * @type {number} * @private */ this.startLineOffset_ = opt_isStartOfStartLine ? 0 : this.startLineRangeInfo_.getLineOffset(); /** * @type {number} * @private */ this.endLineOffset_ = opt_isStartOfEndLine ? 0 : this.endLineRangeInfo_.getLineOffset(); /** * @type {boolean} * @private */ this.isStartOfStartLine_ = !!opt_isStartOfStartLine; /** * @type {boolean} * @private */ this.isStartOfEndLine_ = !!opt_isStartOfEndLine; }; goog.inherits(pwk.Range, goog.events.EventTarget); /** * @return {boolean} */ pwk.Range.prototype.isStartOfStartLine = function() { return this.isStartOfStartLine_; }; /** * @return {boolean} */ pwk.Range.prototype.isStartOfEndLine = function() { return this.isStartOfEndLine_; }; /** * @return {pwk.Line} */ pwk.Range.prototype.getStartLine = function() { return this.startLine_; }; /** * @return {pwk.Line} */ pwk.Range.prototype.getEndLine = function() { return this.endLine_; }; /** * @return {pwk.LeafNode} */ pwk.Range.prototype.getStartNode = function() { return this.startNode_; }; /** * @return {pwk.LeafNode} */ pwk.Range.prototype.getEndNode = function() { return this.endNode_; }; /** * @return {number} */ pwk.Range.prototype.getStartNodeOffset = function() { return this.startNodeOffset_; }; /** * @return {number} */ pwk.Range.prototype.getEndNodeOffset = function() { return this.endNodeOffset_; }; /** * @return {number} */ pwk.Range.prototype.getStartLineOffset = function() { return this.startLineOffset_; }; /** * @return {number} */ pwk.Range.prototype.getEndLineOffset = function() { return this.endLineOffset_; }; /** * @return {?pwk.LineOffsetInfo} */ pwk.Range.prototype.getStartLineRangeInfo = function() { return this.startLineRangeInfo_; }; /** * @return {?pwk.LineOffsetInfo} */ pwk.Range.prototype.getEndLineRangeInfo = function() { return this.endLineRangeInfo_; }; /** * @param {pwk.Line} line * @param {number} nodeOffset * @param {boolean=} opt_isStartOfLine */ pwk.Range.prototype.setStartPosition = function(line, nodeOffset, opt_isStartOfLine) { this.startNode_ = line.getParentNode(); this.startLine_ = line; let rangeInfo = this.startNode_.getRangeInfoForOffset(nodeOffset); if (rangeInfo == null) { throw new Error('Passed incorrect offset!'); } this.startNodeOffset_ = nodeOffset; this.startLineOffset_ = opt_isStartOfLine ? 0 : rangeInfo.getLineOffset(); this.startLineRangeInfo_ = rangeInfo; }; /** * @param {pwk.Line} line * @param {number} nodeOffset * @param {boolean=} opt_isStartOfLine */ pwk.Range.prototype.setEndPosition = function(line, nodeOffset, opt_isStartOfLine) { this.endNode_ = line.getParentNode(); this.endLine_ = line; var rangeInfo = this.endNode_.getRangeInfoForOffset(nodeOffset); if (rangeInfo == null) { throw new Error('Passed incorrect offset!'); } this.endNodeOffset_ = nodeOffset; this.endLineOffset_ = opt_isStartOfLine ? 0 : rangeInfo.getLineOffset(); this.endLineRangeInfo_ = rangeInfo; }; /** * @return {boolean} */ pwk.Range.prototype.isCollapsed = function() { return this.startLine_ === this.endLine_ &amp;&amp; this.startNodeOffset_ === this.endNodeOffset_; }; /** * @return {boolean} Whether the selection is reversed. */ pwk.Range.prototype.isReversed = function() { if (this.startLine_ === this.endLine_) { // if it's selection inside one line return this.startNodeOffset_ &gt; this.endNodeOffset_; } else if (this.startNode_ === this.endNode_) { return this.startLine_.getIndex() &gt; this.endLine_.getIndex(); } else { return this.startNode_.getIndex() &gt; this.endNode_.getIndex(); } }; /** * Collapses the range to one of its boundary points. * @param {boolean} toStart Whether to collapse. */ pwk.Range.prototype.collapse = function(toStart) { toStart = !!(toStart ^ this.isReversed()); if (toStart) { this.setEndPosition(this.startLine_, this.startNodeOffset_); } else { this.setStartPosition(this.endLine_, this.endNodeOffset_); } }; /** * @param {pwk.Line} startLine * @param {number} startNodeOffset * @param {pwk.Line} endLine * @param {number} endNodeOffset * @param {boolean=} opt_isStartOfStartLine * @param {boolean=} opt_isStartOfEndLine * * @return {pwk.Range} */ pwk.Range.createFromNodes = function(startLine, startNodeOffset, endLine, endNodeOffset, opt_isStartOfStartLine, opt_isStartOfEndLine) { return new pwk.Range(startLine, startNodeOffset, endLine, endNodeOffset, opt_isStartOfStartLine, opt_isStartOfEndLine); }; /** * @param {pwk.Range} range1 * @param {pwk.Range} range2 * @return {boolean} */ pwk.Range.equal = function(range1, range2) { return ( range1.getStartLine() == range2.getStartLine() &amp;&amp; range1.getStartNodeOffset() == range2.getStartNodeOffset() &amp;&amp; range1.getEndLine() == range2.getEndLine() &amp;&amp; range1.getEndNodeOffset() == range2.getEndNodeOffset() &amp;&amp; range1.isStartOfStartLine() == range2.isStartOfStartLine() &amp;&amp; range1.isStartOfEndLine() == range2.isStartOfEndLine() ); }; × Search results Close "},"pwk_editor_layer_ruler.js.html":{"id":"pwk_editor_layer_ruler.js.html","title":"Source: pwk/editor/layer/ruler.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/layer/ruler.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Allows the user to set the margin and padding of document (for * all pages) and nodes. All document settings stored in pwk.PageSettings. All * settings specific to the node, stored inside it. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Ruler'); goog.require('goog.ui.Component'); /** * @constructor * @extends {goog.ui.Component} */ pwk.Ruler = function() { goog.base(this); }; goog.inherits(pwk.Ruler, goog.ui.Component); × Search results Close "},"pwk_editor_selection.js.html":{"id":"pwk_editor_selection.js.html","title":"Source: pwk/editor/selection.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/selection.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Represents a selected area of the document. * Contains the cursor position and the text selection of an edit session. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Selection'); goog.require('goog.dom.classlist'); goog.require('goog.events.EventTarget'); goog.require('goog.fx.dom'); goog.require('goog.fx.easing'); goog.require('pwk.layer.Caret'); /** * @param {pwk.Document} doc * @extends {goog.events.EventTarget} * @constructor */ pwk.Selection = function(doc) { goog.events.EventTarget.call(this); /** * Document of current edit session. * @type {pwk.Document} * @private */ this.document_ = doc; /** * @type {pwk.Range} * @private */ this.range_; /** * Caret * @type {pwk.layer.Caret} * @private */ this.caret_ = new pwk.layer.Caret(this.document_.getDomHelper()); /** * @type {goog.math.Rect} * @private */ this.lastModifiedBounds_; /** * @type {pwk.Range} * @private */ this.lastModifiedRange_; /** * @type {?pwk.Selection.CaretDirection} * @private */ this.lastModifiedBoundsDirection_; /** * @type {?pwk.Selection.CaretDirection} * @private */ this.lastBoundsDirection_; /** * @type {Element} * @private */ this.containerElement_; /** * @type {number} * @private */ this.scrollToTasksCount_ = 0; /** * @type {goog.fx.dom.Scroll} * @private */ this.scrollToRangePositionScrollInstance_; }; goog.inherits(pwk.Selection, goog.events.EventTarget); /** * Initialize selection for document. */ pwk.Selection.prototype.initialize = function() { var caret = this.caret_; this.document_.addChild(caret, true); caret.show(); caret.listen(pwk.layer.Caret.EventType.BEFORE_UPDATE, this.caretBeforeUpdate_, false, this); caret.listen(pwk.layer.Caret.EventType.AFTER_UPDATE, this.caretAfterUpdate_, false, this); this.containerElement_ = goog.dom.getElementByClass(pwk.EditorContainer.CSS_CLASS); }; /** * @param {goog.events.Event} e Event object. * @private */ pwk.Selection.prototype.caretBeforeUpdate_ = function(e) { }; /** * @param {pwk.layer.Caret.AfterUpdateEvent} e Event object. * @private */ pwk.Selection.prototype.caretAfterUpdate_ = function(e) { if (!goog.isDefAndNotNull(this.lastModifiedBounds_) || this.lastBoundsDirection_ != pwk.Selection.CaretDirection.DOWN &amp;&amp; this.lastBoundsDirection_ != pwk.Selection.CaretDirection.UP) { this.lastBounds_ = e.getBounds(); this.lastModifiedBounds_ = this.lastBounds_; this.lastModifiedRange_ = /** @type {pwk.Range} */(goog.object.clone(this.range_)); } this.scrollToRangePosition(true); }; /** * Get document caret instance * @return {pwk.layer.Caret} */ pwk.Selection.prototype.getCaret = function() { return this.caret_; }; /** * Scroll to range position * @param {boolean=} opt_isIncreaseTask */ pwk.Selection.prototype.scrollToRangePosition = function(opt_isIncreaseTask) { if (opt_isIncreaseTask === true) { this.scrollToTasksCount_++; } if (this.scrollToTasksCount_ &gt; 0) { var scroll = this.scrollToRangePositionScrollInstance_; if (scroll == null || scroll.isStopped()) { this.scrollToTasksCount_--; var range = this.range_, element; if (range.isCollapsed()) { element = this.caret_.getElement(); } else { element = range.getEndLine().getElement(); } var googStyle = goog.style, container = this.containerElement_, containerHeight = googStyle.getSize(container).height, elementHeight = googStyle.getSize(element).height, y = googStyle.getContainerOffsetToScrollInto(element, container).y, caretClientPosition = googStyle.getClientPosition(element), isTop = false, isBottom = false; if (caretClientPosition.y &lt; 0) { isTop = true; } else if (caretClientPosition.y + elementHeight &gt; containerHeight) { isBottom = true; } if (isTop || isBottom) { scroll = new goog.fx.dom.Scroll(container, [0, container.scrollTop], [0, isTop ? y - 60 - elementHeight : y + 60 + elementHeight], 120, goog.fx.easing.easeOut); this.scrollToRangePositionScrollInstance_ = scroll; scroll.listen(goog.fx.Transition.EventType.END, goog.bind(this.scrollToRangePosition, this, false)); scroll.play(); } else { this.scrollToRangePosition(false); } } } }; /** * Update caret from range. * @param {pwk.Range=} opt_range */ pwk.Selection.prototype.updateCaretFromRange = function(opt_range) { if (goog.isDefAndNotNull(opt_range)) { this.range_ = opt_range; } if (goog.isDefAndNotNull(this.range_)) { if (this.range_.isCollapsed()) { this.lastBoundsDirection_ = null; this.lastModifiedBoundsDirection_ = null; this.caret_.show(); this.caret_.update(this); } else { this.updateSelectionFromRange(opt_range); } } }; /** * Update selection from range. * @param {pwk.Range=} opt_range */ pwk.Selection.prototype.updateSelectionFromRange = function(opt_range) { // TODO: Call select() method for required nodes and pass proper parameters if (goog.isDefAndNotNull(opt_range)) { this.range_ = opt_range; } }; /** * Get current range * @return {pwk.Range} */ pwk.Selection.prototype.getRange = function() { return this.range_; }; /** * Set range * @param {pwk.Range} range */ pwk.Selection.prototype.setRange = function(range) { this.range_ = range; }; /** * Move caret left */ pwk.Selection.prototype.moveCaretLeft = function() { let range = this.range_; this.removeSelection(); if (range.isCollapsed()) { var startNodeOffset = range.getStartNodeOffset(); if (startNodeOffset == 0) { // Move to node above var editorDoc = this.document_, startNodeIndex = editorDoc.indexOfNode(range.getStartNode()), prevNode = /** @type {pwk.LeafNode} */ (editorDoc.getNodeAt(startNodeIndex - 1)); // If node above exist, then move to the end of the last line if (goog.isDefAndNotNull(prevNode)) { var line = prevNode.getLastLine(), nodeLength = prevNode.getLength(); range.setStartPosition(line, nodeLength); range.setEndPosition(line, nodeLength); } } else { // Move cursor left inside node var newOffset = (startNodeOffset - 1), rangeInfo = range.getStartNode().getRangeInfoForOffset(newOffset); // Move to the first position if (range.getStartLine() != rangeInfo.getLine() &amp;&amp; rangeInfo.isEndOfLine) { range.setStartPosition(range.getStartLine(), newOffset, true); range.setEndPosition(range.getStartLine(), newOffset, true); } else { range.setStartPosition(rangeInfo.getLine(), newOffset); range.setEndPosition(rangeInfo.getLine(), newOffset); } } } else { range.collapse(true); } this.updateCaretFromRange(); this.lastBoundsDirection_ = pwk.Selection.CaretDirection.LEFT; this.lastModifiedBoundsDirection_ = pwk.Selection.CaretDirection.LEFT; }; /** * Move caret right. * @param {boolean=} opt_isTyping If this flag is set, then caret didn't be * moved to the first line position when line changed. */ pwk.Selection.prototype.moveCaretRight = function(opt_isTyping) { var range = this.range_; this.removeSelection(); if (range.isCollapsed()) { var startOffset = range.getStartNodeOffset(), rangeStartNode = range.getStartNode(), newPositionRangeInfo = rangeStartNode.getRangeInfoForOffset(startOffset + 1), newPositionLinkedRangeInfo = rangeStartNode.getRangeInfoByLinkedNodesOffset( range.getEndLineRangeInfo().getLinkedNodeOffset() + 1), editorDoc = this.document_; // Move to node below if (newPositionRangeInfo == null &amp;&amp; newPositionLinkedRangeInfo == null) { var startNodeIndex = editorDoc.indexOfNode(range.getStartNode()), node = editorDoc.getNodeAt(startNodeIndex + 1); if (goog.isDefAndNotNull(node)) { var firstLine = node.getFirstLine(); range.setStartPosition(firstLine, 0); range.setEndPosition(firstLine, 0); } } else { // Move to the right inside current node if (newPositionRangeInfo != null) { // Line changed and cursor has moved from last position of line above. if (range.getStartLine() != newPositionRangeInfo.getLine() &amp;&amp; range.getStartLineRangeInfo().isEndOfLine &amp;&amp; newPositionRangeInfo.getLineOffset() == 1 &amp;&amp; !goog.isDefAndNotNull(opt_isTyping)) { // Move caret to the start of line range.setStartPosition(newPositionRangeInfo.getLine(), startOffset, true); range.setEndPosition(newPositionRangeInfo.getLine(), startOffset, true); } else { range.setStartPosition(newPositionLinkedRangeInfo.getLine(), newPositionLinkedRangeInfo.getNodeOffset()); range.setEndPosition(newPositionLinkedRangeInfo.getLine(), newPositionLinkedRangeInfo.getNodeOffset()); } } else if (newPositionLinkedRangeInfo != null) { let isStartOfLIne = !opt_isTyping; let offset = newPositionLinkedRangeInfo.getNodeOffset() - Number(opt_isTyping); range.setStartPosition(newPositionLinkedRangeInfo.getLine(), offset, isStartOfLIne); range.setEndPosition(newPositionLinkedRangeInfo.getLine(), offset, isStartOfLIne); } } } else { range.collapse(false); } this.updateCaretFromRange(); this.lastBoundsDirection_ = pwk.Selection.CaretDirection.RIGHT; this.lastModifiedBoundsDirection_ = pwk.Selection.CaretDirection.RIGHT; }; /** * Move caret to end of current line */ pwk.Selection.prototype.moveCaretLineEnd = function() { var range = this.range_; this.removeSelection(); if (!range.isCollapsed()) { range.collapse(false); } var line = range.getStartLine(), newOffset = line.getParentNode().getOffsetByLineOffset(line, line.getLength()); range.setStartPosition(range.getStartLine(), newOffset); range.setEndPosition(range.getStartLine(), newOffset); this.updateCaretFromRange(); this.lastBoundsDirection_ = pwk.Selection.CaretDirection.END; this.lastModifiedBoundsDirection_ = pwk.Selection.CaretDirection.END; }; /** * Move caret to start of current line */ pwk.Selection.prototype.moveCaretLineStart = function() { var range = this.range_; this.removeSelection(); if (!range.isCollapsed()) { range.collapse(true); } var newOffset = range.getStartNodeOffset() - range.getStartLineOffset(); range.setStartPosition(range.getStartLine(), newOffset, true); range.setEndPosition(range.getEndLine(), newOffset, true); this.updateCaretFromRange(); this.lastBoundsDirection_ = pwk.Selection.CaretDirection.HOME; this.lastModifiedBoundsDirection_ = pwk.Selection.CaretDirection.HOME; }; /** * Move caret up. */ pwk.Selection.prototype.moveCaretUp = function() { var range = this.range_; this.removeSelection(); if (!range.isCollapsed()) { range.collapse(true); this.updateCaretFromRange(); } var editorDoc = this.document_, startLine = range.getStartLine(), startNode = range.getStartNode(), startLineIndex = startNode.indexOfLine(startLine), line, newPositionOffset, lineParentNode; // Looking for line above if (startLineIndex &gt; 0) { line = startNode.getLineAt(startLineIndex - 1); } else { var startNodeIndex = editorDoc.indexOfNode(startNode); lineParentNode = editorDoc.getNodeAt(startNodeIndex - 1); if (goog.isDefAndNotNull(lineParentNode)) { line = lineParentNode.getLastLine(); } } // If line exist, moving caret on it if (goog.isDefAndNotNull(line)) { // If line above is exist lineParentNode = lineParentNode || line.getParentNode(); // If current position is start of line if (this.lastModifiedRange_.getStartLineOffset() == 0) { newPositionOffset = lineParentNode.getOffsetByLineOffset(line, 0); range.setStartPosition(line, newPositionOffset, true); range.setEndPosition(line, newPositionOffset, true); // If last direction was to the end of line } else if (this.lastModifiedBoundsDirection_ == pwk.Selection.CaretDirection.END) { newPositionOffset = lineParentNode.getOffsetByLineOffset(line, line.getLength()); range.setStartPosition(line, newPositionOffset); range.setEndPosition(line, newPositionOffset); // Navigating caret to the line above to the same coordinates or nearest } else { var lineLength = line.getLength(), lastModifiedStartLineOffset = this.lastModifiedRange_.getStartLineOffset(), initialOffset = lastModifiedStartLineOffset &gt; lineLength ? lineLength : lastModifiedStartLineOffset, lineRange; newPositionOffset = lineParentNode.getOffsetByLineOffset(line, initialOffset); if (lastModifiedStartLineOffset == 0 &amp;&amp; lastModifiedStartLineOffset &lt; lineLength) { lineRange = pwk.Range.createFromNodes(line, newPositionOffset, line, newPositionOffset, true, true); } else { lineRange = pwk.Range.createFromNodes(line, newPositionOffset, line, newPositionOffset); } var prevNodeOffsetX = this.lastModifiedBounds_.left, lineBounds = this.getBoundsForRange(lineRange), lineOffsetX = lineBounds.left, isStartOfLine = false, isUseLastOffset = false, prevLoopBoundsLeft; if (lineOffsetX &gt; prevNodeOffsetX) { // If offset above is longer do { prevLoopBoundsLeft = lineBounds.left; newPositionOffset = lineRange.getStartNodeOffset() - 1; isStartOfLine = (lineRange.getStartLineOffset() - 1) == 0; lineRange.setStartPosition(line, newPositionOffset, isStartOfLine); lineRange.setEndPosition(line, newPositionOffset, isStartOfLine); lineBounds = this.getBoundsForRange(lineRange); lineOffsetX = lineBounds.left; } while (lineOffsetX &gt; prevNodeOffsetX); isUseLastOffset = !(Math.abs(prevNodeOffsetX - lineOffsetX) &gt; Math.abs(prevNodeOffsetX - prevLoopBoundsLeft)); newPositionOffset = isUseLastOffset ? lineRange.getStartNodeOffset() : lineRange.getStartNodeOffset() + 1; } else if (lineOffsetX &lt; prevNodeOffsetX) { // If offset above is less do { prevLoopBoundsLeft = lineBounds.left; if (lineLength === lineRange.getStartLineOffset()) { break; } // Last word? Exit from loop newPositionOffset = lineRange.getStartNodeOffset() + 1; lineRange.setStartPosition(line, newPositionOffset); lineRange.setEndPosition(line, newPositionOffset); lineBounds = this.getBoundsForRange(lineRange); lineOffsetX = lineBounds.left; } while (lineOffsetX &lt; prevNodeOffsetX); isUseLastOffset = !(Math.abs(prevNodeOffsetX - lineOffsetX) &gt; Math.abs(prevNodeOffsetX - prevLoopBoundsLeft)); newPositionOffset = isUseLastOffset ? lineRange.getStartNodeOffset() : lineRange.getStartNodeOffset() - 1; } range.setStartPosition(line, newPositionOffset, isStartOfLine &amp;&amp; isUseLastOffset); range.setEndPosition(line, newPositionOffset, isStartOfLine &amp;&amp; isUseLastOffset); } } this.lastBoundsDirection_ = pwk.Selection.CaretDirection.UP; this.caret_.show(); this.caret_.update(this); }; /** * Move caret down */ pwk.Selection.prototype.moveCaretDown = function() { var range = this.range_; this.removeSelection(); if (!range.isCollapsed()) { range.collapse(false); this.updateCaretFromRange(); } var editorDoc = this.document_, startLine = range.getStartLine(), startNode = range.getStartNode(), startLineIndex = startNode.indexOfLine(startLine), line = startNode.getLineAt(startLineIndex + 1), newPositionOffset, lineParentNode; // If line below in the current node does not exist, then looking for line in // node below if (!goog.isDefAndNotNull(line)) { var startNodeIndex = editorDoc.indexOfNode(startNode); lineParentNode = editorDoc.getNodeAt(startNodeIndex + 1); if (goog.isDefAndNotNull(lineParentNode)) { line = lineParentNode.getFirstLine(); } } // If line below exist if (goog.isDefAndNotNull(line)) { var lastModifiedRange = this.lastModifiedRange_; lineParentNode = lineParentNode || line.getParentNode(); // If current position is start of line if (lastModifiedRange.getStartLineOffset() == 0) { newPositionOffset = lineParentNode.getOffsetByLineOffset(line, 0); range.setStartPosition(line, newPositionOffset, true); range.setEndPosition(line, newPositionOffset, true); // If last direction was to the end of line } else if (this.lastModifiedBoundsDirection_ == pwk.Selection.CaretDirection.END) { newPositionOffset = lineParentNode.getOffsetByLineOffset(line, line.getLength()); range.setStartPosition(line, newPositionOffset); range.setEndPosition(line, newPositionOffset); // Navigating caret to the line below to the same coordinates or nearest } else { var lineLength = line.getLength(), lastModifiedStartLineOffset = lastModifiedRange.getStartLineOffset(), initialOffset = lastModifiedStartLineOffset &gt; lineLength ? lineLength : lastModifiedStartLineOffset, lineRange; newPositionOffset = lineParentNode.getOffsetByLineOffset(line, initialOffset); if (lastModifiedStartLineOffset == 0 &amp;&amp; lastModifiedStartLineOffset &lt; lineLength) { lineRange = pwk.Range.createFromNodes(line, newPositionOffset, line, newPositionOffset, true, true); } else { lineRange = pwk.Range.createFromNodes(line, newPositionOffset, line, newPositionOffset); } var prevNodeOffsetX = this.lastModifiedBounds_.left, lineBounds = this.getBoundsForRange(lineRange), lineOffsetX = lineBounds.left, isStartOfLine = false, isUseLastOffset = false, prevLoopBoundsLeft; if (lineOffsetX &gt; prevNodeOffsetX) { // If offset below is longer do { prevLoopBoundsLeft = lineBounds.left; newPositionOffset = lineRange.getStartNodeOffset() - 1; isStartOfLine = (lineRange.getStartLineOffset() - 1) == 0; lineRange.setStartPosition(line, newPositionOffset, isStartOfLine); lineRange.setEndPosition(line, newPositionOffset, isStartOfLine); lineBounds = this.getBoundsForRange(lineRange); lineOffsetX = lineBounds.left; } while (lineOffsetX &gt; prevNodeOffsetX); isUseLastOffset = !(Math.abs(prevNodeOffsetX - lineOffsetX) &gt; Math.abs(prevNodeOffsetX - prevLoopBoundsLeft)); newPositionOffset = isUseLastOffset ? lineRange.getStartNodeOffset() : lineRange.getStartNodeOffset() + 1; } else if (lineOffsetX &lt; prevNodeOffsetX) { // If offset above is less do { prevLoopBoundsLeft = lineBounds.left; if (lineLength === lineRange.getStartLineOffset()) { break; } // Last word? Exit from loop newPositionOffset = lineRange.getStartNodeOffset() + 1; lineRange.setStartPosition(line, newPositionOffset); lineRange.setEndPosition(line, newPositionOffset); lineBounds = this.getBoundsForRange(lineRange); lineOffsetX = lineBounds.left; } while (lineOffsetX &lt; prevNodeOffsetX); isUseLastOffset = !(Math.abs(prevNodeOffsetX - lineOffsetX) &gt; Math.abs(prevNodeOffsetX - prevLoopBoundsLeft)); newPositionOffset = isUseLastOffset ? lineRange.getStartNodeOffset() : lineRange.getStartNodeOffset() - 1; } range.setStartPosition(line, newPositionOffset, isStartOfLine &amp;&amp; isUseLastOffset); range.setEndPosition(line, newPositionOffset, isStartOfLine &amp;&amp; isUseLastOffset); } } this.lastBoundsDirection_ = pwk.Selection.CaretDirection.DOWN; this.caret_.show(); this.caret_.update(this); }; /** * Returns a bounding rectangle for a given range in document space. * @param {pwk.Range=} opt_range * @param {{boundingHeight: boolean, boundingWidth: boolean, boundingLeft: boolean, boundingTop: boolean}=} opt_disable_for_ie It's could increase performance in IE * @return {goog.math.Rect} */ pwk.Selection.prototype.getBoundsForRange = function(opt_range, opt_disable_for_ie) { // TODO: Required to improve performance in this place. It's very critical!!!! If it's possible var range = opt_range || this.range_, bounds = new goog.math.Rect(0, 0, 0, 0); if (range.isCollapsed()) { var googStyle = goog.style, googDom = goog.dom, pwkUtilsDom = pwk.utils.dom, startLineContent = range.getStartLine().getContent(), startNodeContentEl = startLineContent.getElement(), startNodeLength = startLineContent.getNormalizedText().length, documentElement = this.document_.getElement(), documentClientPosition = googStyle.getClientPosition(documentElement), startLineOffset = range.getStartLineOffset(), endLineOffset = range.getEndLineOffset(), endNodeContentEl = range.getEndLine().getContent().getElement(), boundingHeight, boundingWidth, boundingLeft, boundingTop, gRange; // Detect Internet Explorer if (goog.userAgent.IE) { var textRange = document.body.createTextRange(), browserZoomLevel = (!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./)) ? 1 : screen.deviceXDPI / screen.logicalXDPI, isExclude = opt_disable_for_ie != null ? opt_disable_for_ie : { boundingHeight: false, boundingWidth: false, boundingLeft: false, boundingTop: false }; if (startNodeLength == 0) { startNodeContentEl.innerHTML = '&amp;#8203;'; textRange.moveToElementText(startNodeContentEl); textRange.moveStart('character', startLineOffset); textRange.collapse(); textRange.moveEnd('character', 1); boundingHeight = isExclude.boundingHeight ? 0 : textRange.boundingHeight / browserZoomLevel; boundingWidth = isExclude.boundingWidth ? 0 : textRange.boundingWidth / browserZoomLevel; boundingLeft = isExclude.boundingLeft ? 0 : textRange.boundingLeft / browserZoomLevel; boundingTop = isExclude.boundingTop ? 0 : textRange.boundingTop / browserZoomLevel; startNodeContentEl.innerHTML = ''; } else { textRange.moveToElementText(startNodeContentEl); textRange.moveStart('character', (endLineOffset == 0 ? startLineOffset : startLineOffset - 1)); textRange.collapse(); textRange.moveEnd('character', 1); boundingHeight = isExclude.boundingHeight ? 0 : textRange.boundingHeight / browserZoomLevel; boundingWidth = isExclude.boundingWidth ? 0 : textRange.boundingWidth / browserZoomLevel; boundingLeft = isExclude.boundingLeft ? 0 : textRange.boundingLeft / browserZoomLevel; boundingTop = isExclude.boundingTop ? 0 : textRange.boundingTop / browserZoomLevel; } bounds.left = boundingLeft - documentClientPosition.x + (range.getEndLineOffset() == 0 ? 0 : boundingWidth) - 0.6; bounds.top = boundingTop - documentClientPosition.y; bounds.width = boundingWidth; bounds.height = boundingHeight; } else if (goog.userAgent.GECKO || goog.userAgent.WEBKIT) { // For GECKO and WebKit based browsers gRange = document.createRange(); if (startNodeLength == 0) { endNodeContentEl.innerHTML = '\\u0020'; } gRange.selectNodeContents(endNodeContentEl); gRange.setStart(endNodeContentEl, (endLineOffset == 0 ? startLineOffset : startLineOffset - 1)); gRange.setEnd(endNodeContentEl, (endLineOffset == 0 ? 1 : endLineOffset)); var boundsClientRect = gRange.getBoundingClientRect(); if (startNodeLength == 0) { endNodeContentEl.innerHTML = ''; } bounds.left = boundsClientRect.left - documentClientPosition.x + (range.getEndLineOffset() == 0 ? 0 : boundsClientRect.width) - 0.6; bounds.top = boundsClientRect.top - documentClientPosition.y; bounds.width = boundsClientRect.width; bounds.height = boundsClientRect.height; } else { // For other browsers var startMarker, endMarker, startMarkerClientPosition, endMarkerClientPosition; if (startNodeLength == 0) { startNodeContentEl.innerHTML = '\\u0020'; } if (range.getStartLineOffset() == 0) { gRange = googDom.Range.createFromNodes(startNodeContentEl, 0, endNodeContentEl, 0); } else { gRange = googDom.Range.createFromNodes(startNodeContentEl, range.getStartLineOffset() - 1, endNodeContentEl, range.getEndLineOffset()); } // Create markers startMarker = pwkUtilsDom.createDummyNode(); endMarker = pwkUtilsDom.createDummyNode(); gRange.surroundWithNodes(startMarker, endMarker); startMarkerClientPosition = googStyle.getClientPosition(startMarker); endMarkerClientPosition = googStyle.getClientPosition(endMarker); bounds.left = endMarkerClientPosition.x - documentClientPosition.x - 0.75; bounds.top = endMarkerClientPosition.y - documentClientPosition.y; bounds.width = bounds.left - (startMarkerClientPosition.x - documentClientPosition.x); bounds.height = startNodeContentEl.offsetHeight; if (startNodeLength == 0) { startNodeContentEl.innerHTML = ''; } else { startMarker.parentNode.removeChild(startMarker); endMarker.parentNode.removeChild(endMarker); } } } else { } return bounds; }; /** * @param {number} x * @param {number} y * @return {pwk.Range} */ pwk.Selection.prototype.getSelectionRangeFromPoint = function(x, y) { // NOTE: To calculate proper position for selection/caret I decided use document.elementFromPoint for all browsers. // Supported by all required browsers. For more information http://www.quirksmode.org/dom/w3c_cssom.html var doc = this.document_, lineElement = this.getClosestLineElementToOffset_(x, y), nodeElement = goog.dom.getParentElement(lineElement), line = /** @type {pwk.Line} */(doc.getNode(nodeElement.id).getChild(lineElement.id)), range = this.getLineRangeFromPoint_(line, x); return range; }; /** * @param {pwk.Line} line * @param {number} x * @return {pwk.Range} * @private */ pwk.Selection.prototype.getLineRangeFromPoint_ = function(line, x) { // TODO: Optimization required! Add ability to detect from which side of line required to start the loop var node = line.getParentNode(), nodeOffset = node.getOffsetByLineOffset(line, 0), lineLength = line.getLength(), documentElement = this.document_.getElement(), documentClientPosition = goog.style.getClientPosition(documentElement), range = pwk.Range.createFromNodes(line, nodeOffset, line, nodeOffset, true, false), loopRange, rangeInfo, closest, biggerCount = 0; for (var i = 0; i &lt;= lineLength; i++) { rangeInfo = node.getRangeInfoForOffset(nodeOffset + i); if (line != rangeInfo.getLine()) { loopRange = pwk.Range.createFromNodes(line, nodeOffset + i, line, nodeOffset + i, true, true); } else { loopRange = pwk.Range.createFromNodes(line, nodeOffset + i, line, nodeOffset + i, rangeInfo.getLineOffset() == 0, false); } var excludeParametersForIe = { boundingHeight: true, boundingWidth: false, boundingLeft: false, boundingTop: true } , bounds = this.getBoundsForRange(loopRange, excludeParametersForIe), distance = bounds.left + documentClientPosition.x + 0.75; if (closest == null || Math.abs(distance - x) &lt; Math.abs(closest - x)) { closest = distance; range = loopRange; } if (distance &gt; closest) { biggerCount++; } if (biggerCount &gt; 1) { break; } } return range; }; /** * @param {number} x * @param {number} y * @return {Element} line element * @private */ pwk.Selection.prototype.getClosestLineElementToOffset_ = function(x, y) { // TODO: Optimisation required, but maybe it can be stay as is. Double check required var googDomClasses = goog.dom.classlist, googDom = goog.dom, googStyle = goog.style, receiver = document.elementFromPoint(x, y &lt; 0 ? 0 : y), lineCssClass = pwk.Line.CSS_CLASS, el = null, parentElement, childElements = [], l; if (googDomClasses.contains(receiver, pwk.LineContent.CSS_CLASS)) { return googDom.getParentElement(receiver); } else if (googDomClasses.contains(receiver, pwk.Editor.CSS_CLASS)) { var viewPortSize = googDom.getViewportSize(); receiver = document.elementFromPoint(viewPortSize.width / 2, y); } else if (googDomClasses.contains(receiver, pwk.Document.CSS_CLASS)) { // Between pages receiver = document.elementFromPoint(x, y - 15); if (receiver != null) { parentElement = googDom.getAncestorByClass(receiver, pwk.Page.CSS_CLASS); childElements = googDom.getElementsByClass(lineCssClass, parentElement); } receiver = document.elementFromPoint(x, y + 15); if (receiver != null) { var googArray = goog.array; parentElement = googDom.getAncestorByClass(receiver, pwk.Page.CSS_CLASS); childElements = googArray.concat(googArray.toArray(childElements), googArray.toArray(googDom.getElementsByClass(lineCssClass, parentElement))); } } l = childElements.length; if (parentElement == null &amp;&amp; l == 0) { parentElement = googDom.getAncestorByClass(receiver, pwk.Page.CSS_CLASS); childElements = googDom.getElementsByClass(lineCssClass, parentElement); l = childElements.length; } for (var i = 0; i &lt; l; i++) { if (i in childElements) { var item = childElements[i]; var elBounds = googStyle.getBounds(item).toBox(), distance, dx, dy, minDistance; if ((x &gt;= elBounds.left) &amp;&amp; (x &lt;= elBounds.right) &amp;&amp; (y &gt;= elBounds.top) &amp;&amp; (y &lt;= elBounds.bottom)) { el = item; break; } var offsets = [[elBounds.left, elBounds.top], [elBounds.right, elBounds.top], [elBounds.left, elBounds.bottom], [elBounds.right, elBounds.bottom]]; goog.array.forEach(offsets, function(offset) { dx = offset[0] - x; dy = offset[1] - y; distance = Math.sqrt((dx * dx) + (dy * dy)); if (minDistance === undefined || distance &lt; minDistance) { minDistance = distance; el = item; } }, this); } } return el; }; /** * @param {pwk.Range=} opt_range */ pwk.Selection.prototype.selectDocument = function(opt_range) { var doc = this.document_, currentRange = this.range_; this.caret_.hide(); if (!opt_range) { var firstNode = doc.getNodeAt(0), firstLine = firstNode.getFirstLine(), lastNode = doc.getNodeAt(doc.getNodeCount() - 1), lastLine = lastNode.getLastLine(), nodesCount = doc.getNodeCount(); // Create range for all document if it is not passed opt_range = pwk.Range.createFromNodes(firstLine, 0, lastLine, lastNode.getLength(), true, false); for (var i = 0; i &lt; nodesCount; i++) { doc.getNodeAt(i).select(); } } else { if (pwk.Range.equal(opt_range, currentRange) &amp;&amp; !opt_range.isCollapsed()) { return; } // This is a very nice find, saves a lot of CPU resources var newStartNode = opt_range.getStartNode(), newEndNode = opt_range.getEndNode(), currentStartNode = currentRange.getStartNode(), currentEndNode = currentRange.getEndNode(), currentStartNodeIndex = doc.indexOfNode(currentStartNode), currentEndNodeIndex = doc.indexOfNode(currentEndNode), newStartNodeIndex = doc.indexOfNode(newStartNode), newEndNodeIndex = doc.indexOfNode(newEndNode), condition, startLine, endLine, endLineOffset, startLineOffset, nodeSelectionRange; if (currentStartNodeIndex == newStartNodeIndex &amp;&amp; currentEndNodeIndex == newEndNodeIndex) { // Reselect end node only condition = (newStartNode == newEndNode); if (opt_range.isReversed()) { endLine = condition ? opt_range.getStartLine() : newEndNode.getLastLine(); endLineOffset = condition ? opt_range.getStartLineOffset() : endLine.getLength(); nodeSelectionRange = new pwk.primitives.NodeSelectionRange(opt_range.getEndLine(), opt_range.getEndLineOffset(), endLine, endLineOffset); } else { startLine = condition ? opt_range.getStartLine() : newEndNode.getFirstLine(); startLineOffset = condition ? opt_range.getStartLineOffset() : 0; nodeSelectionRange = new pwk.primitives.NodeSelectionRange(startLine, startLineOffset, opt_range.getEndLine(), opt_range.getEndLineOffset()); } newEndNode.unselect(); newEndNode.select(nodeSelectionRange); } else if (currentStartNodeIndex == newStartNodeIndex &amp;&amp; currentStartNodeIndex &lt; newEndNodeIndex &amp;&amp; currentEndNodeIndex &lt; newEndNodeIndex) { // Add down for (var i = currentEndNodeIndex; i &lt;= newEndNodeIndex; i++) { switch (i) { case currentEndNodeIndex: // Reselect previous end node if (currentStartNodeIndex == currentEndNodeIndex) { nodeSelectionRange = new pwk.primitives.NodeSelectionRange(currentRange.getStartLine(), currentRange.getStartLineOffset(), currentEndNode.getLastLine(), currentEndNode.getLastLine().getLength()); } else { nodeSelectionRange = new pwk.primitives.NodeSelectionRange(currentEndNode.getFirstLine(), 0, currentEndNode.getLastLine(), currentEndNode.getLastLine().getLength()); } currentEndNode.select(nodeSelectionRange); break; case newEndNodeIndex: // Select end node nodeSelectionRange = new pwk.primitives.NodeSelectionRange(newEndNode.getFirstLine(), 0, opt_range.getEndLine(), opt_range.getEndLineOffset()); newEndNode.select(nodeSelectionRange); break; default: doc.getNodeAt(i).select(); } } } else if (currentStartNodeIndex == newStartNodeIndex &amp;&amp; currentStartNodeIndex &gt; newEndNodeIndex &amp;&amp; currentEndNodeIndex &gt; newEndNodeIndex) { // Add up. Keep in mind that this selection is reversed for (var i = currentEndNodeIndex; i &gt;= newEndNodeIndex; i--) { switch (i) { case currentEndNodeIndex: // Reselect previous end node if (currentStartNodeIndex == currentEndNodeIndex) { nodeSelectionRange = new pwk.primitives.NodeSelectionRange(currentEndNode.getFirstLine(), 0, currentRange.getStartLine(), currentRange.getStartLineOffset()); } else { nodeSelectionRange = new pwk.primitives.NodeSelectionRange(currentEndNode.getFirstLine(), 0, currentEndNode.getLastLine(), currentEndNode.getLastLine().getLength()); } currentEndNode.select(nodeSelectionRange); break; case newEndNodeIndex: // Select end node endLine = opt_range.getEndLine(); nodeSelectionRange = new pwk.primitives.NodeSelectionRange(endLine, opt_range.getEndLineOffset(), newEndNode.getLastLine(), newEndNode.getLastLine().getLength()); newEndNode.select(nodeSelectionRange); break; default: doc.getNodeAt(i).select(); } } } else if (currentStartNodeIndex == newStartNodeIndex &amp;&amp; currentStartNodeIndex &gt;= newEndNodeIndex &amp;&amp; currentEndNodeIndex &lt; newEndNodeIndex) { // Remove selection from node(s) above and reselect end node for (var i = currentEndNodeIndex; i &lt;= newEndNodeIndex; i++) { switch (i) { case newEndNodeIndex: condition = (newStartNode == newEndNode); endLine = condition ? opt_range.getStartLine() : newEndNode.getLastLine(); endLineOffset = condition ? opt_range.getStartLineOffset() : endLine.getLength(); nodeSelectionRange = new pwk.primitives.NodeSelectionRange(opt_range.getEndLine(), opt_range.getEndLineOffset(), endLine, endLineOffset); break; default: doc.getNodeAt(i).unselect(); } } } else if (currentStartNodeIndex == newStartNodeIndex &amp;&amp; currentStartNodeIndex &lt;= newEndNodeIndex &amp;&amp; currentEndNodeIndex &gt; newEndNodeIndex) { // Remove selection from node(s) below and reselect end node for (var i = currentEndNodeIndex; i &gt;= newEndNodeIndex; i--) { switch (i) { case newEndNodeIndex: condition = (newStartNode == newEndNode); startLine = condition ? opt_range.getStartLine() : newEndNode.getFirstLine(); startLineOffset = condition ? opt_range.getStartLineOffset() : 0; nodeSelectionRange = new pwk.primitives.NodeSelectionRange(startLine, startLineOffset, opt_range.getEndLine(), opt_range.getEndLineOffset()); break; default: doc.getNodeAt(i).unselect(); } } } } this.range_ = opt_range; if (opt_range.isCollapsed() &amp;&amp; opt_range.getStartLine().getLength() != 0) { this.updateCaretFromRange(); } else { this.lastBoundsDirection_ = null; this.lastModifiedBoundsDirection_ = null; } }; /** * Remove current document selection */ pwk.Selection.prototype.removeSelection = function() { var range = this.range_, startNode = range.getStartNode(), endNode = range.getEndNode(); if (startNode == endNode) { startNode.unselect(); } else { var doc = this.document_, isReversed = range.isReversed(), startNodeIndex = isReversed ? endNode.getIndex() : startNode.getIndex(), endNodeIndex = isReversed ? startNode.getIndex() : endNode.getIndex(), node; for (var i = startNodeIndex; i &lt;= endNodeIndex; i++) { node = /** @type {pwk.LeafNode} */(doc.getNodeAt(i)); node.unselect(); } } }; /** * @enum {number} */ pwk.Selection.CaretDirection = { LEFT: 1, RIGHT: 2, UP: 3, DOWN: 4, END: 5, HOME: 6 }; × Search results Close "},"pwk_editor_shortcuts.js.html":{"id":"pwk_editor_shortcuts.js.html","title":"Source: pwk/editor/shortcuts.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/shortcuts.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.Shortcuts.Default'); goog.provide('pwk.Shortcuts.MacOS'); goog.require('goog.events.KeyCodes'); goog.require('goog.ui.KeyboardShortcutHandler'); /** * Get command button for current OS * @type {goog.ui.KeyboardShortcutHandler.Modifiers} */ pwk.Shortcuts.CMD_BUTTON = (function() { if(goog.userAgent.MAC) { return goog.ui.KeyboardShortcutHandler.Modifiers.META; } else { return goog.ui.KeyboardShortcutHandler.Modifiers.CTRL; } })(); /** * Default editor shortcuts. * @enum {Array} */ pwk.Shortcuts.Default = { SAVE: ['Save', goog.events.KeyCodes.S, pwk.Shortcuts.CMD_BUTTON], SELECT_ALL: ['Select_All', goog.events.KeyCodes.A, pwk.Shortcuts.CMD_BUTTON] }; × Search results Close "},"pwk_editor_utils_dom.js.html":{"id":"pwk_editor_utils_dom.js.html","title":"Source: pwk/editor/utils/dom.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/utils/dom.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Utilities to manioulate with DOM * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.utils.dom'); /** * @return {Element} */ pwk.utils.dom.createDummyNode = function() { // Create marker return goog.dom.createDom('span', { 'id' : 'caret-marker' }, '\\u200B'); }; × Search results Close "},"pwk_editor_utils_style.js.html":{"id":"pwk_editor_utils_style.js.html","title":"Source: pwk/editor/utils/style.js","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Source: pwk/editor/utils/style.js // // Pubwebkit editor is powerful editor to create your ebook in various styles. // It's includes: Cover Designer, Template Editor, Community Snippets and more. // Also, it's a part of www.pubwebkit.com portal. // Copyright (C) 2016 Dmytro Antonenko // // This file is part of Pubwebkit editor // // Pubwebkit editor is free software: you can redistribute it and/or modify it // under the terms of the GNU Affero General Public License as published by the // Free Software Foundation, version 3 // // Pubwebkit editor is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or // FITNESS FOR A PARTICULAR PURPOSE. // // See the GNU Affero General Public License for more details. You should have // received a copy of the GNU General Public License along with Hatch.js. If // not, see &lt;http://www.gnu.org/licenses/&gt;. // // Authors: Dmytro Antonenko // /** * @fileoverview Utilities for element styles. * @author dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) */ goog.provide('pwk.utils.style'); goog.require('goog.style'); /** * Convert Points to Pixels * @param {string} pt * @return {string} */ pwk.utils.style.PointsToPixels = function(pt) { return pt.replace(/([0-9]+)pt/g, function(match, group0) { return Math.round(parseInt(group0, 10) * 96 / 72) + 'px'; }); }; × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Classes HelloController HomeController Core Application instance Controller ActionEvent ActionExceptionEvent Request Response Router ActionFilterContext ActionFilterItem ApplicationFilterItem BranchNode Document NodeRemovedEvent DocumentSettings Editor EditorContainer Caret AfterUpdateEvent SelectionOverlay LeafNode NodeContentChangedEvent Line LineContent LineOffsetInfo Node NodeAnnotation NodeAttribute Page PageOverflowEvent PageContent PageFooter PageHeader PageSettings Pagination ClientRectRange NodeSelectionRange Range Ruler Selection × Search results Close "},"interfaces.list.html":{"id":"interfaces.list.html","title":"Interfaces","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Classes HelloController HomeController Core Application instance Controller ActionEvent ActionExceptionEvent Request Response Router ActionFilterContext ActionFilterItem ApplicationFilterItem BranchNode Document NodeRemovedEvent DocumentSettings Editor EditorContainer Caret AfterUpdateEvent SelectionOverlay LeafNode NodeContentChangedEvent Line LineContent LineOffsetInfo Node NodeAnnotation NodeAttribute Page PageOverflowEvent PageContent PageFooter PageHeader PageSettings Pagination ClientRectRange NodeSelectionRange Range Ruler Selection × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter Pubwebkit editorPowerful editor to create your ebook in various styles. It's includes: Cover Designer, Template Editor, Community Snippets and more. Also, it's a part of www.pubwebkit.com portal. Initialize development enviroment: Run npm install from terminal to update all npm references Make sure you have installed Maven. Build Google Closure Compiler. Navigate to libs/closure-compiler/ folder and run command mvn -DskipTests. Build Google Closure Templates for javascript usage. Navigate to libs/closure-templates/ folder and run command mvn. Install Closure Linter from libs/closure-linter by next command python ./setup.py install. Make gjslint.py executable chmod +x libs/closure-linter/closure_linter/gjslint.py. Make gjslint.py executable chmod +x libs/closure-linter/closure_linter/fixjsstyle.py. Grunt taskTo automate the build, cleaning, code style checking is used Grunt tasks runner. Below list of the most important task that can used during development: grunt build - Compile JavaScript to better JavaScript by Google Closure Compiler, compile Less files to css and minimize. Compiled project will be placed to dist/ folder. grunt eslint - Check JavaScript files of the project by ESLint linting utility. grunt closureLint - Check JavaScript files for style issues by Google Closure Linter. grunt connect - Run local server with root project directory. Web server will be available by http://localhost:9000. grunt jsdoc - Generate JSDoc based documentation. All documentation available under documentation/ folder. If you will run local web server, then you can access documentation by http://localhost:9000/documentation. Supported Browsers: Internet Explorer 9+ Opera 12 (PC and Mac looks good) Chrome (21+) (Looks good, not tested on previous builds) Firefox (4+) app.js Main file to initialize and prepare Pwk.Editor Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: app.js, line 24 core/actionfilter.js The action filter is a class with specific events that you can apply to a controller action or an entire controller that modifies the way in which the action is executed. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/actionfilter.js, line 24 core/application.js Main application class. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/application.js, line 24 core/controller.js Base controller class. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/controller.js, line 24 core/core.js The core class of the application. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/core.js, line 24 core/exports.js Declare the public API. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/exports.js, line 24 core/router.js app.core.Router uses goog.History and hash tokens to hold and manage the state of the application. This class is modified mvc.Router class from PlastronJS library. Author: rhysbrettbowen@gmail.com (Rhys Brett-Bowen), dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: core/router.js, line 1 See: https://github.com/rhysbrettbowen/PlastronJS#mvcrouter pwk/editor/document.js Document contains all information about edited information and information itself, as child components. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/document.js, line 24 pwk/editor/documentsettings.js This class contains shared settings of document. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/documentsettings.js, line 24 pwk/editor/editor.js Rich Text Editor. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/editor.js, line 24 pwk/editor/layer/caret.js Component that represent caret in document Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/layer/caret.js, line 24 pwk/editor/layer/editorcontainer.js Editor components container Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/layer/editorcontainer.js, line 24 pwk/editor/layer/ruler.js Allows the user to set the margin and padding of document (for all pages) and nodes. All document settings stored in pwk.PageSettings. All settings specific to the node, stored inside it. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/layer/ruler.js, line 24 pwk/editor/layer/selectionoverlay.js Selection overview UI component. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/layer/selectionoverlay.js, line 24 pwk/editor/linerangeinfo.js Represent class to store line offset information. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/linerangeinfo.js, line 24 pwk/editor/nodeformatter.js This class uses for formatting nodes of various types. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodeformatter.js, line 24 pwk/editor/nodes/branchnode.js TODO: add description Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/branchnode.js, line 24 pwk/editor/nodes/leafnode.js TODO: add description Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/leafnode.js, line 24 pwk/editor/nodes/line.js Represents the line of node content. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/line.js, line 24 pwk/editor/nodes/linecontent.js Represents the content of line component. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/linecontent.js, line 24 pwk/editor/nodes/node.js Node represent a content element on the document. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/node.js, line 24 pwk/editor/nodes/nodeattribute.js Class represent node attribute. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/nodes/nodeattribute.js, line 24 pwk/editor/page.js Document page Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/page.js, line 24 pwk/editor/pagecontent.js Page content component. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/pagecontent.js, line 24 pwk/editor/pagefooter.js Represent footer of the page. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/pagefooter.js, line 24 pwk/editor/pageheader.js Page header component. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/pageheader.js, line 24 pwk/editor/pagesettings.js This class contains shared settings for document pages. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/pagesettings.js, line 24 pwk/editor/pagination.js Class with functionality of manipulation by pages of document. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/pagination.js, line 24 pwk/editor/primitives/clientrectrange.js TODO: add description Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/primitives/clientrectrange.js, line 24 pwk/editor/primitives/nodeselectionrange.js Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/primitives/nodeselectionrange.js, line 24 pwk/editor/range.js This object is used in various places to indicate a region within the editor. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/range.js, line 24 pwk/editor/selection.js Represents a selected area of the document. Contains the cursor position and the text selection of an edit session. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/selection.js, line 24 pwk/editor/utils/dom.js Utilities to manioulate with DOM Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/utils/dom.js, line 24 pwk/editor/utils/style.js Utilities for element styles. Author: dmitry.antonenko@pubwebkit.com (Dmytro Antonenko) Source: pwk/editor/utils/style.js, line 24 × Search results Close "},"app.controllers.HelloController.html":{"id":"app.controllers.HelloController.html","title":"Class: HelloController","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.controllers.HelloController new app.controllers.HelloController() Source: controllers/hellocontroller.js, line 36 Extends app.core.Controller Members &lt;private&gt; controllerName_ :string Type: string Inherited From: app.core.Controller#controllerName_ Source: core/controller.js, line 44 Methods app.controllers.HelloController#getControllerName() Get current controller name Inherited From: app.core.Controller#getControllerName Source: core/controller.js, line 52 Returns: Type string app.controllers.HelloController#index(request, response) index action Parameters: Name Type Description request app.core.Request response app.core.Response Source: controllers/hellocontroller.js, line 47 × Search results Close "},"app.controllers.HomeController.html":{"id":"app.controllers.HomeController.html","title":"Class: HomeController","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.controllers.HomeController new app.controllers.HomeController() Source: controllers/homecontroller.js, line 36 Extends app.core.Controller Members &lt;private&gt; controllerName_ :string Type: string Inherited From: app.core.Controller#controllerName_ Source: core/controller.js, line 44 Methods app.controllers.HomeController#getControllerName() Get current controller name Inherited From: app.core.Controller#getControllerName Source: core/controller.js, line 52 Returns: Type string app.controllers.HomeController#index(request, response) index action Parameters: Name Type Description request app.core.Request response app.core.Response Source: controllers/homecontroller.js, line 47 × Search results Close "},"app.Core.html":{"id":"app.Core.html","title":"Class: Core","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.Core new app.Core() The base class. This class will be exported as the main entry point. Source: core/core.js, line 45 Extends app.core.Application Members &lt;private&gt; actionFilters_ :Array.&lt;app.core.types.ActionFilterItem&gt; Type: Array.&lt;app.core.types.ActionFilterItem&gt; Inherited From: app.core.Application#actionFilters_ Source: core/application.js, line 71 &lt;private&gt; applicationFilters_ :Array.&lt;app.core.types.ApplicationFilterItem&gt; Type: Array.&lt;app.core.types.ApplicationFilterItem&gt; Inherited From: app.core.Application#applicationFilters_ Source: core/application.js, line 77 &lt;private&gt; currentRoute_ :RegExp The fragment we are mapping the controller to. Type: RegExp Inherited From: app.core.Application#currentRoute_ Source: core/application.js, line 84 &lt;private&gt; isFirstLoad_ :boolean Type: boolean Inherited From: app.core.Application#isFirstLoad_ Source: core/application.js, line 90 &lt;private&gt; router_ :app.core.Router Type: app.core.Router Inherited From: app.core.Application#router_ Source: core/application.js, line 65 Methods app.Core#addActionFilter(filter, opt_route [, opt_order]) Register action filter Parameters: Name Type Argument Description filter app.core.ActionFilter opt_route string | RegExp Route to watch for. opt_order number &lt;optional&gt; Inherited From: app.core.Application#addActionFilter Source: core/application.js, line 202 app.Core#addApplicationFilter(filter [, opt_order]) Register application filter Parameters: Name Type Argument Description filter app.core.ApplicationFilter opt_order number &lt;optional&gt; Inherited From: app.core.Application#addApplicationFilter Source: core/application.js, line 189 &lt;private&gt; app.Core#forEachActionFilter_(callback) Calls a function for each registered action filter, but skip filters with route that not match current route. Parameters: Name Type Description callback function Inherited From: app.core.Application#forEachActionFilter_ Source: core/application.js, line 342 &lt;private&gt; app.Core#forEachApplicationFilter_(callback) Calls a function for each registered application filter. Parameters: Name Type Description callback function Inherited From: app.core.Application#forEachApplicationFilter_ Source: core/application.js, line 329 app.Core#init() Kicks off the library. Source: core/core.js, line 54 app.Core#mapRoute(route, controller) Parameters: Name Type Description route string The path The fragment we are mapping the controller to. controller function The name or object that identifying the desired controller. Inherited From: app.core.Application#mapRoute Source: core/application.js, line 100 &lt;private&gt; app.Core#onActionException_(e) Called when an unhandled exception occurs in the action. Parameters: Name Type Description e app.core.events.ActionExceptionEvent Inherited From: app.core.Application#onActionException_ Source: core/application.js, line 279 &lt;private&gt; app.Core#onActionExecuted_(e) Called after the action method is invoked. Parameters: Name Type Description e app.core.events.ActionEvent Inherited From: app.core.Application#onActionExecuted_ Source: core/application.js, line 266 &lt;private&gt; app.Core#onActionExecuting_(e) Called before the action method is invoked. Parameters: Name Type Description e app.core.events.ActionEvent Inherited From: app.core.Application#onActionExecuting_ Source: core/application.js, line 253 &lt;private&gt; app.Core#onApplicationLoaded_(e) Called when an application launched. Parameters: Name Type Description e goog.events.Event Inherited From: app.core.Application#onApplicationLoaded_ Source: core/application.js, line 316 &lt;private&gt; app.Core#onApplicationRun_(e) Called when an application end initialization. Parameters: Name Type Description e goog.events.Event Inherited From: app.core.Application#onApplicationRun_ Source: core/application.js, line 304 &lt;private&gt; app.Core#onApplicationStart_(e) Called when an application start initialization. Parameters: Name Type Description e goog.events.Event Inherited From: app.core.Application#onApplicationStart_ Source: core/application.js, line 292 &lt;private&gt; app.Core#processRoute_(route, controller) Parameters: Name Type Description route string The fragment we are mapping the controller to. controller app.core.Controller Controller instance related to current route. Inherited From: app.core.Application#processRoute_ Source: core/application.js, line 113 app.Core#run() Start application execution Inherited From: app.core.Application#run Source: core/application.js, line 212 &lt;private&gt; app.Core#setCurrentRoute_(route) Parameters: Name Type Description route string Inherited From: app.core.Application#setCurrentRoute_ Source: core/application.js, line 359 × Search results Close "},"app.core.ActionFilter.html":{"id":"app.core.ActionFilter.html","title":"Interface: ActionFilter","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.ActionFilter Action filter. Source: core/actionfilter.js, line 39 Members getAction Action that will be processed by this filter. Source: core/actionfilter.js, line 53 getController Controller that will be processed by this filter. Source: core/actionfilter.js, line 46 onActionExecuted Called after the action method is invoked. Source: core/actionfilter.js, line 74 onActionExecuting Called before the action method is invoked. Source: core/actionfilter.js, line 67 onException Called when an unhandled exception occurs in the action. Source: core/actionfilter.js, line 60 × Search results Close "},"app.core.Application.html":{"id":"app.core.Application.html","title":"Class: Application","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.Application new app.core.Application() Source: core/application.js, line 48 Extends goog.events.EventTarget Members &lt;static&gt; EventType :string Type: string Properties: Name Type Default Description APPLICATIONSTART string APPLICATIONRUN string APPLICATIONLOADED string ACTIONEXCEPTION string ACTIONEXECUTING string ACTIONEXECUTED string Source: core/application.js, line 371 &lt;private&gt; actionFilters_ :Array.&lt;app.core.types.ActionFilterItem&gt; Type: Array.&lt;app.core.types.ActionFilterItem&gt; Source: core/application.js, line 71 &lt;private&gt; applicationFilters_ :Array.&lt;app.core.types.ApplicationFilterItem&gt; Type: Array.&lt;app.core.types.ApplicationFilterItem&gt; Source: core/application.js, line 77 &lt;private&gt; currentRoute_ :RegExp The fragment we are mapping the controller to. Type: RegExp Source: core/application.js, line 84 &lt;private&gt; isFirstLoad_ :boolean Type: boolean Source: core/application.js, line 90 &lt;private&gt; router_ :app.core.Router Type: app.core.Router Source: core/application.js, line 65 Methods app.core.Application#addActionFilter(filter, opt_route [, opt_order]) Register action filter Parameters: Name Type Argument Description filter app.core.ActionFilter opt_route string | RegExp Route to watch for. opt_order number &lt;optional&gt; Source: core/application.js, line 202 app.core.Application#addApplicationFilter(filter [, opt_order]) Register application filter Parameters: Name Type Argument Description filter app.core.ApplicationFilter opt_order number &lt;optional&gt; Source: core/application.js, line 189 &lt;private&gt; app.core.Application#forEachActionFilter_(callback) Calls a function for each registered action filter, but skip filters with route that not match current route. Parameters: Name Type Description callback function Source: core/application.js, line 342 &lt;private&gt; app.core.Application#forEachApplicationFilter_(callback) Calls a function for each registered application filter. Parameters: Name Type Description callback function Source: core/application.js, line 329 app.core.Application#mapRoute(route, controller) Parameters: Name Type Description route string The path The fragment we are mapping the controller to. controller function The name or object that identifying the desired controller. Source: core/application.js, line 100 &lt;private&gt; app.core.Application#onActionException_(e) Called when an unhandled exception occurs in the action. Parameters: Name Type Description e app.core.events.ActionExceptionEvent Source: core/application.js, line 279 &lt;private&gt; app.core.Application#onActionExecuted_(e) Called after the action method is invoked. Parameters: Name Type Description e app.core.events.ActionEvent Source: core/application.js, line 266 &lt;private&gt; app.core.Application#onActionExecuting_(e) Called before the action method is invoked. Parameters: Name Type Description e app.core.events.ActionEvent Source: core/application.js, line 253 &lt;private&gt; app.core.Application#onApplicationLoaded_(e) Called when an application launched. Parameters: Name Type Description e goog.events.Event Source: core/application.js, line 316 &lt;private&gt; app.core.Application#onApplicationRun_(e) Called when an application end initialization. Parameters: Name Type Description e goog.events.Event Source: core/application.js, line 304 &lt;private&gt; app.core.Application#onApplicationStart_(e) Called when an application start initialization. Parameters: Name Type Description e goog.events.Event Source: core/application.js, line 292 &lt;private&gt; app.core.Application#processRoute_(route, controller) Parameters: Name Type Description route string The fragment we are mapping the controller to. controller app.core.Controller Controller instance related to current route. Source: core/application.js, line 113 app.core.Application#run() Start application execution Source: core/application.js, line 212 &lt;private&gt; app.core.Application#setCurrentRoute_(route) Parameters: Name Type Description route string Source: core/application.js, line 359 × Search results Close "},"app.core.Application_processRoute_-instance.html":{"id":"app.core.Application_processRoute_-instance.html","title":"Class: instance","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter .Application#processRoute_~ app.core.Application#processRoute_~instance new app.core.Application#processRoute_~instance() Source: core/application.js, line 143 × Search results Close "},"app.core.ApplicationFilter.html":{"id":"app.core.ApplicationFilter.html","title":"Interface: ApplicationFilter","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.ApplicationFilter Application filter. Source: core/applicationfilter.js, line 32 Members onApplicationLoaded Called when an application launched. Source: core/applicationfilter.js, line 54 onApplicationRun Called when an application end initialization. Source: core/applicationfilter.js, line 47 onApplicationStart Called when an application start initialization. Source: core/applicationfilter.js, line 40 × Search results Close "},"app.core.Controller.html":{"id":"app.core.Controller.html","title":"Class: Controller","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.Controller new app.core.Controller(controllerName) Defines an abstract controller for handling requests to certain fragments. Parameters: Name Type Description controllerName string Current Source: core/controller.js, line 38 Members &lt;private&gt; controllerName_ :string Type: string Source: core/controller.js, line 44 Methods app.core.Controller#getControllerName() Get current controller name Source: core/controller.js, line 52 Returns: Type string × Search results Close "},"app.core.events.ActionEvent.html":{"id":"app.core.events.ActionEvent.html","title":"Class: ActionEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.events.ActionEvent new app.core.events.ActionEvent(actionFilterContext, type, resolve [, opt_target]) A base class for controller actions events. Parameters: Name Type Argument Description actionFilterContext app.core.types.ActionFilterContext Current filter context. type string | goog.events.EventId Event Type. resolve function Promise resolver function. opt_target Object &lt;optional&gt; Reference to the object that is the target of this event. It has to implement the {@code EventTarget} interface declared at http://developer.mozilla.org/en/DOM/EventTarget. Source: core/events/actionevent.js, line 43 Extends goog.events.Event Members &lt;private&gt; actionFilterContext_ :app.core.types.ActionFilterContext Type: app.core.types.ActionFilterContext Source: core/events/actionevent.js, line 51 &lt;private&gt; promiseResolve_ :function Type: function Source: core/events/actionevent.js, line 57 Methods app.core.events.ActionEvent#getContext() Source: core/events/actionevent.js, line 65 Returns: Type app.core.types.ActionFilterContext app.core.events.ActionEvent#resolvePromise() Resolve promise Source: core/events/actionevent.js, line 73 × Search results Close "},"app.core.events.ActionExceptionEvent.html":{"id":"app.core.events.ActionExceptionEvent.html","title":"Class: ActionExceptionEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.events.ActionExceptionEvent new app.core.events.ActionExceptionEvent(actionFilterContext, app, err) Parameters: Name Type Description actionFilterContext app.core.types.ActionFilterContext Current filter context app app.core.Application err Error Source: core/events/actionexceptionevent.js, line 38 Extends app.core.events.ActionEvent Members &lt;private&gt; actionFilterContext_ :app.core.types.ActionFilterContext Type: app.core.types.ActionFilterContext Inherited From: app.core.events.ActionEvent#actionFilterContext_ Source: core/events/actionevent.js, line 51 &lt;private&gt; error_ :Error Type: Error Source: core/events/actionexceptionevent.js, line 47 &lt;private&gt; promiseResolve_ :function Type: function Inherited From: app.core.events.ActionEvent#promiseResolve_ Source: core/events/actionevent.js, line 57 Methods app.core.events.ActionExceptionEvent#getContext() Inherited From: app.core.events.ActionEvent#getContext Source: core/events/actionevent.js, line 65 Returns: Type app.core.types.ActionFilterContext app.core.events.ActionExceptionEvent#getError() Source: core/events/actionexceptionevent.js, line 56 Returns: Type Error app.core.events.ActionExceptionEvent#resolvePromise() Resolve promise Inherited From: app.core.events.ActionEvent#resolvePromise Source: core/events/actionevent.js, line 73 × Search results Close "},"app.core.Request.html":{"id":"app.core.Request.html","title":"Class: Request","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.Request new app.core.Request(routeData, uri, queryVals [, opt_ignoreCase]) Create a simple request object based on the provided URL. Parameters: Name Type Argument Description routeData Object Object that contains information about current route. uri string The uri we are constructing this object from. queryVals string The values for query path. opt_ignoreCase boolean &lt;optional&gt; Whether or not we are performing a case sensitive parse. Source: core/request.js, line 45 Extends goog.Uri Members &lt;private&gt; routeData_ :Object Type: Object Source: core/request.js, line 52 Methods app.core.Request#getRouteData( [opt_key]) Return route data by key or all values as object Parameters: Name Type Argument Description opt_key string &lt;optional&gt; Source: core/request.js, line 64 Returns: Type Object | string app.core.Request#toJSON() Convert this object to a simple JSON object. Source: core/request.js, line 76 Returns: Type Object × Search results Close "},"app.core.Response.html":{"id":"app.core.Response.html","title":"Class: Response","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.Response new app.core.Response(request, router) Create a response based on the provided request. Parameters: Name Type Description request app.core.Request router app.core.Router Source: core/response.js, line 41 Members &lt;private&gt; request_ :app.core.Request Type: app.core.Request Source: core/response.js, line 46 &lt;private&gt; router_ :app.core.Router Type: app.core.Router Source: core/response.js, line 52 Methods app.core.Response#getRouter() Source: core/response.js, line 59 Returns: Type app.core.Router app.core.Response#render(template [, opt_data] [, opt_element]) Render the template with the provided data. Parameters: Name Type Argument Description template function The template being rendered. opt_data Object &lt;optional&gt; The data being passed to the template. Usually it's {mvc.Model} object. opt_element Element &lt;optional&gt; The element having the template rendered in. Defaults to document.body. Source: core/response.js, line 72 × Search results Close "},"app.core.Router.html":{"id":"app.core.Router.html","title":"Class: Router","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.Router new app.core.Router( [opt_noFragment] [, opt_blankPage] [, opt_input] [, opt_iframe]) Parameters: Name Type Argument Description opt_noFragment boolean &lt;optional&gt; set to true to hide fragment when using HTML5 history. opt_blankPage goog.html.TrustedResourceUrl &lt;optional&gt; url to a blank page - needed if HTML5 is not available and you don't want to show the fragment. opt_input HTMLInputElement &lt;optional&gt; The hidden input element to be used to store the history token. If not provided, a hidden input element will be created using document.write. opt_iframe HTMLIFrameElement &lt;optional&gt; The hidden iframe that will be used by IE for pushing history state changes, or by all browsers if opt_noFragment is true. If not provided, a hidden iframe element will be created using document.write. Source: core/router.js, line 35 Extends goog.events.EventTarget Members &lt;static&gt; EventType :string Router event types Type: string Properties: Name Type Default Description ROUTE_EXPIRED string routeExpired Source: core/router.js, line 57 Methods app.core.Router#checkRoutes() Go through all defined routes and run first matched. Source: core/router.js, line 159 app.core.Router#getFragment() Returns current routed fragment Source: core/router.js, line 78 Returns: routed fragment. Type string app.core.Router#navigate(fragment) Pass through the fragment for the URL Parameters: Name Type Description fragment string to set for the history token. Source: core/router.js, line 69 &lt;private&gt; app.core.Router#onChange_() Route change handler. Source: core/router.js, line 133 app.core.Router#route(route, fn [, opt_context]) Define route as string or regex. /:abc/ will pass &quot;abc&quot; through as an argument. abc/def will pass through all after the as an argument Parameters: Name Type Argument Description route string | RegExp to watch for. fn function should take in the token and any captured strings. opt_context Object &lt;optional&gt; Object in whose context the function is to be called (the global scope if none). Source: core/router.js, line 93 &lt;private&gt; app.core.Router#runRouteIfMatches_(route, fragment) Run route callback if route regexp matches fragment. Parameters: Name Type Description route Object Route object with context and route regexp. fragment string URI fragment to match with. Source: core/router.js, line 119 Returns: Type boolean × Search results Close "},"app.core.types.ActionFilterContext.html":{"id":"app.core.types.ActionFilterContext.html","title":"Class: ActionFilterContext","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.types.ActionFilterContext new app.core.types.ActionFilterContext(request, response) Parameters: Name Type Description request app.core.Request response app.core.Response Source: core/types/actionfiltercontext.js, line 33 Members &lt;private&gt; request_ :app.core.Request Type: app.core.Request Source: core/types/actionfiltercontext.js, line 39 &lt;private&gt; response_ :app.core.Response Type: app.core.Response Source: core/types/actionfiltercontext.js, line 45 Methods app.core.types.ActionFilterContext#getRequest() Source: core/types/actionfiltercontext.js, line 52 Returns: Type app.core.Request app.core.types.ActionFilterContext#getResponse() Source: core/types/actionfiltercontext.js, line 60 Returns: Type app.core.Response × Search results Close "},"app.core.types.ActionFilterItem.html":{"id":"app.core.types.ActionFilterItem.html","title":"Class: ActionFilterItem","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.types.ActionFilterItem new app.core.types.ActionFilterItem(filter, opt_route [, opt_order]) Parameters: Name Type Argument Description filter app.core.ActionFilter opt_route string | RegExp Route to watch for. opt_order number &lt;optional&gt; Source: core/types/actionfilteritem.js, line 38 Extends app.core.types.ApplicationFilterItem Members &lt;private&gt; filter_ :app.core.ApplicationFilter|T Type: app.core.ApplicationFilter | T Inherited From: app.core.types.ApplicationFilterItem#filter_ Source: core/types/applicationfilteritem.js, line 40 &lt;private&gt; order_ :number Type: number Inherited From: app.core.types.ApplicationFilterItem#order_ Source: core/types/applicationfilteritem.js, line 46 &lt;private&gt; route_ :string|RegExp Type: string | RegExp Source: core/types/actionfilteritem.js, line 45 Methods app.core.types.ActionFilterItem#getFilter() Inherited From: app.core.types.ApplicationFilterItem#getFilter Source: core/types/applicationfilteritem.js, line 53 Returns: Type app.core.ApplicationFilter | T app.core.types.ActionFilterItem#getOrder() Inherited From: app.core.types.ApplicationFilterItem#getOrder Source: core/types/applicationfilteritem.js, line 61 Returns: Type number app.core.types.ActionFilterItem#getRoute() Source: core/types/actionfilteritem.js, line 54 Returns: Type string | RegExp × Search results Close "},"app.core.types.ApplicationFilterItem.html":{"id":"app.core.types.ApplicationFilterItem.html","title":"Class: ApplicationFilterItem","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter app.core.types.ApplicationFilterItem new app.core.types.ApplicationFilterItem(filter [, opt_order]) Parameters: Name Type Argument Description filter app.core.ApplicationFilter | T opt_order number &lt;optional&gt; Source: core/types/applicationfilteritem.js, line 34 Members &lt;private&gt; filter_ :app.core.ApplicationFilter|T Type: app.core.ApplicationFilter | T Source: core/types/applicationfilteritem.js, line 40 &lt;private&gt; order_ :number Type: number Source: core/types/applicationfilteritem.js, line 46 Methods app.core.types.ApplicationFilterItem#getFilter() Source: core/types/applicationfilteritem.js, line 53 Returns: Type app.core.ApplicationFilter | T app.core.types.ApplicationFilterItem#getOrder() Source: core/types/applicationfilteritem.js, line 61 Returns: Type number × Search results Close "},"pwk.BranchNode.html":{"id":"pwk.BranchNode.html","title":"Class: BranchNode","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.BranchNode new pwk.BranchNode(type, doc) Parameters: Name Type Description type pwk.NodeTypes Type of node doc pwk.Document Parent document object. Source: pwk/editor/nodes/branchnode.js, line 41 Extends pwk.Node Members &lt;private&gt; attributes_ :Array.&lt;pwk.NodeAttribute&gt; Type: Array.&lt;pwk.NodeAttribute&gt; Inherited From: pwk.Node#attributes_ Source: pwk/editor/nodes/node.js, line 50 CSS_CLASS :string Component default css class Type: string Overrides: pwk.Node#CSS_CLASS Source: pwk/editor/nodes/branchnode.js, line 51 &lt;protected&gt; document_ :pwk.Document Type: pwk.Document Inherited From: pwk.Node#document_ Source: pwk/editor/nodes/node.js, line 67 getFirstLine Get first line of the current node. Inherited From: pwk.Node#getFirstLine Source: pwk/editor/nodes/node.js, line 221 getLastLine Get latest line of the node. Inherited From: pwk.Node#getLastLine Source: pwk/editor/nodes/node.js, line 228 getLength Get lines content length 0 is means that no content inside the node Inherited From: pwk.Node#getLength Source: pwk/editor/nodes/node.js, line 301 getNextLinkedNode Get next linked node. If node does not linked returns null. Inherited From: pwk.Node#getNextLinkedNode Source: pwk/editor/nodes/node.js, line 293 getOffsetByLineOffset Get node offset regarding specified line offset. Inherited From: pwk.Node#getOffsetByLineOffset Source: pwk/editor/nodes/node.js, line 237 getPreviousLinkedNode Get previous linked node. If node does not linked returns null. Inherited From: pwk.Node#getPreviousLinkedNode Source: pwk/editor/nodes/node.js, line 286 isChild_ :boolean Type: boolean Inherited From: pwk.Node#isChild_ Source: pwk/editor/nodes/node.js, line 61 isSplittable Specifies whether there can be this node is split between pages. Inherited From: pwk.Node#isSplittable Source: pwk/editor/nodes/node.js, line 257 removeRange Remove content range from node Inherited From: pwk.Node#removeRange Source: pwk/editor/nodes/node.js, line 214 removeSelection Remove node content based on current selection Inherited From: pwk.Node#removeSelection Source: pwk/editor/nodes/node.js, line 245 select Make selection for node content by range Inherited From: pwk.Node#select Source: pwk/editor/nodes/node.js, line 199 setNextLinkedNode Set next linked node. Inherited From: pwk.Node#setNextLinkedNode Source: pwk/editor/nodes/node.js, line 279 setPreviousLinkedNode Set previous linked node. Inherited From: pwk.Node#setPreviousLinkedNode Source: pwk/editor/nodes/node.js, line 272 split Inherited From: pwk.Node#split Source: pwk/editor/nodes/node.js, line 265 &lt;private&gt; type_ :pwk.NodeTypes Type: pwk.NodeTypes Inherited From: pwk.Node#type_ Source: pwk/editor/nodes/node.js, line 56 unselect Remove selection from node Inherited From: pwk.Node#unselect Source: pwk/editor/nodes/node.js, line 205 Methods pwk.BranchNode#addChild() Inherited From: pwk.Node#addChild Source: pwk/editor/nodes/node.js, line 99 pwk.BranchNode#addChildAt() Inherited From: pwk.Node#addChildAt Source: pwk/editor/nodes/node.js, line 105 pwk.BranchNode#createDom() Inherited From: pwk.Node#createDom Source: pwk/editor/nodes/node.js, line 76 pwk.BranchNode#disposeInternal() Inherited From: pwk.Node#disposeInternal Source: pwk/editor/nodes/node.js, line 84 pwk.BranchNode#getAttribute(type) Get attribute for specified type. Parameters: Name Type Description type pwk.NodeAttributeTypes Inherited From: pwk.Node#getAttribute Source: pwk/editor/nodes/node.js, line 148 Returns: Type pwk.NodeAttribute pwk.BranchNode#getAttributes() Inherited From: pwk.Node#getAttributes Source: pwk/editor/nodes/node.js, line 138 Returns: Type Array.&lt;pwk.NodeAttribute&gt; pwk.BranchNode#getIndex() Returns the 0-based index of the given node component, or -1 if no such node is found. Inherited From: pwk.Node#getIndex Source: pwk/editor/nodes/node.js, line 191 Returns: Type number pwk.BranchNode#getSize() Gets the height and width of an node element, even if its display is none. Inherited From: pwk.Node#getSize Overrides: pwk.Node#getSize Source: pwk/editor/nodes/node.js, line 159 Returns: Object with width/height properties. Type goog.math.Size pwk.BranchNode#getType() Inherited From: pwk.Node#getType Source: pwk/editor/nodes/node.js, line 130 Returns: Type of the node Type pwk.NodeTypes pwk.BranchNode#isChild( [opt_child]) Determine or set that node is a child. Parameters: Name Type Argument Description opt_child boolean &lt;optional&gt; Inherited From: pwk.Node#isChild Source: pwk/editor/nodes/node.js, line 119 Returns: Type boolean pwk.BranchNode#setAttribute(type, value [, opt_isMergeData]) Set attribute. If attribute with specified type already exist, old data will be rewritten or not, depended from opt_isMergeData argument. Data will be rewritten by default. Parameters: Name Type Argument Description type pwk.NodeAttributeTypes value string opt_isMergeData boolean &lt;optional&gt; Inherited From: pwk.Node#setAttribute Source: pwk/editor/nodes/node.js, line 172 × Search results Close "},"pwk.Document.html":{"id":"pwk.Document.html","title":"Class: Document","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Document new pwk.Document() Represent document of editor. Source: pwk/editor/document.js, line 55 Extends goog.ui.Component Classes NodeRemovedEvent Members &lt;static&gt; CSS_CLASS :string Component default css class Type: string Source: pwk/editor/document.js, line 755 &lt;static&gt; EventType :string Event types that can be stopped/started. Type: string Properties: Name Type Default Description FILLING_CHANGE string NODE_REMOVED string Source: pwk/editor/document.js, line 762 &lt;private&gt; documentSettings_ :pwk.DocumentSettings Type: pwk.DocumentSettings Source: pwk/editor/document.js, line 96 &lt;private&gt; nodeIndex_ :Array.&lt;string&gt; Array of ids of child @code{pwk.Node} components. Used to hold order of nodes in document. Type: Array.&lt;string&gt; Source: pwk/editor/document.js, line 76 &lt;private&gt; pageIndex_ :Array.&lt;string&gt; Array of ids of child @code{pwk.Page} components. Used to hold order of pages in document. Type: Array.&lt;string&gt; Source: pwk/editor/document.js, line 84 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/document.js, line 90 &lt;private&gt; pagination_ :pwk.Pagination Type: pwk.Pagination Source: pwk/editor/document.js, line 68 &lt;private&gt; selection_ :pwk.Selection Type: pwk.Selection Source: pwk/editor/document.js, line 62 Methods pwk.Document#addNode(node) Add node to the end of document. Parameters: Name Type Description node pwk.Node Source: pwk/editor/document.js, line 505 pwk.Document#addNodeAt(node, index [, opt_renderAfter]) Add node to the document at the given 0-based index. Parameters: Name Type Argument Description node pwk.Node index number opt_renderAfter boolean &lt;optional&gt; Is required to render the node after previous node or before sibling? Source: pwk/editor/document.js, line 526 pwk.Document#addPage(page) Add page to the end of document. Parameters: Name Type Description page pwk.Page Source: pwk/editor/document.js, line 367 pwk.Document#addPageAt(page, index) Add page to the document at the given 0-based index. Parameters: Name Type Description page pwk.Page index number Source: pwk/editor/document.js, line 378 pwk.Document#addValue(value) Add text value to current caret position. Parameters: Name Type Description value string | Text Source: pwk/editor/document.js, line 146 pwk.Document#createDom() Source: pwk/editor/document.js, line 102 pwk.Document#deleteSelection( [opt_isBack]) Delete document content based on current selection range. Parameters: Name Type Argument Description opt_isBack boolean &lt;optional&gt; Direction Source: pwk/editor/document.js, line 302 pwk.Document#enterDocument() Source: pwk/editor/document.js, line 120 pwk.Document#forEachNode(f [, opt_obj]) Calls the given function on each of this document's node in order. If {@code opt_obj} is provided, it will be used as the 'this' object in the function when called. The function should take two arguments: the node component and its 0-based index. The return value is ignored. Parameters: Name Type Argument Description f function The function to call for every node component; should take 2 arguments (the node and its index). opt_obj Object &lt;optional&gt; Used as the 'this' object in f when called. Source: pwk/editor/document.js, line 566 pwk.Document#forEachPage(f [, opt_obj]) Calls the given function on each of this document's page in order. If {@code opt_obj} is provided, it will be used as the 'this' object in the function when called. The function should take two arguments: the page component and its 0-based index. The return value is ignored. Parameters: Name Type Argument Description f function The function to call for every page component; should take 2 arguments (the page and its index). opt_obj Object &lt;optional&gt; Used as the 'this' object in f when called. Source: pwk/editor/document.js, line 404 pwk.Document#getNode(id) Returns the node with the given ID, or null if no such node exists. Parameters: Name Type Description id string Node ID. Source: pwk/editor/document.js, line 581 Returns: The node with the given ID; null if none. Type pwk.Node pwk.Document#getNodeAt(index) Returns the node at the given index, or null if the index is out of bounds. Parameters: Name Type Description index number 0-based index. Source: pwk/editor/document.js, line 591 Returns: The node at the given index; null if none. Type pwk.Node pwk.Document#getNodeCount() Returns the number of nodes of this document. Source: pwk/editor/document.js, line 601 Returns: The number of nodes. Type number pwk.Document#getNodeIds() Returns an array containing the IDs of the nodes of this document, or an empty array if the document has no nodes. Source: pwk/editor/document.js, line 611 Returns: Node component IDs. Type Array.&lt;string&gt; pwk.Document#getPage(id) Returns the page with the given ID, or null if no such page exists. Parameters: Name Type Description id string Page ID. Source: pwk/editor/document.js, line 419 Returns: The page with the given ID; null if none. Type pwk.Page pwk.Document#getPageAt(index) Returns the page at the given index, or null if the index is out of bounds. Parameters: Name Type Description index number 0-based index. Source: pwk/editor/document.js, line 429 Returns: The page at the given index; null if none. Type pwk.Page pwk.Document#getPageCount() Returns the number of pages of this document. Source: pwk/editor/document.js, line 439 Returns: The number of pages. Type number pwk.Document#getPageIds() Returns an array containing the IDs of the pages of this document, or an empty array if the document has no pages. Source: pwk/editor/document.js, line 449 Returns: Page component IDs. Type Array.&lt;string&gt; pwk.Document#getPagination() Get {@code pwk.Pagination} document instance Source: pwk/editor/document.js, line 681 Returns: Type pwk.Pagination pwk.Document#getPaginationIndex() Return index of page/nodes equivalent. Source: pwk/editor/document.js, line 690 Returns: Type Array.&lt;Array.&lt;string&gt;&gt; pwk.Document#getSelection() Source: pwk/editor/document.js, line 137 Returns: Type pwk.Selection pwk.Document#indexOfNode(node) Returns the 0-based index of the given node component, or -1 if no such node is found. Parameters: Name Type Argument Description node pwk.Node &lt;nullable&gt; The node component. Source: pwk/editor/document.js, line 622 Returns: 0-based index of the node component; -1 if not found. Type number pwk.Document#indexOfPage(page) Returns the 0-based index of the given page component, or -1 if no such page is found. Parameters: Name Type Description page pwk.Page | string The page component. Source: pwk/editor/document.js, line 460 Returns: 0-based index of the page component; -1 if not found. Type number &lt;private&gt; pwk.Document#initializeDocument_() Initialize document Source: pwk/editor/document.js, line 699 &lt;private&gt; pwk.Document#initializeEvents_() Initialize component and related components events Source: pwk/editor/document.js, line 723 pwk.Document#newLine() Create new line. Source: pwk/editor/document.js, line 247 &lt;private&gt; pwk.Document#onDocumentFillingChangedEventHandler_(e) Handler of filling document content. Called each time, when height of document content was changed. Parameters: Name Type Description e goog.events.Event Source: pwk/editor/document.js, line 735 pwk.Document#removeNode(node) Removes the given node from this document, returns and disposes of it. Throws an error if the argument is invalid or if the specified node isn't found in the document. The argument can either be a string (interpreted as the ID of the node component to remove) or the node component itself. Parameters: Name Type Description node string | pwk.Node The ID of the node to remove, or the node component itself. Source: pwk/editor/document.js, line 650 Returns: The removed node, if any. Type pwk.Node pwk.Document#removeNodeAt(index) Removes the node at the given index from this document, returns and disposes of it. Throws an error if the argument is out of bounds, or if the specified node isn't found in the document. Parameters: Name Type Description index number 0-based index of the node to remove. Source: pwk/editor/document.js, line 672 Returns: The removed node, if any. Type pwk.Node pwk.Document#removePage(page) Removes the given page from this document, and returns it. Throws an error if the argument is invalid or if the specified page isn't found in the document. The argument can either be a string (interpreted as the ID of the page component to remove) or the page component itself. Parameters: Name Type Description page string | pwk.Page The ID of the page to remove, or the page component itself. Source: pwk/editor/document.js, line 478 Returns: The removed component, if any. Type pwk.Page pwk.Document#removePageAt(index) Removes the page at the given index from this document, and returns it. Throws an error if the argument is out of bounds, or if the specified page isn't found in the document. Parameters: Name Type Description index number 0-based index of the page to remove. Source: pwk/editor/document.js, line 496 Returns: The removed page, if any. Type pwk.Page pwk.Document#unlinkNode(node) Do the same as {@code pwk.Document.prototype.removeNode} but did not deleting it from index. Parameters: Name Type Description node string | pwk.Node The ID of the node to remove, or the node component itself. Source: pwk/editor/document.js, line 636 Returns: The removed node, if any. Type pwk.Node × Search results Close "},"pwk.Document.NodeRemovedEvent.html":{"id":"pwk.Document.NodeRemovedEvent.html","title":"Class: NodeRemovedEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter .Document. pwk.Document.NodeRemovedEvent new pwk.Document.NodeRemovedEvent(node) Parameters: Name Type Description node pwk.Node Source: pwk/editor/document.js, line 774 Extends goog.events.Event Members removedNode :pwk.Node Type: pwk.Node Source: pwk/editor/document.js, line 780 × Search results Close "},"pwk.DocumentSettings.html":{"id":"pwk.DocumentSettings.html","title":"Class: DocumentSettings","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.DocumentSettings new pwk.DocumentSettings() Initialize {pwk.PageSettings} component. Source: pwk/editor/documentsettings.js, line 39 Members &lt;private&gt; document_ :pwk.Document Document instance. Type: pwk.Document Source: pwk/editor/documentsettings.js, line 60 &lt;private&gt; fontSize_ :string Document font size. Type: string Source: pwk/editor/documentsettings.js, line 53 &lt;private&gt; lineHeight_ :string Document line height. Type: string Source: pwk/editor/documentsettings.js, line 46 Methods &lt;private&gt; pwk.DocumentSettings#applyFontSize_() Apply font size settings to document. Source: pwk/editor/documentsettings.js, line 128 &lt;private&gt; pwk.DocumentSettings#applyLineHeight_() Apply line height settings to document. Source: pwk/editor/documentsettings.js, line 118 &lt;private&gt; pwk.DocumentSettings#getDocument_() Source: pwk/editor/documentsettings.js, line 137 Returns: Type pwk.Document pwk.DocumentSettings#getFontSize() Get default font size of current document. Source: pwk/editor/documentsettings.js, line 88 Returns: Type string pwk.DocumentSettings#getLineHeight() Get default line-height for current document. Source: pwk/editor/documentsettings.js, line 69 Returns: Type string pwk.DocumentSettings#initialize(doc) Initialize document property to manage global settings of document. Parameters: Name Type Description doc pwk.Document Source: pwk/editor/documentsettings.js, line 107 pwk.DocumentSettings#setFontSize(value) Set default font size of current document. Parameters: Name Type Description value string Source: pwk/editor/documentsettings.js, line 97 pwk.DocumentSettings#setLineHeight(value) Set default line-height for current document. Parameters: Name Type Description value string Source: pwk/editor/documentsettings.js, line 78 × Search results Close "},"pwk.Editor.html":{"id":"pwk.Editor.html","title":"Class: Editor","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Editor new pwk.Editor() Main class of PWK Editor. Source: pwk/editor/editor.js, line 55 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Component default css class. Type: string Source: pwk/editor/editor.js, line 561 &lt;static&gt; CSS_TEXT_EVENT_TARGET :string iFrame text event target CSS class. Type: string Source: pwk/editor/editor.js, line 568 &lt;private&gt; document_ :pwk.Document Type: pwk.Document Source: pwk/editor/editor.js, line 82 &lt;private&gt; focusHandler_ :goog.events.FocusHandler Focus handler. Type: goog.events.FocusHandler Source: pwk/editor/editor.js, line 89 &lt;private&gt; isSelectionStarted_ :boolean Indicated is selection of document started or not Type: boolean Source: pwk/editor/editor.js, line 108 &lt;private&gt; keyboardShortcutHandler_ :goog.ui.KeyboardShortcutHandler Keyboard shortcuts handler. Type: goog.ui.KeyboardShortcutHandler Source: pwk/editor/editor.js, line 76 &lt;private&gt; keyHandler_ :goog.events.KeyHandler Type: goog.events.KeyHandler Source: pwk/editor/editor.js, line 62 &lt;private&gt; keyTarget_ :goog.events.EventTarget|EventTarget Event target that the event listener should be attached to. Type: goog.events.EventTarget | EventTarget Source: pwk/editor/editor.js, line 69 &lt;private&gt; scrollLoopBrowserEvent_ :goog.events.BrowserEvent Type: goog.events.BrowserEvent Source: pwk/editor/editor.js, line 114 &lt;private&gt; scrollLoopInProgress_ :boolean Type: boolean Source: pwk/editor/editor.js, line 120 &lt;private&gt; selection_ :pwk.Selection Type: pwk.Selection Source: pwk/editor/editor.js, line 95 &lt;private&gt; startSelectionRange_ :pwk.Range Type: pwk.Range Source: pwk/editor/editor.js, line 101 Methods pwk.Editor#addTestText( [opt_init]) Keep in mind that this case is implemented for test purpose only and does not work properly with Range / Selection. Parameters: Name Type Argument Description opt_init boolean &lt;optional&gt; Source: pwk/editor/editor.js, line 534 pwk.Editor#createDom() Source: pwk/editor/editor.js, line 126 pwk.Editor#enterDocument() Source: pwk/editor/editor.js, line 140 &lt;private&gt; pwk.Editor#handleKeyboardShortcut_(e) Handles keyboard shortcuts on the editor. Parameters: Name Type Description e goog.ui.KeyboardShortcutEvent Source: pwk/editor/editor.js, line 494 &lt;private&gt; pwk.Editor#handleKeyEvent_(e) Attempts to handle a keyboard event. Parameters: Name Type Description e goog.events.KeyEvent The key event. Source: pwk/editor/editor.js, line 391 Returns: Type boolean &lt;private&gt; pwk.Editor#initializeEvents_() Initialize key event handler. Source: pwk/editor/editor.js, line 174 &lt;private&gt; pwk.Editor#onFocusIn_(e) Handles focus event. Parameters: Name Type Description e goog.events.BrowserEvent Browser's event object. Source: pwk/editor/editor.js, line 364 &lt;private&gt; pwk.Editor#onFocusOut_(e) Handles focus out event. Parameters: Name Type Description e goog.events.BrowserEvent Browser's event object. Source: pwk/editor/editor.js, line 377 &lt;private&gt; pwk.Editor#onMouseDown_(e) Handles mousedown event. Parameters: Name Type Description e goog.events.BrowserEvent Mouse event to handle. Source: pwk/editor/editor.js, line 202 &lt;private&gt; pwk.Editor#onMouseMove_(e) Handles mousemove event. Parameters: Name Type Description e goog.events.BrowserEvent Mouse event to handle. Source: pwk/editor/editor.js, line 235 &lt;private&gt; pwk.Editor#onMouseUp_(e) Handles mouseup event. Parameters: Name Type Description e goog.events.BrowserEvent Mouse event to handle. Source: pwk/editor/editor.js, line 347 &lt;private&gt; pwk.Editor#registerKeyboardShortcut_(handler) Register handled shortcut. Parameters: Name Type Description handler goog.ui.KeyboardShortcutHandler Source: pwk/editor/editor.js, line 521 &lt;private&gt; pwk.Editor#scrollDocumentForSelection_(e) Parameters: Name Type Description e goog.events.BrowserEvent Source: pwk/editor/editor.js, line 264 &lt;private&gt; pwk.Editor#scrollInLoop_() Source: pwk/editor/editor.js, line 300 &lt;private&gt; pwk.Editor#selectFromRangeToPoint_(startSelectionRange, x, y) Parameters: Name Type Description startSelectionRange pwk.Range x number y number Source: pwk/editor/editor.js, line 282 × Search results Close "},"pwk.EditorContainer.html":{"id":"pwk.EditorContainer.html","title":"Class: EditorContainer","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.EditorContainer new pwk.EditorContainer() Source: pwk/editor/layer/editorcontainer.js, line 41 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Component default css class Type: string Source: pwk/editor/layer/editorcontainer.js, line 80 Methods pwk.EditorContainer#createDom() Source: pwk/editor/layer/editorcontainer.js, line 48 pwk.EditorContainer#enterDocument() Source: pwk/editor/layer/editorcontainer.js, line 57 &lt;private&gt; pwk.EditorContainer#onWindowResize_() On window resize event handler Source: pwk/editor/layer/editorcontainer.js, line 71 × Search results Close "},"pwk.layer.Caret.html":{"id":"pwk.layer.Caret.html","title":"Class: Caret","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.layer.Caret new pwk.layer.Caret( [opt_domHelper]) Initialize {pwk.layer.Caret} component. Parameters: Name Type Argument Description opt_domHelper goog.dom.DomHelper &lt;optional&gt; Optional DOM helper, used for document interaction. Source: pwk/editor/layer/caret.js, line 49 Extends goog.ui.Component Classes AfterUpdateEvent Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/layer/caret.js, line 98 &lt;static&gt; CSS_CLASS_LAYER :string CSS class of parent caret wrapper element. Type: string Source: pwk/editor/layer/caret.js, line 106 &lt;static&gt; EventType :string Type: string Properties: Name Type Default Description BEFORE_UPDATE string AFTER_UPDATE string Source: pwk/editor/layer/caret.js, line 264 &lt;private&gt; blinkId_ :number Type: number Source: pwk/editor/layer/caret.js, line 72 &lt;private&gt; documentElement_ :Element Type: Element Source: pwk/editor/layer/caret.js, line 78 &lt;private&gt; isVisible_ :boolean Is cursor visible. Type: boolean Source: pwk/editor/layer/caret.js, line 58 &lt;private&gt; layer_ :Node Parent caret wrapper. Type: Node Source: pwk/editor/layer/caret.js, line 66 &lt;private&gt; ZERO_WIDTH_SPACE_ :string A zero width space character. Type: string Source: pwk/editor/layer/caret.js, line 85 Methods pwk.layer.Caret#createDom() Source: pwk/editor/layer/caret.js, line 110 pwk.layer.Caret#decorateInternal() Source: pwk/editor/layer/caret.js, line 123 pwk.layer.Caret#disposeInternal() Source: pwk/editor/layer/caret.js, line 154 pwk.layer.Caret#enterDocument() Source: pwk/editor/layer/caret.js, line 136 pwk.layer.Caret#hide() Hide cursor. Source: pwk/editor/layer/caret.js, line 176 &lt;private&gt; pwk.layer.Caret#onCaretAfterUpdate_(e) Parameters: Name Type Description e pwk.layer.Caret.AfterUpdateEvent Source: pwk/editor/layer/caret.js, line 256 &lt;private&gt; pwk.layer.Caret#onCaretBeforeUpdate_(e) Parameters: Name Type Description e goog.events.Event Source: pwk/editor/layer/caret.js, line 248 pwk.layer.Caret#restartTimer() Restart blink Source: pwk/editor/layer/caret.js, line 200 pwk.layer.Caret#show() Show cursor. Source: pwk/editor/layer/caret.js, line 188 pwk.layer.Caret#update(selection) Update cursor position by range Parameters: Name Type Description selection pwk.Selection Source: pwk/editor/layer/caret.js, line 225 Returns: Type goog.math.Rect × Search results Close "},"pwk.layer.Caret.AfterUpdateEvent.html":{"id":"pwk.layer.Caret.AfterUpdateEvent.html","title":"Class: AfterUpdateEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter .Caret. pwk.layer.Caret.AfterUpdateEvent new pwk.layer.Caret.AfterUpdateEvent(caret, bounds) Parameters: Name Type Description caret pwk.layer.Caret bounds goog.math.Rect Source: pwk/editor/layer/caret.js, line 277 Extends goog.events.Event Members &lt;private&gt; bounds_ :goog.math.Rect Type: goog.math.Rect Source: pwk/editor/layer/caret.js, line 284 Methods pwk.layer.Caret.AfterUpdateEvent#getBounds() Source: pwk/editor/layer/caret.js, line 292 Returns: Type goog.math.Rect × Search results Close "},"pwk.layer.SelectionOverlay.html":{"id":"pwk.layer.SelectionOverlay.html","title":"Class: SelectionOverlay","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.layer.SelectionOverlay new pwk.layer.SelectionOverlay(clientRectRange [, opt_domHelper]) Parameters: Name Type Argument Description clientRectRange pwk.primitives.ClientRectRange opt_domHelper goog.dom.DomHelper &lt;optional&gt; Optional DOM helper, used for document interaction. Source: pwk/editor/layer/selectionoverlay.js, line 45 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/layer/selectionoverlay.js, line 63 &lt;private&gt; clientRectRange_ :pwk.primitives.ClientRectRange Type: pwk.primitives.ClientRectRange Source: pwk/editor/layer/selectionoverlay.js, line 52 Methods pwk.layer.SelectionOverlay#createDom() Source: pwk/editor/layer/selectionoverlay.js, line 67 × Search results Close "},"pwk.LeafNode.html":{"id":"pwk.LeafNode.html","title":"Class: LeafNode","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.LeafNode new pwk.LeafNode(type, doc, opt_content) Parameters: Name Type Description type pwk.NodeTypes Type of node. doc pwk.Document Parent document object. opt_content string | pwk.Line Content text or line. Source: pwk/editor/nodes/leafnode.js, line 51 Extends pwk.Node Classes NodeContentChangedEvent Members &lt;static&gt; EventType :string Type: string Properties: Name Type Default Description CONTENT_CHANGED string Source: pwk/editor/nodes/leafnode.js, line 1183 &lt;private&gt; attributes_ :Array.&lt;pwk.NodeAttribute&gt; Type: Array.&lt;pwk.NodeAttribute&gt; Inherited From: pwk.Node#attributes_ Source: pwk/editor/nodes/node.js, line 50 CSS_CLASS :string Component default css class. Type: string Overrides: pwk.Node#CSS_CLASS Source: pwk/editor/nodes/leafnode.js, line 1177 &lt;protected&gt; document_ :pwk.Document Type: pwk.Document Inherited From: pwk.Node#document_ Overrides: pwk.Node#document_ Source: pwk/editor/nodes/node.js, line 67 getFirstLine Get first line of the current node. Inherited From: pwk.Node#getFirstLine Overrides: pwk.Node#getFirstLine Source: pwk/editor/nodes/node.js, line 221 getLastLine Get latest line of the node. Inherited From: pwk.Node#getLastLine Overrides: pwk.Node#getLastLine Source: pwk/editor/nodes/node.js, line 228 getLength Get lines content length 0 is means that no content inside the node Inherited From: pwk.Node#getLength Overrides: pwk.Node#getLength Source: pwk/editor/nodes/node.js, line 301 getNextLinkedNode Get next linked node. If node does not linked returns null. Inherited From: pwk.Node#getNextLinkedNode Overrides: pwk.Node#getNextLinkedNode Source: pwk/editor/nodes/node.js, line 293 getPreviousLinkedNode Get previous linked node. If node does not linked returns null. Inherited From: pwk.Node#getPreviousLinkedNode Overrides: pwk.Node#getPreviousLinkedNode Source: pwk/editor/nodes/node.js, line 286 isChild_ :boolean Type: boolean Inherited From: pwk.Node#isChild_ Source: pwk/editor/nodes/node.js, line 61 &lt;private&gt; isSelected_ :boolean Type: boolean Source: pwk/editor/nodes/leafnode.js, line 97 isSplittable Specifies whether there can be this node is split between pages. Inherited From: pwk.Node#isSplittable Overrides: pwk.Node#isSplittable Source: pwk/editor/nodes/node.js, line 257 &lt;private&gt; lines_ :Array.&lt;pwk.Line&gt; Type: Array.&lt;pwk.Line&gt; Source: pwk/editor/nodes/leafnode.js, line 58 &lt;private&gt; nextLinkedNode_ :pwk.LeafNode Type: pwk.LeafNode Source: pwk/editor/nodes/leafnode.js, line 85 &lt;private, nullable&gt; nodeSelectionRange_ :pwk.primitives.NodeSelectionRange Type: pwk.primitives.NodeSelectionRange Source: pwk/editor/nodes/leafnode.js, line 91 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/nodes/leafnode.js, line 73 &lt;private&gt; previousLinkedNode_ :pwk.LeafNode Type: pwk.LeafNode Source: pwk/editor/nodes/leafnode.js, line 79 &lt;private&gt; rangeOffsetInfoCache_ :Array Type: Array Source: pwk/editor/nodes/leafnode.js, line 67 removeRange Remove content range from node Inherited From: pwk.Node#removeRange Source: pwk/editor/nodes/node.js, line 214 removeSelection Remove node content based on current selection Inherited From: pwk.Node#removeSelection Overrides: pwk.Node#removeSelection Source: pwk/editor/nodes/node.js, line 245 select Make selection for node content by range Inherited From: pwk.Node#select Overrides: pwk.Node#select Source: pwk/editor/nodes/node.js, line 199 setNextLinkedNode Set next linked node. Inherited From: pwk.Node#setNextLinkedNode Overrides: pwk.Node#setNextLinkedNode Source: pwk/editor/nodes/node.js, line 279 setPreviousLinkedNode Set previous linked node. Inherited From: pwk.Node#setPreviousLinkedNode Overrides: pwk.Node#setPreviousLinkedNode Source: pwk/editor/nodes/node.js, line 272 &lt;private&gt; type_ :pwk.NodeTypes Type: pwk.NodeTypes Inherited From: pwk.Node#type_ Source: pwk/editor/nodes/node.js, line 56 Methods pwk.LeafNode#addChild() Inherited From: pwk.Node#addChild Source: pwk/editor/nodes/node.js, line 99 pwk.LeafNode#addChildAt() Inherited From: pwk.Node#addChildAt Overrides: pwk.Node#addChildAt Source: pwk/editor/nodes/node.js, line 105 pwk.LeafNode#clearRangeInfoForOffsetCache( [opt_callerNode]) Clear cache for offsets range information. Parameters: Name Type Argument Description opt_callerNode pwk.LeafNode &lt;optional&gt; Source: pwk/editor/nodes/leafnode.js, line 690 pwk.LeafNode#createDom() Inherited From: pwk.Node#createDom Overrides: pwk.Node#createDom Source: pwk/editor/nodes/node.js, line 76 pwk.LeafNode#disposeInternal() Inherited From: pwk.Node#disposeInternal Overrides: pwk.Node#disposeInternal Source: pwk/editor/nodes/node.js, line 84 pwk.LeafNode#enterDocument() Source: pwk/editor/nodes/leafnode.js, line 125 pwk.LeafNode#getAttribute(type) Get attribute for specified type. Parameters: Name Type Description type pwk.NodeAttributeTypes Inherited From: pwk.Node#getAttribute Source: pwk/editor/nodes/node.js, line 148 Returns: Type pwk.NodeAttribute pwk.LeafNode#getAttributes() Inherited From: pwk.Node#getAttributes Source: pwk/editor/nodes/node.js, line 138 Returns: Type Array.&lt;pwk.NodeAttribute&gt; pwk.LeafNode#getIndex() Returns the 0-based index of the given node component, or -1 if no such node is found. Inherited From: pwk.Node#getIndex Source: pwk/editor/nodes/node.js, line 191 Returns: Type number pwk.LeafNode#getLineAt(index [, opt_isIncludeLinesFromLinkedNodes]) Returns the line at the given index, or null if the index is out of bounds. Parameters: Name Type Argument Description index number 0-based index. opt_isIncludeLinesFromLinkedNodes boolean &lt;optional&gt; Source: pwk/editor/nodes/leafnode.js, line 524 Returns: Type pwk.Line pwk.LeafNode#getLines() Returns array of lines of current node. Source: pwk/editor/nodes/leafnode.js, line 537 Returns: Type Array.&lt;pwk.Line&gt; pwk.LeafNode#getLinesCount() Get lines count. Source: pwk/editor/nodes/leafnode.js, line 546 Returns: Type number &lt;private&gt; pwk.LeafNode#getLinesOfAllLinkedNodes_() Get concatenated lines of all linked nodes Source: pwk/editor/nodes/leafnode.js, line 277 Returns: Type Array.&lt;pwk.Line&gt; pwk.LeafNode#getOffsetByLineOffset(line, lineOffset) Get node offset regarding specified line offset. Parameters: Name Type Description line pwk.Line lineOffset number Overrides: pwk.Node#getOffsetByLineOffset Source: pwk/editor/nodes/leafnode.js, line 415 Returns: Type number &lt;private&gt; pwk.LeafNode#getOffsetForLinkedNodes_(line, lineOffset) Get offset of linked nodes for line offset. Parameters: Name Type Description line lineOffset Source: pwk/editor/nodes/leafnode.js, line 445 Returns: Type number pwk.LeafNode#getRangeInfoByLinkedNodesOffset(nodeOffset) Get line range information for specific offset based on all linked nodes. Parameters: Name Type Description nodeOffset number Text range offset (summary for all lines) Source: pwk/editor/nodes/leafnode.js, line 363 Returns: Type pwk.LineOffsetInfo pwk.LeafNode#getRangeInfoForOffset(nodeOffset) Get line range information for specific offset at the node. Parameters: Name Type Description nodeOffset number Text range offset (summary for all lines) Source: pwk/editor/nodes/leafnode.js, line 303 Returns: Type pwk.LineOffsetInfo pwk.LeafNode#getSize() Gets the height and width of an node element, even if its display is none. Inherited From: pwk.Node#getSize Source: pwk/editor/nodes/node.js, line 159 Returns: Object with width/height properties. Type goog.math.Size pwk.LeafNode#getText() Get concatenated lines text Source: pwk/editor/nodes/leafnode.js, line 488 Returns: Type string pwk.LeafNode#getType() Inherited From: pwk.Node#getType Source: pwk/editor/nodes/node.js, line 130 Returns: Type of the node Type pwk.NodeTypes pwk.LeafNode#indexOfLine(line) Returns the 0-based index of the given line component, or -1 if no such node is found. Parameters: Name Type Argument Description line pwk.Line &lt;nullable&gt; The line component. Source: pwk/editor/nodes/leafnode.js, line 588 Returns: 0-based index of the line component; -1 if not found. Type number pwk.LeafNode#insertLine(line, render [, opt_i]) Parameters: Name Type Argument Description line pwk.Line Line object to insert. render boolean Is required render lines? opt_i number &lt;optional&gt; The index at which to insert the object. Source: pwk/editor/nodes/leafnode.js, line 222 pwk.LeafNode#insertLines(lines, render [, opt_i]) * Parameters: Name Type Argument Description lines Array.&lt;pwk.Line&gt; Lines to insert. render boolean Is required render lines? opt_i number &lt;optional&gt; The index at which to insert the object. Source: pwk/editor/nodes/leafnode.js, line 239 pwk.LeafNode#insertText(text [, opt_offset]) Insert text to the end of node or to the specific position, based on provided offset. Parameters: Name Type Argument Description text string opt_offset number &lt;optional&gt; Offset inside node, whole all lines Source: pwk/editor/nodes/leafnode.js, line 611 pwk.LeafNode#insertValue(value [, opt_offset]) Insert value to the end of node or to the specific position, based on provided offset. Parameters: Name Type Argument Description value string opt_offset number &lt;optional&gt; Offset inside node, whole all lines Source: pwk/editor/nodes/leafnode.js, line 599 pwk.LeafNode#isChild( [opt_child]) Determine or set that node is a child. Parameters: Name Type Argument Description opt_child boolean &lt;optional&gt; Inherited From: pwk.Node#isChild Source: pwk/editor/nodes/node.js, line 119 Returns: Type boolean pwk.LeafNode#isRootLinkedNode() Is current node a topmost of all linked nodes? Source: pwk/editor/nodes/leafnode.js, line 166 Returns: Type boolean &lt;private&gt; pwk.LeafNode#isSelectedEntirely_() Is node selected entirely? Source: pwk/editor/nodes/leafnode.js, line 1155 Returns: Type boolean &lt;private&gt; pwk.LeafNode#normalizeBackward_(lastUpdatedLine, parentContentWidth) Parameters: Name Type Description lastUpdatedLine pwk.Line parentContentWidth number Source: pwk/editor/nodes/leafnode.js, line 780 Returns: Type pwk.Line &lt;private&gt; pwk.LeafNode#normalizeForward_(lastUpdatedLine, parentContentWidth) Parameters: Name Type Description lastUpdatedLine pwk.Line parentContentWidth number Source: pwk/editor/nodes/leafnode.js, line 848 pwk.LeafNode#normalizeLines(lastUpdatedLine) Normalization of the contents on the lines. Parameters: Name Type Description lastUpdatedLine pwk.Line Source: pwk/editor/nodes/leafnode.js, line 728 &lt;private&gt; pwk.LeafNode#onLineContentChangedHandler_(e) Parameters: Name Type Description e pwk.LeafNode.NodeContentChangedEvent Source: pwk/editor/nodes/leafnode.js, line 715 pwk.LeafNode#removeLine(line) Removes the given line from this node, returns and disposes of it. Throws an error if the argument is invalid or if the specified line isn't found in the node. Parameters: Name Type Description line pwk.Line Source: pwk/editor/nodes/leafnode.js, line 558 Returns: Type pwk.Line &lt;private&gt; pwk.LeafNode#renderNode_() Source: pwk/editor/nodes/leafnode.js, line 620 pwk.LeafNode#setAttribute(type, value [, opt_isMergeData]) Set attribute. If attribute with specified type already exist, old data will be rewritten or not, depended from opt_isMergeData argument. Data will be rewritten by default. Parameters: Name Type Argument Description type pwk.NodeAttributeTypes value string opt_isMergeData boolean &lt;optional&gt; Inherited From: pwk.Node#setAttribute Source: pwk/editor/nodes/node.js, line 172 pwk.LeafNode#split(offset) Parameters: Name Type Description offset number Node offset, 0-based index. Overrides: pwk.Node#split Source: pwk/editor/nodes/leafnode.js, line 640 Returns: Returns new node or next linked node, in case if offset is end of the current node and next exist linked node. Type pwk.LeafNode pwk.LeafNode#unlinkLine(line) Do the same as {@code pwk.LeafNode.prototype.removeLine}, but without object disposing. Parameters: Name Type Description line pwk.Line Source: pwk/editor/nodes/leafnode.js, line 576 Returns: Type pwk.Line pwk.LeafNode#unlinkNextLinkedNode() Unlink linked node below Source: pwk/editor/nodes/leafnode.js, line 206 pwk.LeafNode#unlinkPreviousLinkedNode() Unlink topmost linked node Source: pwk/editor/nodes/leafnode.js, line 192 pwk.LeafNode#unselect() Remove selection from node Overrides: pwk.Node#unselect Source: pwk/editor/nodes/leafnode.js, line 1000 × Search results Close "},"pwk.LeafNode.NodeContentChangedEvent.html":{"id":"pwk.LeafNode.NodeContentChangedEvent.html","title":"Class: NodeContentChangedEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter .LeafNode. pwk.LeafNode.NodeContentChangedEvent new pwk.LeafNode.NodeContentChangedEvent(line) Parameters: Name Type Description line pwk.Line Source: pwk/editor/nodes/leafnode.js, line 1193 Extends goog.events.Event Members lastUpdatedLine :pwk.Line Type: pwk.Line Source: pwk/editor/nodes/leafnode.js, line 1199 × Search results Close "},"pwk.Line.html":{"id":"pwk.Line.html","title":"Class: Line","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Line new pwk.Line( [opt_text]) Parameters: Name Type Argument Description opt_text string &lt;optional&gt; Text content Source: pwk/editor/nodes/line.js, line 45 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Component default css class. Type: string Source: pwk/editor/nodes/line.js, line 319 &lt;private&gt; content_ :pwk.LineContent Type: pwk.LineContent Source: pwk/editor/nodes/line.js, line 52 &lt;nullable&gt; selectionOffsets_ :Object Type: Object Source: pwk/editor/nodes/line.js, line 64 &lt;private&gt; selectionOverlay_ :pwk.layer.SelectionOverlay Type: pwk.layer.SelectionOverlay Source: pwk/editor/nodes/line.js, line 59 Methods pwk.Line#createDom() Source: pwk/editor/nodes/line.js, line 71 pwk.Line#cut(startOffset [, opt_endOffset]) Parameters: Name Type Argument Description startOffset number opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/line.js, line 225 Returns: Сutted text Type string pwk.Line#disposeInternal() Source: pwk/editor/nodes/line.js, line 85 pwk.Line#getContent() Source: pwk/editor/nodes/line.js, line 215 Returns: Type pwk.LineContent pwk.Line#getHeight() Get line height Source: pwk/editor/nodes/line.js, line 138 Returns: Type number pwk.Line#getIndex() Get index inside node. Source: pwk/editor/nodes/line.js, line 147 Returns: Type number pwk.Line#getLength() Get content length Source: pwk/editor/nodes/line.js, line 119 Returns: Type number pwk.Line#getNormalizedText() Get line content with normalized whitespaces Source: pwk/editor/nodes/line.js, line 110 Returns: Type string pwk.Line#getParentNode() Get parent leaf node Source: pwk/editor/nodes/line.js, line 234 Returns: Type pwk.LeafNode pwk.Line#getText() Get line content Source: pwk/editor/nodes/line.js, line 101 Returns: Type string pwk.Line#getTextNodeAtOffset(offset) Parameters: Name Type Description offset Source: pwk/editor/nodes/line.js, line 198 Returns: Type Node pwk.Line#getTextNodeValueAtOffset(offset) Parameters: Name Type Description offset Source: pwk/editor/nodes/line.js, line 207 Returns: Type string pwk.Line#getWidth(isOnlyPrintableContent) Get content width Parameters: Name Type Description isOnlyPrintableContent boolean Source: pwk/editor/nodes/line.js, line 129 Returns: Type number pwk.Line#insertText(text [, opt_offset]) Set the text Parameters: Name Type Argument Description text string opt_offset number &lt;optional&gt; Source: pwk/editor/nodes/line.js, line 187 pwk.Line#insertValue(value [, opt_offset]) Insert a single value. Parameters: Name Type Argument Description value string Content value, used as single value of TextNode opt_offset number &lt;optional&gt; Source: pwk/editor/nodes/line.js, line 175 pwk.Line#isSelectedEntirely() Is line selected entirely? Source: pwk/editor/nodes/line.js, line 292 Returns: Type boolean pwk.Line#pop() Removes the last text node from the content and returns its value. Source: pwk/editor/nodes/line.js, line 156 Returns: The value of the popped text node. Type string pwk.Line#popLastWord() Removes latest text nodes, separated by space/tab, from the content and returns their values. Source: pwk/editor/nodes/line.js, line 165 Returns: The values of the popped text nodes. Type string pwk.Line#removeSelection() Remove selected content Source: pwk/editor/nodes/line.js, line 304 Returns: Type Object | Object.&lt;string, string&gt; | null pwk.Line#select( [opt_startOffset] [, opt_endOffset]) Make selection for line content by provided offsets. Parameters: Name Type Argument Description opt_startOffset number &lt;optional&gt; opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/line.js, line 244 pwk.Line#unselect() Remove selection overlay from the line Source: pwk/editor/nodes/line.js, line 278 × Search results Close "},"pwk.LineContent.html":{"id":"pwk.LineContent.html","title":"Class: LineContent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.LineContent new pwk.LineContent( [opt_text]) Parameters: Name Type Argument Description opt_text string &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 43 Extends goog.ui.Component Members &lt;private&gt; annotations_ :Array.&lt;pwk.NodeAnnotation&gt; Type: Array.&lt;pwk.NodeAnnotation&gt; Source: pwk/editor/nodes/linecontent.js, line 56 &lt;private&gt; text_ :string Type: string Source: pwk/editor/nodes/linecontent.js, line 50 Methods pwk.LineContent#addAnnotation(annotation) Parameters: Name Type Description annotation pwk.NodeAnnotation Source: pwk/editor/nodes/linecontent.js, line 549 pwk.LineContent#copy(startOffset [, opt_endOffset]) Parameters: Name Type Argument Description startOffset number opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 336 Returns: Type string pwk.LineContent#copyFirstChar() Returns first character, without deleting it Source: pwk/editor/nodes/linecontent.js, line 305 Returns: Type string pwk.LineContent#copyFirstWord() Returns first word Source: pwk/editor/nodes/linecontent.js, line 271 Returns: Type string pwk.LineContent#createDom() Source: pwk/editor/nodes/linecontent.js, line 62 pwk.LineContent#cut(startOffset [, opt_endOffset]) Parameters: Name Type Argument Description startOffset number opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 315 Returns: Type string pwk.LineContent#disposeInternal() Source: pwk/editor/nodes/linecontent.js, line 82 pwk.LineContent#enterDocument() Source: pwk/editor/nodes/linecontent.js, line 76 pwk.LineContent#getAnnotations() Source: pwk/editor/nodes/linecontent.js, line 541 Returns: Type Array.&lt;pwk.NodeAnnotation&gt; pwk.LineContent#getBoundingClientRectForOffset() Returns a text rectangle object that encloses a group of text rectangles at specific offset. Source: pwk/editor/nodes/linecontent.js, line 433 Returns: Type pwk.primitives.ClientRectRange pwk.LineContent#getContentInfoForOffset(startOffset [, opt_endOffset]) Get text and width for content range Parameters: Name Type Argument Description startOffset number opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 481 Returns: Type Object pwk.LineContent#getFirstWordInfo() Get first word and width Source: pwk/editor/nodes/linecontent.js, line 517 Returns: Type Object pwk.LineContent#getLastTextNodeValue() Returns the last text node value. Source: pwk/editor/nodes/linecontent.js, line 296 Returns: The value of the popped text node. Type string pwk.LineContent#getLength() Source: pwk/editor/nodes/linecontent.js, line 365 Returns: Type number pwk.LineContent#getNormalizedText() Source: pwk/editor/nodes/linecontent.js, line 159 Returns: Type string pwk.LineContent#getText() Source: pwk/editor/nodes/linecontent.js, line 151 Returns: Type string pwk.LineContent#getTextNodeAtOffset(offset) Parameters: Name Type Description offset Source: pwk/editor/nodes/linecontent.js, line 374 Returns: Type Node pwk.LineContent#getTextNodeValueAtOffset(offset) Parameters: Name Type Description offset number Source: pwk/editor/nodes/linecontent.js, line 383 Returns: Type string pwk.LineContent#getWidth(isOnlyPrintableContent) Get width of printable content Parameters: Name Type Description isOnlyPrintableContent boolean Source: pwk/editor/nodes/linecontent.js, line 394 Returns: Type number pwk.LineContent#insertText(text [, opt_offset]) Insert or set text for current line content. Parameters: Name Type Argument Description text string opt_offset number &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 100 pwk.LineContent#insertValue(value [, opt_offset], opt_parent) Insert a single value. Parameters: Name Type Argument Description value string Content value, used as single value of TextNode opt_offset number &lt;optional&gt; opt_parent Node | Element Source: pwk/editor/nodes/linecontent.js, line 134 pwk.LineContent#pop() Removes the last text node from the content and returns its value. Source: pwk/editor/nodes/linecontent.js, line 168 Returns: The value of the popped text node. Type string pwk.LineContent#popLastWord() Removes latest text nodes, separated by space/tab, from the content and returns their values. Source: pwk/editor/nodes/linecontent.js, line 188 Returns: Merged values of the popped text nodes. Type string pwk.LineContent#removeAt(startOffset [, opt_endOffset]) Parameters: Name Type Argument Description startOffset number opt_endOffset number &lt;optional&gt; Source: pwk/editor/nodes/linecontent.js, line 349 × Search results Close "},"pwk.LineOffsetInfo.html":{"id":"pwk.LineOffsetInfo.html","title":"Class: LineOffsetInfo","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.LineOffsetInfo new pwk.LineOffsetInfo() Store line offset information. Source: pwk/editor/linerangeinfo.js, line 36 Members &lt;private&gt; line :pwk.Line Type: pwk.Line Source: pwk/editor/linerangeinfo.js, line 48 &lt;private&gt; lineIndex :number Type: number Source: pwk/editor/linerangeinfo.js, line 42 &lt;private&gt; lineLength :number Type: number Source: pwk/editor/linerangeinfo.js, line 66 &lt;private&gt; lineOffset :number Type: number Source: pwk/editor/linerangeinfo.js, line 54 &lt;private&gt; linkedNodeOffset :number Type: number Source: pwk/editor/linerangeinfo.js, line 72 &lt;private&gt; nodeOffset :number Type: number Source: pwk/editor/linerangeinfo.js, line 60 Methods pwk.LineOffsetInfo#getLine() Get line instance {@code pwk.Line}. Source: pwk/editor/linerangeinfo.js, line 98 Returns: Type pwk.Line pwk.LineOffsetInfo#getLineIndex() Get line index. Source: pwk/editor/linerangeinfo.js, line 80 Returns: Type number pwk.LineOffsetInfo#getLineLength() Get line length. Source: pwk/editor/linerangeinfo.js, line 152 Returns: Type number pwk.LineOffsetInfo#getLineOffset() Get line offset. Source: pwk/editor/linerangeinfo.js, line 116 Returns: Type number pwk.LineOffsetInfo#getLinkedNodeOffset() Get linked node offset. Source: pwk/editor/linerangeinfo.js, line 181 Returns: Type number pwk.LineOffsetInfo#getNodeOffset() Get node offset. Source: pwk/editor/linerangeinfo.js, line 134 Returns: Type number pwk.LineOffsetInfo#isEndOfLine() Current offset pointing to the end of line? Source: pwk/editor/linerangeinfo.js, line 170 Returns: Type boolean pwk.LineOffsetInfo#setLine(line) Set line. Parameters: Name Type Description line pwk.Line Line instance. Source: pwk/editor/linerangeinfo.js, line 107 pwk.LineOffsetInfo#setLineIndex(value) Set line index. Parameters: Name Type Description value Line index value. Source: pwk/editor/linerangeinfo.js, line 89 pwk.LineOffsetInfo#setLineLength(value) Set line length. Parameters: Name Type Description value number Line length value. Source: pwk/editor/linerangeinfo.js, line 161 pwk.LineOffsetInfo#setLineOffset(value) Set line offset. Parameters: Name Type Description value number Line offset value. Source: pwk/editor/linerangeinfo.js, line 125 pwk.LineOffsetInfo#setLinkedNodeOffset(value) Set node offset. Parameters: Name Type Description value number Linked node offset value. Source: pwk/editor/linerangeinfo.js, line 190 pwk.LineOffsetInfo#setNodeOffset(value) Set node offset. Parameters: Name Type Description value number Node offset value. Source: pwk/editor/linerangeinfo.js, line 143 × Search results Close "},"pwk.Node.html":{"id":"pwk.Node.html","title":"Class: Node","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Node new pwk.Node(type, doc) Parameters: Name Type Description type pwk.NodeTypes Type of node doc pwk.Document Parent document object. Source: pwk/editor/nodes/node.js, line 43 Extends goog.ui.Component Members &lt;static&gt; EventType :string Type: string Properties: Name Type Default Description ATTRIBUTES_CHANGED string Source: pwk/editor/nodes/node.js, line 314 &lt;private&gt; attributes_ :Array.&lt;pwk.NodeAttribute&gt; Type: Array.&lt;pwk.NodeAttribute&gt; Source: pwk/editor/nodes/node.js, line 50 CSS_CLASS :string Component default css class Type: string Source: pwk/editor/nodes/node.js, line 308 &lt;protected&gt; document_ :pwk.Document Type: pwk.Document Source: pwk/editor/nodes/node.js, line 67 getFirstLine Get first line of the current node. Source: pwk/editor/nodes/node.js, line 221 getLastLine Get latest line of the node. Source: pwk/editor/nodes/node.js, line 228 getLength Get lines content length 0 is means that no content inside the node Source: pwk/editor/nodes/node.js, line 301 getNextLinkedNode Get next linked node. If node does not linked returns null. Source: pwk/editor/nodes/node.js, line 293 getOffsetByLineOffset Get node offset regarding specified line offset. Source: pwk/editor/nodes/node.js, line 237 getPreviousLinkedNode Get previous linked node. If node does not linked returns null. Source: pwk/editor/nodes/node.js, line 286 isChild_ :boolean Type: boolean Source: pwk/editor/nodes/node.js, line 61 isSplittable Specifies whether there can be this node is split between pages. Source: pwk/editor/nodes/node.js, line 257 removeRange Remove content range from node Source: pwk/editor/nodes/node.js, line 214 removeSelection Remove node content based on current selection Source: pwk/editor/nodes/node.js, line 245 select Make selection for node content by range Source: pwk/editor/nodes/node.js, line 199 setNextLinkedNode Set next linked node. Source: pwk/editor/nodes/node.js, line 279 setPreviousLinkedNode Set previous linked node. Source: pwk/editor/nodes/node.js, line 272 split Source: pwk/editor/nodes/node.js, line 265 &lt;private&gt; type_ :pwk.NodeTypes Type: pwk.NodeTypes Source: pwk/editor/nodes/node.js, line 56 unselect Remove selection from node Source: pwk/editor/nodes/node.js, line 205 Methods pwk.Node#addChild() Source: pwk/editor/nodes/node.js, line 99 pwk.Node#addChildAt() Source: pwk/editor/nodes/node.js, line 105 pwk.Node#createDom() Source: pwk/editor/nodes/node.js, line 76 pwk.Node#disposeInternal() Source: pwk/editor/nodes/node.js, line 84 pwk.Node#getAttribute(type) Get attribute for specified type. Parameters: Name Type Description type pwk.NodeAttributeTypes Source: pwk/editor/nodes/node.js, line 148 Returns: Type pwk.NodeAttribute pwk.Node#getAttributes() Source: pwk/editor/nodes/node.js, line 138 Returns: Type Array.&lt;pwk.NodeAttribute&gt; pwk.Node#getIndex() Returns the 0-based index of the given node component, or -1 if no such node is found. Source: pwk/editor/nodes/node.js, line 191 Returns: Type number pwk.Node#getSize() Gets the height and width of an node element, even if its display is none. Source: pwk/editor/nodes/node.js, line 159 Returns: Object with width/height properties. Type goog.math.Size pwk.Node#getType() Source: pwk/editor/nodes/node.js, line 130 Returns: Type of the node Type pwk.NodeTypes pwk.Node#isChild( [opt_child]) Determine or set that node is a child. Parameters: Name Type Argument Description opt_child boolean &lt;optional&gt; Source: pwk/editor/nodes/node.js, line 119 Returns: Type boolean pwk.Node#setAttribute(type, value [, opt_isMergeData]) Set attribute. If attribute with specified type already exist, old data will be rewritten or not, depended from opt_isMergeData argument. Data will be rewritten by default. Parameters: Name Type Argument Description type pwk.NodeAttributeTypes value string opt_isMergeData boolean &lt;optional&gt; Source: pwk/editor/nodes/node.js, line 172 × Search results Close "},"pwk.NodeAnnotation.html":{"id":"pwk.NodeAnnotation.html","title":"Class: NodeAnnotation","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.NodeAnnotation new pwk.NodeAnnotation(type, range) Parameters: Name Type Description type string range Object Source: pwk/editor/nodes/nodeannotation.js, line 37 Members &lt;private&gt; data_ :string Type: string Source: pwk/editor/nodes/nodeannotation.js, line 59 &lt;private&gt; range_ :Object Range offset. Type: Object Source: pwk/editor/nodes/nodeannotation.js, line 52 &lt;private&gt; type_ :string Type of current annotation. Type: string Source: pwk/editor/nodes/nodeannotation.js, line 45 Methods pwk.NodeAnnotation#getData() Source: pwk/editor/nodes/nodeannotation.js, line 83 Returns: Type string pwk.NodeAnnotation#getRangeOffset() Source: pwk/editor/nodes/nodeannotation.js, line 75 Returns: Type Object pwk.NodeAnnotation#getType() Get current annotation type. Source: pwk/editor/nodes/nodeannotation.js, line 67 Returns: Type string × Search results Close "},"pwk.NodeAttribute.html":{"id":"pwk.NodeAttribute.html","title":"Class: NodeAttribute","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.NodeAttribute new pwk.NodeAttribute(type, value) Parameters: Name Type Description type pwk.NodeAttributeTypes value string Source: pwk/editor/nodes/nodeattribute.js, line 39 Members &lt;private&gt; type_ :pwk.NodeAttributeTypes Type: pwk.NodeAttributeTypes Source: pwk/editor/nodes/nodeattribute.js, line 45 &lt;private&gt; value_ :string Type: string Source: pwk/editor/nodes/nodeattribute.js, line 52 Methods pwk.NodeAttribute#getType() Get attribute type. Source: pwk/editor/nodes/nodeattribute.js, line 61 Returns: Type pwk.NodeAttributeTypes pwk.NodeAttribute#getValue() Get attribute value. Source: pwk/editor/nodes/nodeattribute.js, line 70 Returns: Type string pwk.NodeAttribute#setValue(value [, opt_isAppendValue]) Set attribute value. Parameters: Name Type Argument Description value string opt_isAppendValue boolean &lt;optional&gt; Add value to the exist value. Adding depend from attribute type Source: pwk/editor/nodes/nodeattribute.js, line 80 × Search results Close "},"pwk.Page.html":{"id":"pwk.Page.html","title":"Class: Page","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Page new pwk.Page(doc) Initialize {pwk.Page} component. Parameters: Name Type Description doc pwk.Document Source: pwk/editor/page.js, line 52 Extends goog.ui.Component Classes PageOverflowEvent Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/page.js, line 303 &lt;static&gt; EventType :string Event types that can be stopped/started. Type: string Properties: Name Type Default Description OVERFLOW string Source: pwk/editor/page.js, line 310 &lt;private&gt; content_ :pwk.PageContent Type: pwk.PageContent Source: pwk/editor/page.js, line 77 &lt;private&gt; document_ :pwk.Document Type: pwk.Document Source: pwk/editor/page.js, line 59 &lt;private&gt; footer_ :pwk.PageFooter Type: pwk.PageFooter Source: pwk/editor/page.js, line 71 &lt;private&gt; header_ :pwk.PageHeader Type: pwk.PageHeader Source: pwk/editor/page.js, line 65 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/page.js, line 83 Methods pwk.Page#checkPageOverflow() Checking size of page content on overflows and dispatching OVERFLOW event in case page is overflowed. Source: pwk/editor/page.js, line 203 pwk.Page#createDom() Source: pwk/editor/page.js, line 89 pwk.Page#decorateInternal() Source: pwk/editor/page.js, line 110 pwk.Page#disposeInternal() Source: pwk/editor/page.js, line 117 pwk.Page#getAvailableContentSize() Get available content height. Source: pwk/editor/page.js, line 195 Returns: Type number pwk.Page#getMaxContentSize() Get maximum content height. Source: pwk/editor/page.js, line 181 Returns: Type number pwk.Page#linkNode(node) Link the node with current page and place on the end of page Parameters: Name Type Description node pwk.Node Source: pwk/editor/page.js, line 134 pwk.Page#linkNodeAfter(node, previous) Link the node with current page and place it after specific node Parameters: Name Type Description node pwk.Node previous pwk.Node Source: pwk/editor/page.js, line 166 pwk.Page#linkNodeBefore(node, sibling) Link the node with current page and place it before specific node Parameters: Name Type Description node pwk.Node sibling pwk.Node Source: pwk/editor/page.js, line 150 × Search results Close "},"pwk.Page.PageOverflowEvent.html":{"id":"pwk.Page.PageOverflowEvent.html","title":"Class: PageOverflowEvent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter .Page. pwk.Page.PageOverflowEvent new pwk.Page.PageOverflowEvent(page, nodes, pageIndex) Parameters: Name Type Description page pwk.Page nodes Array.&lt;pwk.Node&gt; pageIndex number Source: pwk/editor/page.js, line 323 Extends goog.events.Event Members &lt;private&gt; nodes_ :Array.&lt;pwk.Node&gt; Type: Array.&lt;pwk.Node&gt; Source: pwk/editor/page.js, line 330 &lt;private&gt; pageIndex_ :number Type: number Source: pwk/editor/page.js, line 336 Methods pwk.Page.PageOverflowEvent#getNodesForMoving() Source: pwk/editor/page.js, line 344 Returns: Type Array.&lt;pwk.Node&gt; pwk.Page.PageOverflowEvent#getPageIndex() Source: pwk/editor/page.js, line 352 Returns: Type number × Search results Close "},"pwk.PageContent.html":{"id":"pwk.PageContent.html","title":"Class: PageContent","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.PageContent new pwk.PageContent(doc) Initialize {pwk.PageContent} component. Parameters: Name Type Description doc pwk.Document Source: pwk/editor/pagecontent.js, line 45 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/pagecontent.js, line 167 &lt;private&gt; document_ :pwk.Document Type: pwk.Document Source: pwk/editor/pagecontent.js, line 52 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/pagecontent.js, line 58 Methods pwk.PageContent#createDom() Source: pwk/editor/pagecontent.js, line 64 pwk.PageContent#decorateInternal() Source: pwk/editor/pagecontent.js, line 72 pwk.PageContent#disposeInternal() Source: pwk/editor/pagecontent.js, line 91 pwk.PageContent#enterDocument() Source: pwk/editor/pagecontent.js, line 85 pwk.PageContent#linkNode(node) Render node inside this page content and insert at the end of page. Parameters: Name Type Description node pwk.Node Source: pwk/editor/pagecontent.js, line 103 pwk.PageContent#linkNodeAfter(node, previous) Render node inside this page content and insert before specific node. Parameters: Name Type Description node pwk.Node previous pwk.Node Source: pwk/editor/pagecontent.js, line 135 pwk.PageContent#linkNodeBefore(node, sibling) Render node inside this page content and insert before specific node. Parameters: Name Type Description node pwk.Node sibling pwk.Node Source: pwk/editor/pagecontent.js, line 119 pwk.PageContent#unlinkNode(node) Remove node from document and return if any. Parameters: Name Type Description node string | pwk.Node Source: pwk/editor/pagecontent.js, line 156 × Search results Close "},"pwk.PageFooter.html":{"id":"pwk.PageFooter.html","title":"Class: PageFooter","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.PageFooter new pwk.PageFooter() Initialize {pwk.PageFooter} component. Source: pwk/editor/pagefooter.js, line 43 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/pagefooter.js, line 96 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/pagefooter.js, line 50 Methods pwk.PageFooter#createDom() Source: pwk/editor/pagefooter.js, line 56 pwk.PageFooter#decorateInternal() Source: pwk/editor/pagefooter.js, line 68 pwk.PageFooter#disposeInternal() Source: pwk/editor/pagefooter.js, line 82 pwk.PageFooter#enterDocument() Source: pwk/editor/pagefooter.js, line 76 × Search results Close "},"pwk.PageHeader.html":{"id":"pwk.PageHeader.html","title":"Class: PageHeader","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.PageHeader new pwk.PageHeader() Initialize {pwk.PageHeader} component. Source: pwk/editor/pageheader.js, line 43 Extends goog.ui.Component Members &lt;static&gt; CSS_CLASS :string Default CSS class to be applied to the root element of components rendered by this renderer. Type: string Source: pwk/editor/pageheader.js, line 97 &lt;private&gt; pageSettings_ :pwk.PageSettings Type: pwk.PageSettings Source: pwk/editor/pageheader.js, line 51 Methods pwk.PageHeader#createDom() Source: pwk/editor/pageheader.js, line 57 pwk.PageHeader#decorateInternal() Source: pwk/editor/pageheader.js, line 69 pwk.PageHeader#disposeInternal() Source: pwk/editor/pageheader.js, line 83 pwk.PageHeader#enterDocument() Source: pwk/editor/pageheader.js, line 77 × Search results Close "},"pwk.PageSettings.html":{"id":"pwk.PageSettings.html","title":"Class: PageSettings","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.PageSettings new pwk.PageSettings() Initialize {pwk.PageSettings} component. Source: pwk/editor/pagesettings.js, line 41 Members &lt;static&gt; Paper :Object Sizes of common paper sizes. Type: Object Properties: Name Type Default Description Test Object {&quot;height&quot;:&quot;&quot;,&quot;width&quot;:&quot;&quot;} A4 Object {&quot;height&quot;:&quot;&quot;,&quot;width&quot;:&quot;&quot;} Letter Object {&quot;height&quot;:&quot;&quot;,&quot;width&quot;:&quot;&quot;} Legal Object {&quot;height&quot;:&quot;&quot;,&quot;width&quot;:&quot;&quot;} Executive Object {&quot;height&quot;:&quot;&quot;,&quot;width&quot;:&quot;&quot;} Source: pwk/editor/pagesettings.js, line 158 &lt;private&gt; document_ :pwk.Document Document instance. Type: pwk.Document Source: pwk/editor/pagesettings.js, line 82 &lt;private&gt; heigth_ :number Page height. (in pixels) Type: number Source: pwk/editor/pagesettings.js, line 61 &lt;private&gt; leftMargin_ :number Left margin in pixels Type: number Source: pwk/editor/pagesettings.js, line 68 &lt;private&gt; pagePaper_ :pwk.PageSettings.Paper Type: pwk.PageSettings.Paper Source: pwk/editor/pagesettings.js, line 47 &lt;private&gt; rightMargin_ :number Right margin in pixels Type: number Source: pwk/editor/pagesettings.js, line 75 &lt;private&gt; width_ :number Page width. (in pixels) Type: number Source: pwk/editor/pagesettings.js, line 54 Methods pwk.PageSettings#getContentWidth() Get page content width Source: pwk/editor/pagesettings.js, line 128 Returns: Type number &lt;private&gt; pwk.PageSettings#getDocument_() Source: pwk/editor/pagesettings.js, line 146 Returns: Type pwk.Document pwk.PageSettings#getInnerWidth() Get inner width of page Source: pwk/editor/pagesettings.js, line 137 Returns: Type number pwk.PageSettings#getLeftMargin() Get left page margin. Source: pwk/editor/pagesettings.js, line 101 Returns: Type number pwk.PageSettings#getRightMargin() Get right page margin. Source: pwk/editor/pagesettings.js, line 110 Returns: Type number pwk.PageSettings#getSize() Get page size settings. Source: pwk/editor/pagesettings.js, line 119 Returns: Type goog.math.Size pwk.PageSettings#initialize(doc) Parameters: Name Type Description doc pwk.Document Document required to manage global settings of pages of document. Source: pwk/editor/pagesettings.js, line 90 × Search results Close "},"pwk.Pagination.html":{"id":"pwk.Pagination.html","title":"Class: Pagination","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Pagination new pwk.Pagination(document) Parameters: Name Type Description document pwk.Document Source: pwk/editor/pagination.js, line 39 Members &lt;private&gt; document_ :pwk.Document Type: pwk.Document Source: pwk/editor/pagination.js, line 45 &lt;private&gt; pageNodeIndex_ :Array.&lt;Array.&lt;string&gt;&gt; Each array represent page and index equals the index of page in document. Each child array represent nodes ids. Type: Array.&lt;Array.&lt;string&gt;&gt; Source: pwk/editor/pagination.js, line 53 Methods pwk.Pagination#addNode(node) Add node to the document and link with the latest page. Parameters: Name Type Description node pwk.Node Source: pwk/editor/pagination.js, line 73 pwk.Pagination#addNodeAt(node, index [, opt_after]) Add node to the document at the given 0-based index and link with the page in this position. Parameters: Name Type Argument Description node pwk.Node index number opt_after boolean &lt;optional&gt; Source: pwk/editor/pagination.js, line 114 pwk.Pagination#checkFilling() Checking pages filling. Checking started from topless range node. Source: pwk/editor/pagination.js, line 176 pwk.Pagination#checkOverflow(nodeId) Checking size of page content on overflows and dispatching OVERFLOW event in case page is overflowed. Parameters: Name Type Description nodeId string Id of changed node. The page of this node will be used as start point for overflow check. Source: pwk/editor/pagination.js, line 165 pwk.Pagination#getPageIndexByNodeId(id) Get page index where are situated node with specified id. Parameters: Name Type Description id Source: pwk/editor/pagination.js, line 272 Returns: Type number pwk.Pagination#getPaginationIndex() Source: pwk/editor/pagination.js, line 335 Returns: Type Array.&lt;Array.&lt;string&gt;&gt; &lt;private&gt; pwk.Pagination#initEvents_() Initialize event handlers Source: pwk/editor/pagination.js, line 64 &lt;private&gt; pwk.Pagination#onDocumentNodeRemovedEventHandler_(e) Event handler for pwk.Document.EventType.NODE_REMOVED event type. Parameters: Name Type Description e pwk.Document.NodeRemovedEvent Source: pwk/editor/pagination.js, line 346 pwk.Pagination#onPageOverflowsHandler_(e) Handler to process the page overflow event. Parameters: Name Type Description e pwk.Page.PageOverflowEvent Source: pwk/editor/pagination.js, line 293 × Search results Close "},"pwk.primitives.ClientRectRange.html":{"id":"pwk.primitives.ClientRectRange.html","title":"Class: ClientRectRange","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.primitives.ClientRectRange new pwk.primitives.ClientRectRange( [opt_width] [, opt_height] [, opt_top] [, opt_left]) Parameters: Name Type Argument Description opt_width number &lt;optional&gt; opt_height number &lt;optional&gt; opt_top number &lt;optional&gt; opt_left number &lt;optional&gt; Source: pwk/editor/primitives/clientrectrange.js, line 40 Members height :number Type: number Source: pwk/editor/primitives/clientrectrange.js, line 53 left :number Type: number Source: pwk/editor/primitives/clientrectrange.js, line 59 top :number Type: number Source: pwk/editor/primitives/clientrectrange.js, line 65 width :number Type: number Source: pwk/editor/primitives/clientrectrange.js, line 47 × Search results Close "},"pwk.primitives.NodeSelectionRange.html":{"id":"pwk.primitives.NodeSelectionRange.html","title":"Class: NodeSelectionRange","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.primitives.NodeSelectionRange new pwk.primitives.NodeSelectionRange(startLine, startLineOffset, endLine, endLineOffset) Parameters: Name Type Description startLine pwk.Line startLineOffset number endLine pwk.Line endLineOffset number Source: pwk/editor/primitives/nodeselectionrange.js, line 40 Members endLine :pwk.Line Type: pwk.Line Source: pwk/editor/primitives/nodeselectionrange.js, line 61 endLineOffset :number Type: number Source: pwk/editor/primitives/nodeselectionrange.js, line 68 startLine :pwk.Line Type: pwk.Line Source: pwk/editor/primitives/nodeselectionrange.js, line 47 startLineOffset :number Type: number Source: pwk/editor/primitives/nodeselectionrange.js, line 54 Methods pwk.primitives.NodeSelectionRange#equals(otherNodeSelectionRange) Parameters: Name Type Description otherNodeSelectionRange pwk.primitives.NodeSelectionRange Source: pwk/editor/primitives/nodeselectionrange.js, line 85 Returns: Type boolean pwk.primitives.NodeSelectionRange#isCollapsed() Source: pwk/editor/primitives/nodeselectionrange.js, line 75 Returns: Type boolean × Search results Close "},"pwk.Range.html":{"id":"pwk.Range.html","title":"Class: Range","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Range new pwk.Range(startLine, startNodeOffset, endLine, endNodeOffset [, opt_isStartOfStartLine] [, opt_isStartOfEndLine]) Parameters: Name Type Argument Description startLine pwk.Line startNodeOffset number endLine pwk.Line endNodeOffset number opt_isStartOfStartLine boolean &lt;optional&gt; opt_isStartOfEndLine boolean &lt;optional&gt; Source: pwk/editor/range.js, line 45 Extends goog.events.EventTarget Members &lt;private&gt; endLine_ :pwk.Line Type: pwk.Line Source: pwk/editor/range.js, line 58 &lt;private&gt; endLineOffset_ :number Type: number Source: pwk/editor/range.js, line 108 &lt;private, nullable&gt; endLineRangeInfo_ :pwk.LineOffsetInfo Type: pwk.LineOffsetInfo Source: pwk/editor/range.js, line 94 &lt;private&gt; endNode_ :pwk.LeafNode Type: pwk.LeafNode Source: pwk/editor/range.js, line 70 &lt;private&gt; endNodeOffset_ :number Type: number Source: pwk/editor/range.js, line 82 &lt;private&gt; isStartOfEndLine_ :boolean Type: boolean Source: pwk/editor/range.js, line 122 &lt;private&gt; isStartOfStartLine_ :boolean Type: boolean Source: pwk/editor/range.js, line 116 &lt;private&gt; startLine_ :pwk.Line Type: pwk.Line Source: pwk/editor/range.js, line 52 &lt;private&gt; startLineOffset_ :number Type: number Source: pwk/editor/range.js, line 100 &lt;private, nullable&gt; startLineRangeInfo_ :pwk.LineOffsetInfo Type: pwk.LineOffsetInfo Source: pwk/editor/range.js, line 88 &lt;private&gt; startNode_ :pwk.LeafNode Type: pwk.LeafNode Source: pwk/editor/range.js, line 64 &lt;private&gt; startNodeOffset_ :number Type: number Source: pwk/editor/range.js, line 76 Methods &lt;static&gt; pwk.Range.createFromNodes(startLine, startNodeOffset, endLine, endNodeOffset [, opt_isStartOfStartLine] [, opt_isStartOfEndLine]) Parameters: Name Type Argument Description startLine pwk.Line startNodeOffset number endLine pwk.Line endNodeOffset number opt_isStartOfStartLine boolean &lt;optional&gt; opt_isStartOfEndLine boolean &lt;optional&gt; Source: pwk/editor/range.js, line 311 Returns: Type pwk.Range &lt;static&gt; pwk.Range.equal(range1, range2) Parameters: Name Type Description range1 pwk.Range range2 pwk.Range Source: pwk/editor/range.js, line 321 Returns: Type boolean pwk.Range#collapse(toStart) Collapses the range to one of its boundary points. Parameters: Name Type Description toStart boolean Whether to collapse. Source: pwk/editor/range.js, line 290 pwk.Range#getEndLine() Source: pwk/editor/range.js, line 155 Returns: Type pwk.Line pwk.Range#getEndLineOffset() Source: pwk/editor/range.js, line 203 Returns: Type number pwk.Range#getEndLineRangeInfo() Source: pwk/editor/range.js, line 219 Returns: Type pwk.LineOffsetInfo pwk.Range#getEndNode() Source: pwk/editor/range.js, line 171 Returns: Type pwk.LeafNode pwk.Range#getEndNodeOffset() Source: pwk/editor/range.js, line 187 Returns: Type number pwk.Range#getStartLine() Source: pwk/editor/range.js, line 147 Returns: Type pwk.Line pwk.Range#getStartLineOffset() Source: pwk/editor/range.js, line 195 Returns: Type number pwk.Range#getStartLineRangeInfo() Source: pwk/editor/range.js, line 211 Returns: Type pwk.LineOffsetInfo pwk.Range#getStartNode() Source: pwk/editor/range.js, line 163 Returns: Type pwk.LeafNode pwk.Range#getStartNodeOffset() Source: pwk/editor/range.js, line 179 Returns: Type number pwk.Range#isCollapsed() Source: pwk/editor/range.js, line 267 Returns: Type boolean pwk.Range#isReversed() Source: pwk/editor/range.js, line 275 Returns: Whether the selection is reversed. Type boolean pwk.Range#isStartOfEndLine() Source: pwk/editor/range.js, line 139 Returns: Type boolean pwk.Range#isStartOfStartLine() Source: pwk/editor/range.js, line 131 Returns: Type boolean pwk.Range#setEndPosition(line, nodeOffset [, opt_isStartOfLine]) Parameters: Name Type Argument Description line pwk.Line nodeOffset number opt_isStartOfLine boolean &lt;optional&gt; Source: pwk/editor/range.js, line 249 pwk.Range#setStartPosition(line, nodeOffset [, opt_isStartOfLine]) Parameters: Name Type Argument Description line pwk.Line nodeOffset number opt_isStartOfLine boolean &lt;optional&gt; Source: pwk/editor/range.js, line 229 × Search results Close "},"pwk.Ruler.html":{"id":"pwk.Ruler.html","title":"Class: Ruler","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Ruler new pwk.Ruler() Source: pwk/editor/layer/ruler.js, line 41 Extends goog.ui.Component × Search results Close "},"pwk.Selection.html":{"id":"pwk.Selection.html","title":"Class: Selection","body":" PubWebKit Editor | Classes app.controllers.HelloControllerapp.controllers.HomeControllerapp.Coreapp.core.Applicationapp.core.Application#processRoute_~instanceapp.core.Controllerapp.core.events.ActionEventapp.core.events.ActionExceptionEventapp.core.Requestapp.core.Responseapp.core.Routerapp.core.types.ActionFilterContextapp.core.types.ActionFilterItemapp.core.types.ApplicationFilterItempwk.BranchNodepwk.Documentpwk.Document.NodeRemovedEventpwk.DocumentSettingspwk.Editorpwk.EditorContainerpwk.layer.Caretpwk.layer.Caret.AfterUpdateEventpwk.layer.SelectionOverlaypwk.LeafNodepwk.LeafNode.NodeContentChangedEventpwk.Linepwk.LineContentpwk.LineOffsetInfopwk.Nodepwk.NodeAnnotationpwk.NodeAttributepwk.Pagepwk.Page.PageOverflowEventpwk.PageContentpwk.PageFooterpwk.PageHeaderpwk.PageSettingspwk.Paginationpwk.primitives.ClientRectRangepwk.primitives.NodeSelectionRangepwk.Rangepwk.Rulerpwk.Selection Interfaces app.core.ActionFilterapp.core.ApplicationFilter pwk.Selection new pwk.Selection(doc) Parameters: Name Type Description doc pwk.Document Source: pwk/editor/selection.js, line 45 Extends goog.events.EventTarget Members &lt;static&gt; CaretDirection :number Type: number Properties: Name Type Default Description LEFT number 1 RIGHT number 2 UP number 3 DOWN number 4 END number 5 HOME number 6 Source: pwk/editor/selection.js, line 1185 &lt;private&gt; caret_ :pwk.layer.Caret Caret Type: pwk.layer.Caret Source: pwk/editor/selection.js, line 66 &lt;private&gt; containerElement_ :Element Type: Element Source: pwk/editor/selection.js, line 96 &lt;private&gt; document_ :pwk.Document Document of current edit session. Type: pwk.Document Source: pwk/editor/selection.js, line 53 &lt;private, nullable&gt; lastBoundsDirection_ :pwk.Selection.CaretDirection Type: pwk.Selection.CaretDirection Source: pwk/editor/selection.js, line 90 &lt;private&gt; lastModifiedBounds_ :goog.math.Rect Type: goog.math.Rect Source: pwk/editor/selection.js, line 72 &lt;private, nullable&gt; lastModifiedBoundsDirection_ :pwk.Selection.CaretDirection Type: pwk.Selection.CaretDirection Source: pwk/editor/selection.js, line 84 &lt;private&gt; lastModifiedRange_ :pwk.Range Type: pwk.Range Source: pwk/editor/selection.js, line 78 &lt;private&gt; range_ :pwk.Range Type: pwk.Range Source: pwk/editor/selection.js, line 59 &lt;private&gt; scrollToRangePositionScrollInstance_ :goog.fx.dom.Scroll Type: goog.fx.dom.Scroll Source: pwk/editor/selection.js, line 108 &lt;private&gt; scrollToTasksCount_ :number Type: number Source: pwk/editor/selection.js, line 102 Methods &lt;private&gt; pwk.Selection#caretAfterUpdate_(e) Parameters: Name Type Description e pwk.layer.Caret.AfterUpdateEvent Event object. Source: pwk/editor/selection.js, line 144 &lt;private&gt; pwk.Selection#caretBeforeUpdate_(e) Parameters: Name Type Description e goog.events.Event Event object. Source: pwk/editor/selection.js, line 135 pwk.Selection#getBoundsForRange( [opt_range] [, opt_disable_for_ie]) Returns a bounding rectangle for a given range in document space. Parameters: Name Type Argument Description opt_range pwk.Range &lt;optional&gt; opt_disable_for_ie Object &lt;optional&gt; It's could increase performance in IE Source: pwk/editor/selection.js, line 701 Returns: Type goog.math.Rect pwk.Selection#getCaret() Get document caret instance Source: pwk/editor/selection.js, line 164 Returns: Type pwk.layer.Caret &lt;private&gt; pwk.Selection#getClosestLineElementToOffset_(x, y) Parameters: Name Type Description x number y number Source: pwk/editor/selection.js, line 912 Returns: line element Type Element &lt;private&gt; pwk.Selection#getLineRangeFromPoint_(line, x) Parameters: Name Type Description line pwk.Line x number Source: pwk/editor/selection.js, line 858 Returns: Type pwk.Range pwk.Selection#getRange() Get current range Source: pwk/editor/selection.js, line 267 Returns: Type pwk.Range pwk.Selection#getSelectionRangeFromPoint(x, y) Parameters: Name Type Description x number y number Source: pwk/editor/selection.js, line 839 Returns: Type pwk.Range pwk.Selection#initialize() Initialize selection for document. Source: pwk/editor/selection.js, line 116 pwk.Selection#moveCaretDown() Move caret down Source: pwk/editor/selection.js, line 576 pwk.Selection#moveCaretLeft() Move caret left Source: pwk/editor/selection.js, line 284 pwk.Selection#moveCaretLineEnd() Move caret to end of current line Source: pwk/editor/selection.js, line 408 pwk.Selection#moveCaretLineStart() Move caret to start of current line Source: pwk/editor/selection.js, line 432 pwk.Selection#moveCaretRight( [opt_isTyping]) Move caret right. Parameters: Name Type Argument Description opt_isTyping boolean &lt;optional&gt; If this flag is set, then caret didn't be moved to the first line position when line changed. Source: pwk/editor/selection.js, line 334 pwk.Selection#moveCaretUp() Move caret up. Source: pwk/editor/selection.js, line 455 pwk.Selection#removeSelection() Remove current document selection Source: pwk/editor/selection.js, line 1159 pwk.Selection#scrollToRangePosition( [opt_isIncreaseTask]) Scroll to range position Parameters: Name Type Argument Description opt_isIncreaseTask boolean &lt;optional&gt; Source: pwk/editor/selection.js, line 173 pwk.Selection#selectDocument( [opt_range]) Parameters: Name Type Argument Description opt_range pwk.Range &lt;optional&gt; Source: pwk/editor/selection.js, line 990 pwk.Selection#setRange(range) Set range Parameters: Name Type Description range pwk.Range Source: pwk/editor/selection.js, line 276 pwk.Selection#updateCaretFromRange( [opt_range]) Update caret from range. Parameters: Name Type Argument Description opt_range pwk.Range &lt;optional&gt; Source: pwk/editor/selection.js, line 232 pwk.Selection#updateSelectionFromRange( [opt_range]) Update selection from range. Parameters: Name Type Argument Description opt_range pwk.Range &lt;optional&gt; Source: pwk/editor/selection.js, line 254 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
